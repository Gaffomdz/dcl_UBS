"use strict";const getGlobalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==this)return this;throw new Error("Unable to locate global `this`")},globalObject=getGlobalThis();var loader;!function(v){const A=1,E=2;let R=0;const O=[],M=[],V={baseUrl:""},W={};function c(v,E,O){let M=null,V={},H=null;"function"==typeof v?V=v:"string"==typeof v?(M=v,"function"==typeof E?V=E:E instanceof Array&&(H=E,V=O)):v instanceof Array&&(H=v,"function"==typeof E&&(V=E)),H=H||["require","exports","module"],null===M&&(M="unnamed-module-"+R++),M=g(M),H=(H||[]).map((v=>function(v,A){return v?b(A,v):A}(M,v))),W[M]||(W[M]={name:M,parent:null,dclamd:A,dependencies:H,handlers:[],exports:{},dependants:new Set}),W[M].dependencies=H,p(H,(function(v){const A=W[M];if(!A)throw new Error("Could not access registered module "+M);let E=A.exports;E="function"==typeof V?V.apply(globalObject,v)||E:V,A.exports=E,d(M)}),(v=>{if("function"!=typeof onerror)throw v;onerror(v)}),M)}function d(v){const A=W[v];if(!A)throw new Error("Could not access registered module "+v);A.dclamd=E;const R=A.handlers;if(R&&R.length)for(let A=0;A<R.length;A++)R[A](W[v])}function u(v,A,E){if(!W[v])return null;if(v===A||50===E)return[v];const R=W[v].dependencies;for(let O=0,M=R.length;O<M;O++){const M=u(R[O],A,E+1);if(null!==M)return M.push(v),M}return null}function a(v,A){const E=W[v];if(!E)return!1;const R={};for(const v in W)R[v]=!1;const O=[];for(O.push(E),R[v]=!0;O.length>0;){const v=O.shift().dependencies;if(v)for(let E=0,M=v.length;E<M;E++){const M=v[E];if(M===A)return!0;const V=W[M];V&&!R[M]&&(R[M]=!0,O.push(V))}}return!1}function p(v,E,R,O){const V=new Array(v.length).fill(null);let H=0,X=!1;if("string"==typeof v){if(W[v]){if(W[v].dclamd===A)throw new Error(`Trying to load ${v} from ${O}. The first module is still loading.`);return W[v]}throw new Error(v+" has not been defined. Please include it as a dependency in "+O+"'s define()")}const Z=v.length;for(let A=0;A<Z;A++)switch(v[A]){case"require":const h=function(v,A,E){return p(v,A,E,O)};h.toUrl=function(v){return b(v,O)},V[A]=h,H++;break;case"exports":if(!W[O])throw new Error("Parent module "+O+" not registered yet");V[A]=W[O].exports,H++;break;case"module":V[A]={id:O,uri:b(O)},H++;break;default:{const K=v[A],m=()=>{V[A]=W[K].exports,H++,H===Z&&E&&(X=!0,E(V))};if(a(K,O)){const v=u(K,O,0);v&&(v.reverse(),v.push(K),M.push(v)),w(K,(()=>{}),R,O),m()}else w(K,m,R,O);break}}!X&&H===Z&&E&&E(V)}function h(v,A){return function(){return dcl.callRpc(v,A.name,O.slice.call(arguments,0))}}function w(v,E,R,O){if(W[v])return W[v].dependants.add(O),void(W[v].dclamd===A?E&&W[v].handlers.push(E):E&&E(W[v]));if(W[v]={name:v,parent:O,dclamd:A,handlers:[E],dependencies:[],dependants:new Set([O]),exports:{}},0===v.indexOf("@")){const A=W[v].exports;if("function"!=typeof dcl.loadModule)throw new Error("Asynchronous modules will not work because loadModule function is not present");dcl.loadModule(v,A).then((E=>{for(const v in E.methods){const R=E.methods[v];A[R.name]=h(E.rpcHandle,R)}d(v)})).catch((v=>{R(v)}))}}function g(v){let A,E=v;for(A=/\/\.\//;A.test(E);)E=E.replace(A,"/");for(E=E.replace(/^\.\//g,""),A=/\/(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//;A.test(E);)E=E.replace(A,"/");return E=E.replace(/^(([^\/])|([^\/][^\/\.])|([^\/\.][^\/])|([^\/][^\/][^\/]+))\/\.\.\//,""),E=E.replace(/^\//g,""),E}function b(v,A){switch(v){case"require":case"exports":case"module":return v}return A?function(v,A){let E=v;if(!E.startsWith("@")&&(E.startsWith("./")||E.startsWith("../"))){const v=A.split("/");v.pop(),E=g(v.join("/")+"/"+E)}return E}(v,A):g(v)}v.config=function(v){if("object"==typeof v)for(const A in v)v.hasOwnProperty(A)&&(V[A]=v[A])},v.define=c,function(v){v.amd={},v.modules=W}(c=v.define||(v.define={})),v.require=p,"undefined"!=typeof dcl&&dcl.onStart((()=>{const v=new Set,E=[];for(const R in W)W[R]&&(W[R].dclamd===A&&E.push(W[R]),W[R].dependencies.forEach((A=>{"require"!==A&&"exports"!==A&&"module"!==A&&(W[A]||v.add(A))})));const R=[];if(M.length&&R.push(`\n> Cyclic dependencies: ${M.map((v=>"\n  - "+v.join(" -> "))).join("")}`),v.size&&R.push(`\n> Undeclared/unknown modules: ${Array.from(v).map((v=>"\n  - "+v)).join("")}`),E.length&&R.push(`\n> These modules didn't load: ${E.map((v=>"\n  - "+v.name)).join("")}.\n`),R.length)throw new Error(R.join("\n"))})),p.toUrl=b}(loader||(loader={})),globalObject.define=loader.define,globalObject.dclamd=loader,function(v){var A=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(v){return v.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(v){return v.firstPersonCameraEntity}},t}(),n=function(v,A){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,A){v.__proto__=A}||function(v,A){for(var E in A)Object.prototype.hasOwnProperty.call(A,E)&&(v[E]=A[E])},n(v,A)
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */};function i(v,A){if("function"!=typeof A&&null!==A)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function i(){this.constructor=v}n(v,A),v.prototype=null===A?Object.create(A):(i.prototype=A.prototype,new i)}var o=function(){return o=Object.assign||function(v){for(var A,E=1,R=arguments.length;E<R;E++)for(var O in A=arguments[E])Object.prototype.hasOwnProperty.call(A,O)&&(v[O]=A[O]);return v},o.apply(this,arguments)};function r(v,A,E,R){var O,M=arguments.length,V=M<3?A:null===R?R=Object.getOwnPropertyDescriptor(A,E):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)V=Reflect.decorate(v,A,E,R);else for(var W=v.length-1;W>=0;W--)(O=v[W])&&(V=(M<3?O(V):M>3?O(A,E,V):O(A,E))||V);return M>3&&V&&Object.defineProperty(A,E,V),V}function s(v,A){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(v,A)}function h(v){var A="function"==typeof Symbol&&Symbol.iterator,E=A&&v[A],R=0;if(E)return E.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&R>=v.length&&(v=void 0),{value:v&&v[R++],done:!v}}};throw new TypeError(A?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(v,A){var E="function"==typeof Symbol&&v[Symbol.iterator];if(!E)return v;var R,O,M=E.call(v),V=[];try{for(;(void 0===A||A-- >0)&&!(R=M.next()).done;)V.push(R.value)}catch(v){O={error:v}}finally{try{R&&!R.done&&(E=M.return)&&E.call(M)}finally{if(O)throw O.error}}return V}function p(v,A){for(var E=0,R=A.length,O=v.length;E<R;E++,O++)v[O]=A[E];return v}var E=0;function u(){for(var v=[],A=0;A<arguments.length;A++)v[A]=arguments[A];"undefined"!=typeof dcl?dcl.log.apply(dcl,p([],l(v))):console.log.apply(console,p(["DEBUG:"],l(v)))}function y(v,A){"undefined"!=typeof dcl?dcl.error(v,A):console.error("ERROR:",v,A)}function f(v){if(E++,0===v.length)throw new Error("newId(type: string): type cannot be empty");return v+E.toString(36)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(v){var A=16*Math.random()|0;return("x"===v?A:3&A|8).toString(16)}))}var R=[];function _(v){if(!("__event_name__"in v)||"string"!=typeof v.__event_name__)throw new Error("The EventConstructor is not registered");return v.__event_name__}var O=function(){function t(){this.listeners={}}return t.prototype.addListener=function(v,A,E){if(!v||"function"!=typeof v)throw new Error("Invalid EventConstructor");var R=_(v),O=this.listeners[R];O||(O=this.listeners[R]=[]);for(var M=0;M<O.length;M++)if(O[M].listener===A)throw new Error("The provided listener is already registered");return O.push({listener:A,fn:E}),this},t.prototype.removeListener=function(v,A){if(!A||"function"!=typeof A)throw new Error("Invalid EventConstructor");var E=_(A),R=this.listeners[E];if(!R)return!1;for(var O=0;O<R.length;O++)if(R[O].listener===v)return R.splice(O,1),!0;return!1},t.prototype.fireEvent=function(v){var A=_(v.constructor),E=this.listeners[A];if(E)for(var R=0;R<E.length;R++)try{var O=E[R];O.fn.call(O.listener,v)}catch(v){y(v)}return this},t}();function x(){var v=f("EV");if(-1!==R.indexOf(v))throw new Error("The event name ".concat(v," is already taken"));return R.push(v),function(A){return A.__event_name__=v,A}}var M,V=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,A,E){this.entity=v,this.componentName=A,this.component=E})),W=r([x(),s("design:paramtypes",[Object,String,Object])],(function(v,A,E){this.entity=v,this.componentName=A,this.classId=E})),H=r([x(),s("design:paramtypes",[Object,Object])],(function(v,A){this.entity=v,this.parent=A}));v.UIValueType=void 0,(M=v.UIValueType||(v.UIValueType={}))[M.PERCENT=0]="PERCENT",M[M.PIXELS=1]="PIXELS";var X=function(){function e(A){if(this.type=v.UIValueType.PIXELS,"string"==typeof A){var E=A;E.indexOf("px")>-1?this.type=v.UIValueType.PIXELS:E.indexOf("%")>-1&&(this.type=v.UIValueType.PERCENT),this.value=parseFloat(E)}else this.value=A}return e.prototype.toString=function(){var A=this.value.toString();return this.type===v.UIValueType.PERCENT?A+="%":A+="px",A},e}(),Z="__name__symbol_",K="__classId__symbol_",$="__component__id_",J=r([x(),s("design:paramtypes",[String,String,Number])],(function(v,A,E){this.componentId=v,this.componentName=A,this.classId=E})),et=r([x(),s("design:paramtypes",[String])],(function(v){this.componentId=v})),it=r([x(),s("design:paramtypes",[String,Object])],(function(v,A){this.componentId=v,this.component=A}));function P(v,A){return function(E){if(E.isComponent)throw new TypeError("You cannot extend a component. Trying to extend ".concat(E.originalClassName," with: ").concat(v));var R=E,o=function(){var E=Array.prototype.slice.call(arguments),O=new(R.bind.apply(R,p([void 0],l(E))));return Object.defineProperty(O,Z,{enumerable:!1,writable:!1,configurable:!1,value:v}),void 0!==A&&Object.defineProperty(O,K,{enumerable:!1,writable:!1,configurable:!1,value:A}),O};return void 0!==A&&(o.__classId__symbol_=A),o.__name__symbol_=v,o.isComponent=!0,o.originalClassName=v,(o.prototype=E.prototype).constructor=E,o}}function N(v,A){return function(E){if(E.isComponent)throw new TypeError("You cannot extend a component. Trying to extend ".concat(E.originalClassName," with: ").concat(v));if("number"!=typeof A||isNaN(A))throw new Error("classId: ".concat(A," is an invalid integer"));var R=E,o=function(){if(!N.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var E=Array.prototype.slice.call(arguments),O=new(R.bind.apply(R,p([void 0],l(E)))),M=f("C");return Object.defineProperty(O,Z,{enumerable:!1,writable:!1,configurable:!1,value:v}),Object.defineProperty(O,$,{enumerable:!1,writable:!1,configurable:!1,value:M}),void 0!==A&&Object.defineProperty(O,K,{enumerable:!1,writable:!1,configurable:!1,value:A}),N.engine&&N.engine.registerComponent(O),O};return void 0!==A&&(o.__classId__symbol_=A),o.__name__symbol_=v,o.isComponent=!0,o.isDisposableComponent=!0,o.originalClassName=v,(o.prototype=E.prototype).constructor=E,o}}function F(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__name__symbol_)return v.__name__symbol_;throw new TypeError(v+" is not a registered component.")}function L(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__classId__symbol_)return v.__classId__symbol_;if(!v.__name__symbol_)throw new TypeError(v+" is not a registered component.");return null}function D(v){if(!v)throw new TypeError(v+" is not a component.");if(v.__component__id_)return v.__component__id_;throw new TypeError(v+" is not a registered disposable component.")}!function(v){v.engine=null}(N||(N={}));var nt=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(v,A){if(delete v[A]){var E=A+"_"+Math.random();v[E]=void 0,Object.defineProperty(v,E,o(o({},Object.getOwnPropertyDescriptor(v,E)),{enumerable:!1})),Object.defineProperty(v,A.toString(),{get:function(){return this[E]},set:function(v){var R=this[E];if(this.data[A]=v?D(v):null,this[E]=v,v!==R){this.dirty=!0;for(var O=0;O<this.subscriptions.length;O++)this.subscriptions[O](A,v,R)}},enumerable:!0})}},t.field=function(v,A){delete v[A]&&Object.defineProperty(v,A.toString(),{get:function(){return this.data[A]},set:function(v){var E=this.data[A];if(this.data[A]=v,v!==E){this.dirty=!0;for(var R=0;R<this.subscriptions.length;R++)this.subscriptions[R](A,v,E)}},enumerable:!0})},t.uiValue=function(v,A){delete v[A]&&Object.defineProperty(v,A.toString(),{get:function(){return this.data[A].toString()},set:function(v){var E=this.data[A],R=new X(v);if(this.data[A]=R,R!==E){this.dirty=!0;for(var O=0;O<this.subscriptions.length;O++)this.subscriptions[O](A,R,E)}},enumerable:!0})},t.readonly=function(v,A){delete v[A]&&Object.defineProperty(v,A.toString(),{get:function(){if(A in this.data==0)throw new Error("The field ".concat(A," is uninitialized"));return this.data[A]},set:function(v){if(A in this.data)throw new Error("The field ".concat(A," is readonly"));this.data[A]=v,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(v){return this.subscriptions.push(v),this},t.prototype.toJSON=function(){return this.data},t}();function U(v){return $ in v}var ot=function(){function t(){for(var v=[],A=0;A<arguments.length;A++)v[A]=arguments[A];if(this.entities=[],this.active=!1,this._requiresNames=[],!v)throw new Error("ComponentGroup: Could not load the requires list");if(!(v instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return v.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(A){var R=v[A],O=null;if(!R)throw new Error("ComponentGroup: the required component at location ".concat(A," is invalid"));try{O=F(R)}catch(v){throw new Error("ComponentGroup: the required component at location ".concat(A," is not registered as a @Component. Remember to provide the class of the component, not the name"))}if(E._requiresNames.some((function(v){return v===O})))throw new Error("ComponentGroup: the required component list has a repeated name ".concat(O));E._requiresNames.push(O)},E=this,R=0;R<v.length;R++)n(R)}return t.prototype.hasEntity=function(v){return!!v.isAddedToEngine()&&-1!==this.entities.indexOf(v)},t.prototype.addEntity=function(v){if(!v.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(v)&&this.entities.push(v)},t.prototype.removeEntity=function(v){var A=this.entities.indexOf(v);-1!==A&&this.entities.splice(A,1)},t.prototype.componentRemoved=function(v,A){-1!==this._requiresNames.indexOf(A)&&this.removeEntity(v)},t.prototype.meetsRequirements=function(v){for(var A=0;A<this._requiresNames.length;A++)if(!(this._requiresNames[A]in v.components))return!1;return!0},t}(),rt=function(){function t(v){this.name=v,this.children={},this.eventManager=null,this.alive=!1,this.uuid=f("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(v){if("function"==typeof v)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof v)throw new Error("You passed a ".concat(typeof v,", an instance of component is expected"));var A=F(v);if(this.components[A]){if(this.components[A]===v)return v;this.removeComponent(this.components[A],!1)}return this.addComponent(v)},t.prototype.hasComponent=function(v){var A=typeof v;if("string"!==A&&"object"!==A&&"function"!==A)throw new Error("Entity#has(component): component is not a class, name or instance");if(null===v)return!1;var E="string"===A?v:F(v),R=this.components[E];return!!R&&("object"===A?R===v:"function"!==A||R instanceof v)},t.prototype.getComponent=function(v){var A=typeof v;if("string"!==A&&"function"!==A)throw new Error("Entity#get(component): component is not a class or name");var E="string"===A?v:F(v),R=this.components[E];if(!R)throw new Error('Can not get component "'.concat(E,'" from entity "').concat(this.identifier,'"'));if("function"===A){if(R instanceof v)return R;throw new Error('Can not get component "'.concat(E,'" from entity "').concat(this.identifier,'" (by instance)'))}return R},t.prototype.getComponentOrNull=function(v){var A=typeof v;if("string"!==A&&"function"!==A)throw new Error("Entity#getOrNull(component): component is not a class or name");var E="string"===A?v:F(v),R=this.components[E];return R?"function"===A?R instanceof v?R:null:R:null},t.prototype.getComponentOrCreate=function(v){if("function"!=typeof v)throw new Error("Entity#getOrCreate(component): component is not a class");var A=this.getComponentOrNull(v);return A||(F(A=new v),this.addComponentOrReplace(A)),A},t.prototype.addComponent=function(v){if("object"!=typeof v)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var A=F(v),E=L(v);if(this.components[A])throw new Error('A component of type "'.concat(A,'" is already present in entity "').concat(this.identifier,'"'));this.components[A]=v,this.eventManager&&this.eventManager.fireEvent(new W(this,A,E));var R=v;return"function"==typeof R.addedToEntity&&R.addedToEntity(this),v},t.prototype.removeComponent=function(v,A){void 0===A&&(A=!0);var E=typeof v;if("string"!==E&&"function"!==E&&"object"!==E)throw new Error("Entity#remove(component): component is not a class, class or name");var R="string"===E?v:F(v),O=this.components[R];if(O){if("function"===E)return O instanceof v?(delete this.components[R],void(O&&(A&&this.eventManager&&this.eventManager.fireEvent(new V(this,R,O)),"function"==typeof O.removedFromEntity&&O.removedFromEntity(this)))):void u('Entity Warning: Trying to remove wrong (by constructor) component "'.concat(R,'" from entity "').concat(this.identifier,'"'));delete this.components[R],O&&(A&&this.eventManager&&this.eventManager.fireEvent(new V(this,R,O)),"function"==typeof O.removedFromEntity&&O.removedFromEntity(this))}else u('Entity Warning: Trying to remove inexisting component "'.concat(R,'" from entity "').concat(this.identifier,'"'))},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(v){var A;if(v&&"getEntityRepresentation"in v){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");A=v.getEntityRepresentation(this.engine)}else A=!v&&this.engine?this.engine.rootEntity:v;var E=this.getParent();if(A===this)throw new Error('Failed to set parent for entity "'.concat(this.identifier,"\": An entity can't set itself as a its own parent"));if(A===E)return this;var R=this.getCircularAncestor(A);if(R)throw new Error('Failed to set parent for entity "'.concat(this.identifier,'": Circular parent references are not allowed (See entity "').concat(R,'")'));return E&&delete E.children[this.uuid],null!==A&&"0"!==A.uuid&&(!A.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),A.isAddedToEngine()&&!this.isAddedToEngine()&&A.engine.addEntity(this)),this._parent=A||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new H(this,A)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(v){for(var A=this.engine?this.engine.rootEntity:null,E=v;E&&E!==A;){var R=E.getParent();if(R===this)return E.uuid;E=R}return null},t.prototype.registerAsChild=function(){var v=this.getParent();this.uuid&&v&&(v.children[this.uuid]=this)},t}(),st=function(){function t(v){this.eventManager=new O,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(W,this,this.componentAddedHandler),this.eventManager.addListener(V,this,this.componentRemovedHandler),this.rootEntity=v,this.firstPersonCameraEntity=new rt,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new rt,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(v){var A=v.getParent();if(v.isAddedToEngine())return v;for(var E in v.eventManager=this.eventManager,v.engine=this,this._entities[v.uuid]=v,this.checkRequirementsAndAdd(v),A?A.isAddedToEngine()||A===this.rootEntity||u("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+A.uuid):v.setParent(this.rootEntity),v.alive=!0,v.children){var R=v.children[E];R&&(R.isAddedToEngine()||this.addEntity(R))}return v},t.prototype.removeEntity=function(v){var A=v.uuid;if(v.isAddedToEngine()){for(var E in v.components){var R=this._componentGroups[E];if(R)for(var O in R)R[O].removeEntity(v);delete this.entityLists[E][A]}for(var M=0;M<this.simpleSystems.length;M++){var V=this.simpleSystems[M];V.onRemoveEntity&&V.onRemoveEntity(v)}for(var M in v.children){var W=v.children[M];W&&this.removeEntity(W)}return v.alive=!1,v.eventManager=null,delete this._entities[A],!0}for(var E in u("Engine: Trying to remove non existent entity from engine."),v.isAddedToEngine()?u("Engine: Entity id: "+A):u('Engine: Entity "'.concat(v.uuid,'" has not been added to any engine yet.')),u("Engine: Entity's components:"),v.components)u(E);return!1},t.prototype.addSystem=function(v,A){if(void 0===A&&(A=0),-1!==this.addedSystems.indexOf(v))return u("Engine: Trying to add a system that is already added. Aborting"),v;if(this.systems.length>0)for(var E=0;E<this.systems.length;E++){var R=this.systems[E],O=E===this.systems.length-1;if(R.priority>A){this.addedSystems.push(v),this.systems.splice(E,0,{system:v,priority:A});break}if(O){this.addedSystems.push(v),this.systems.splice(E+1,0,{system:v,priority:A});break}}else this.addedSystems.push(v),this.systems.splice(1,0,{system:v,priority:A});return this.registerSystem(v),v},t.prototype.removeSystem=function(v){var A=this.addedSystems.indexOf(v);if(-1!==A){v.active=!1,v.deactivate&&v.deactivate(),this.addedSystems.splice(A,1);for(var E=0;E<this.systems.length;E++)this.systems[E].system===v&&this.systems.splice(E,1);return!0}return!1},t.prototype.update=function(v){for(var A in this.systems){var E=this.systems[A].system;if(E.active&&E.update)try{E.update(v)}catch(v){y(v)}}return this},t.prototype.getEntitiesWithComponent=function(v){var A="string"==typeof v?v:F(v);return A in this.entityLists?this.entityLists[A]:this.entityLists[A]={}},t.prototype.registerComponent=function(v){var A=D(v),E=F(v),R=L(v);this._disposableComponents[A]=v,null!==R&&(this.eventManager.fireEvent(new J(A,E,R)),this.eventManager.fireEvent(new it(A,v)))},t.prototype.disposeComponent=function(v){var A=D(v);return delete this._disposableComponents[A]&&(this.eventManager.fireEvent(new et(A)),v.onDispose&&v.onDispose(),!0)},t.prototype.updateComponent=function(v){this.eventManager.fireEvent(new it(D(v),v))},t.prototype.getComponentGroup=function(){for(var v=[],A=0;A<arguments.length;A++)v[A]=arguments[A];var E=void 0;if(v.length>0&&(H=this._componentGroups[F(v[0])]))for(var R=v.slice(),O=0;O<H.length;O++){var M=H[O];if(R.length===M.requires.length){for(var V=0;V<R.length&&-1!==M.requires.indexOf(R[V]);V++)V===R.length-1&&(E=M);if(E)break}}if(E)return E;(E=new(ot.bind.apply(ot,p([void 0],l(v))))).active=!0;var W=E.requiresNames;for(O=0;O<W.length;O++){var H,X=W[O];(H=this._componentGroups[X])||(this._componentGroups[X]=H=[]),-1===H.indexOf(E)&&H.push(E)}for(var Z in this._entities)this.checkRequirements(this._entities[Z],E);return E},t.prototype.removeComponentGroup=function(v){if(v.active){v.active=!1;for(var A=v.requiresNames,E=0;E<A.length;E++){var R=A[E],O=this._componentGroups[R];if(O){var M=O.indexOf(v);-1!==M&&O.splice(M,1)}}return!0}return!1},t.prototype.registerSystem=function(v){v.active=!0,v.activate&&v.activate(this),this.simpleSystems.push(v)},t.prototype.checkRequirementsAndAdd=function(v){if(v.isAddedToEngine()){for(var A in v.components){A in this.entityLists||(this.entityLists[A]={}),this.entityLists[A][v.uuid]=v;var E=this._componentGroups[A];if(E)for(var R in E)this.checkRequirements(v,E[R])}for(var O=0;O<this.simpleSystems.length;O++){var M=this.simpleSystems[O];M.onAddEntity&&M.onAddEntity(v)}}},t.prototype.checkRequirements=function(v,A){A.meetsRequirements(v)?A.hasEntity(v)||A.addEntity(v):A.hasEntity(v)&&A.removeEntity(v)},t.prototype.componentAddedHandler=function(v){var A,E=v.entity,R=v.componentName;if(E.isAddedToEngine()){this.entityLists[R]?this.entityLists[R][E.uuid]=E:this.entityLists[R]=((A={})[E.uuid]=E,A);var O=this._componentGroups[R];if(O)for(var M in O)this.checkRequirements(E,O[M])}},t.prototype.componentRemovedHandler=function(v){var A=v.entity,E=v.componentName;if(A.isAddedToEngine()){delete this.entityLists[E][A.uuid];var R=this._componentGroups[E];if(R)for(var O in R)this.checkRequirements(A,R[O])}},t}(),at=Promise.resolve().then.bind(Promise.resolve());function G(v){var A=at(v);return A.isComplete=!1,A.then((function(v){A.isComplete=!0,A.result=v,A.didFail=!1})).catch((function(v){A.isComplete=!0,A.error=v,A.didFail=!0,y("executeTask: FAILED "+v.toString(),v)})),A}var ht,ct,lt=function(){function t(v,A,E,R){void 0===A&&(A=!1),this.initalize(v,A,E,R)}return t.prototype.initalize=function(v,A,E,R){return void 0===A&&(A=!1),this.mask=v,this.skipNextObservers=A,this.target=E,this.currentTarget=R,this},t}(),Y=function(v,A,E){void 0===E&&(E=null),this.callback=v,this.mask=A,this.scope=E,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1},ut=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(v,A,E,R){var O,M;void 0===E&&(E=-1),void 0===R&&(R=null);var V=new t;V._observers=new Array,V._observables=v;try{for(var W=h(v),H=W.next();!H.done;H=W.next()){var X=H.value.add(A,E,!1,R);X&&V._observers.push(X)}}catch(v){O={error:v}}finally{try{H&&!H.done&&(M=W.return)&&M.call(W)}finally{if(O)throw O.error}}return V},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var v=0;v<this._observers.length;v++)this._observables[v].remove(this._observers[v]);this._observers=null,this._observables=null},t}(),pt=function(){function t(v){this._observers=new Array,this._onObserverAdded=null,this._eventState=new lt(0),v&&(this._onObserverAdded=v)}return t.prototype.add=function(v,A,E,R,O){if(void 0===A&&(A=-1),void 0===E&&(E=!1),void 0===R&&(R=null),void 0===O&&(O=!1),!v)return null;var M=new Y(v,A,R);return M.unregisterOnNextCall=O,E?this._observers.unshift(M):this._observers.push(M),this._onObserverAdded&&this._onObserverAdded(M),M},t.prototype.addOnce=function(v){return this.add(v,void 0,void 0,void 0,!0)},t.prototype.remove=function(v){return!!v&&-1!==this._observers.indexOf(v)&&(this._deferUnregister(v),!0)},t.prototype.removeCallback=function(v,A){for(var E=0;E<this._observers.length;E++)if(this._observers[E].callback===v&&(!A||A===this._observers[E].scope))return this._deferUnregister(this._observers[E]),!0;return!1},t.prototype.notifyObservers=function(v,A,E,R){var O,M;if(void 0===A&&(A=-1),!this._observers.length)return!0;var V=this._eventState;V.mask=A,V.target=E,V.currentTarget=R,V.skipNextObservers=!1,V.lastReturnValue=v;try{for(var W=h(this._observers),H=W.next();!H.done;H=W.next()){var X=H.value;if(!X._willBeUnregistered&&(X.mask&A&&(X.scope?V.lastReturnValue=X.callback.apply(X.scope,[v,V]):V.lastReturnValue=X.callback(v,V),X.unregisterOnNextCall&&this._deferUnregister(X)),V.skipNextObservers))return!1}}catch(v){O={error:v}}finally{try{H&&!H.done&&(M=W.return)&&M.call(W)}finally{if(O)throw O.error}}return!0},t.prototype.notifyObserversWithPromise=function(v,A,E,R){var O=this;void 0===A&&(A=-1);var M=Promise.resolve(v);if(!this._observers.length)return M;var V=this._eventState;return V.mask=A,V.target=E,V.currentTarget=R,V.skipNextObservers=!1,this._observers.forEach((function(E){V.skipNextObservers||E._willBeUnregistered||E.mask&A&&(M=E.scope?M.then((function(A){return V.lastReturnValue=A,E.callback.apply(E.scope,[v,V])})):M.then((function(A){return V.lastReturnValue=A,E.callback(v,V)})),E.unregisterOnNextCall&&O._deferUnregister(E))})),M.then((function(){return v}))},t.prototype.notifyObserver=function(v,A,E){void 0===E&&(E=-1);var R=this._eventState;R.mask=E,R.skipNextObservers=!1,v.callback(A,R)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var v=new t;return v._observers=this._observers.slice(0),v},t.prototype.hasSpecificMask=function(v){var A,E;void 0===v&&(v=-1);try{for(var R=h(this._observers),O=R.next();!O.done;O=R.next()){var M=O.value;if(M.mask&v||M.mask===v)return!0}}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(A)throw A.error}}return!1},t.prototype._deferUnregister=function(v){var A=this;v.unregisterOnNextCall=!1,v._willBeUnregistered=!0,G((function(){return function(v,A,E,R){return new(E||(E=Promise))((function(A,O){function s(v){try{d(R.next(v))}catch(v){O(v)}}function a(v){try{d(R.throw(v))}catch(v){O(v)}}function d(v){var R;v.done?A(v.value):(R=v.value,R instanceof E?R:new E((function(v){v(R)}))).then(s,a)}d((R=R.apply(v,[])).next())}))}(A,0,void 0,(function(){return function(v,A){var E,R,O,M,V={label:0,sent:function(){if(1&O[0])throw O[1];return O[1]},trys:[],ops:[]};return M={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function a(M){return function(W){return function(M){if(E)throw new TypeError("Generator is already executing.");for(;V;)try{if(E=1,R&&(O=2&M[0]?R.return:M[0]?R.throw||((O=R.return)&&O.call(R),0):R.next)&&!(O=O.call(R,M[1])).done)return O;switch(R=0,O&&(M=[2&M[0],O.value]),M[0]){case 0:case 1:O=M;break;case 4:return V.label++,{value:M[1],done:!1};case 5:V.label++,R=M[1],M=[0];continue;case 7:M=V.ops.pop(),V.trys.pop();continue;default:if(!((O=(O=V.trys).length>0&&O[O.length-1])||6!==M[0]&&2!==M[0])){V=0;continue}if(3===M[0]&&(!O||M[1]>O[0]&&M[1]<O[3])){V.label=M[1];break}if(6===M[0]&&V.label<O[1]){V.label=O[1],O=M;break}if(O&&V.label<O[2]){V.label=O[2],V.ops.push(M);break}O[2]&&V.ops.pop(),V.trys.pop();continue}M=A.call(v,V)}catch(v){M=[6,v],R=0}finally{E=O=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,W])}}}(this,(function(A){return[2,this._remove(v)]}))}))}))},t.prototype._remove=function(v){if(!v)return!1;var A=this._observers.indexOf(v);return-1!==A&&(this._observers.splice(A,1),!0)},t}(),dt=r([x(),s("design:paramtypes",[String,Object])],(function(v,A){this.uuid=v,this.payload=A})),gt=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v})),ft=r([x(),s("design:paramtypes",[Object])],(function(v){this.payload=v}));function tt(v){return function(){ct&&ct.subscribe(v)}}var yt=new pt(tt("cameraModeChanged")),bt=new pt(tt("idleStateChanged")),vt=new pt(tt("onEnterScene")),wt=vt,Tt=new pt(tt("onLeaveScene")),xt=Tt,St=new pt(tt("sceneStart")),Ct=new pt(tt("playerExpression")),At=new pt(tt("onPointerLock")),_t=new pt(tt("videoEvent")),It=new pt(tt("profileChanged")),Pt=new pt(tt("playerConnected")),Rt=new pt(tt("playerDisconnected")),Ot=new pt(tt("onRealmChanged")),kt=new pt(tt("playerClicked"));function mt(v){(ct=v)&&ct.onEvent((function(v){switch(v.type){case"onEnterScene":return void vt.notifyObservers(v.data);case"onLeaveScene":return void Tt.notifyObservers(v.data);case"cameraModeChanged":return void yt.notifyObservers(v.data);case"idleStateChanged":return void bt.notifyObservers(v.data);case"sceneStart":return void St.notifyObservers(v.data);case"playerExpression":return void Ct.notifyObservers(v.data);case"videoEvent":var A=v.data,E=N.engine.disposableComponents[A.componentId];return E&&E.update(A),void _t.notifyObservers(A);case"profileChanged":return void It.notifyObservers(v.data);case"onPointerLock":return void At.notifyObservers(v.data);case"playerConnected":return void Pt.notifyObservers(v.data);case"playerDisconnected":return void Rt.notifyObservers(v.data);case"onRealmChanged":return void Ot.notifyObservers(v.data);case"playerClicked":return void kt.notifyObservers(v.data)}}))}var Lt=function(){function t(v){this.dcl=v,this.cachedComponents={}}return t.prototype.activate=function(v){var A=this;this.engine=v,v.eventManager.addListener(W,this,this.componentAdded),v.eventManager.addListener(V,this,this.componentRemoved),v.eventManager.addListener(J,this,this.disposableComponentCreated),v.eventManager.addListener(et,this,this.disposableComponentRemoved),v.eventManager.addListener(it,this,this.disposableComponentUpdated),v.eventManager.addListener(H,this,this.parentChanged);var E=v.rootEntity.uuid;this.dcl.addEntity(E),this.dcl.onUpdate((function(E){v.update(E),A.presentEntities()})),this.dcl.onEvent((function(A){var E=A.data;switch(A.type){case"uuidEvent":v.eventManager.fireEvent(new dt(E.uuid,E.payload));break;case"raycastResponse":("HitFirst"===E.queryType||"HitAll"===E.queryType)&&v.eventManager.fireEvent(new gt(E));break;case"actionButtonEvent":v.eventManager.fireEvent(new ft(E.payload))}}))},t.prototype.onAddEntity=function(v){if(v&&v.isAddedToEngine()){var A=v.uuid,E=v.getParent();for(var R in this.dcl.addEntity(A),E&&this.dcl.setParent(A,E.uuid),this.cachedComponents[A]={},v.components){var O=v.components[R],M=L(O);if(null!==M)if(U(O))this.dcl.attachEntityComponent(v.uuid,R,D(O));else{var V=JSON.stringify(O);this.dcl.updateEntityComponent(A,R,M,V),this.cachedComponents[A][R]=V}}}},t.prototype.onRemoveEntity=function(v){if(v.isAddedToEngine()){var A=v.uuid;this.dcl.removeEntity(A),delete this.cachedComponents[A]}},t.prototype.presentEntities=function(){for(var v in this.engine.entities){var A=this.engine.entities[v];for(var E in A.components){var R=L(V=A.components[E]);if(null!==R&&!U(V)){var O=this.getJsonIfDirty(A.uuid,E,V);O&&(this.dcl.updateEntityComponent(A.uuid,E,R,O),this.clearDirty(A.uuid,E,V,O))}}}for(var M in this.engine.disposableComponents){var V;(V=this.engine.disposableComponents[M])instanceof nt&&V.dirty&&(this.dcl.componentUpdated(M,JSON.stringify(V)),V.dirty=!1)}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var A=v.entity.components[v.componentName];if(U(A))this.dcl.attachEntityComponent(v.entity.uuid,v.componentName,D(A));else if(null!==v.classId){var E=JSON.stringify(A);this.dcl.updateEntityComponent(v.entity.uuid,v.componentName,v.classId,E),this.cachedComponents[v.entity.uuid][v.componentName]=E}}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(v.entity.uuid,v.componentName),delete this.cachedComponents[v.entity.uuid][v.componentName])},t.prototype.disposableComponentCreated=function(v){this.dcl.componentCreated(v.componentId,v.componentName,v.classId)},t.prototype.disposableComponentRemoved=function(v){this.dcl.componentDisposed(v.componentId)},t.prototype.disposableComponentUpdated=function(v){this.dcl.componentUpdated(v.componentId,JSON.stringify(v.component))},t.prototype.parentChanged=function(v){this.dcl.setParent(v.entity.uuid,v.parent?v.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(v,A,E){var R=JSON.stringify(E);return R!==this.cachedComponents[v][A]&&R},t.prototype.clearDirty=function(v,A,E,R){this.cachedComponents[v][A]=R},t}(),Nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},zt={},Bt={};!function(v){var A,E;Object.defineProperty(v,"__esModule",{value:!0}),v.RAD2DEG=v.DEG2RAD=v.Epsilon=v.ToLinearSpace=v.ToGammaSpace=v.Space=v.Orientation=void 0,(A=v.Orientation||(v.Orientation={}))[A.CW=0]="CW",A[A.CCW=1]="CCW",(E=v.Space||(v.Space={}))[E.LOCAL=0]="LOCAL",E[E.WORLD=1]="WORLD",E[E.BONE=2]="BONE",v.ToGammaSpace=1/2.2,v.ToLinearSpace=2.2,v.Epsilon=1e-6,v.DEG2RAD=Math.PI/180,v.RAD2DEG=360/(2*Math.PI)}(Bt);var Ft={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.buildArray=void 0,Vt.buildArray=function(v,A){const E=[];for(let R=0;R<v;++R)E.push(A());return E};var Ut={},Wt={},Ht={},Gt={},Yt={};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.Scalar=void 0;class Et{static WithinEpsilon(v,A,E=1401298e-51){const R=v-A;return-E<=R&&R<=E}static ToHex(v){const A=v.toString(16);return v<=15?("0"+A).toUpperCase():A.toUpperCase()}static Sign(v){const A=+v;return 0===A||isNaN(A)?A:A>0?1:-1}static Clamp(v,A=0,E=1){return Math.min(E,Math.max(A,v))}static Log2(v){return Math.log(v)*Math.LOG2E}static Repeat(v,A){return v-Math.floor(v/A)*A}static Normalize(v,A,E){return(v-A)/(E-A)}static Denormalize(v,A,E){return v*(E-A)+A}static DeltaAngle(v,A){let E=Et.Repeat(A-v,360);return E>180&&(E-=360),E}static PingPong(v,A){const E=Et.Repeat(v,2*A);return A-Math.abs(E-A)}static SmoothStep(v,A,E){let R=Et.Clamp(E);return R=-2*R*R*R+3*R*R,A*R+v*(1-R)}static MoveTowards(v,A,E){let R=0;return R=Math.abs(A-v)<=E?A:v+Et.Sign(A-v)*E,R}static MoveTowardsAngle(v,A,E){const R=Et.DeltaAngle(v,A);let O=0;return O=-E<R&&R<E?A:Et.MoveTowards(v,v+R,E),O}static Lerp(v,A,E){return v+(A-v)*E}static LerpAngle(v,A,E){let R=Et.Repeat(A-v,360);return R>180&&(R-=360),v+R*Et.Clamp(E)}static InverseLerp(v,A,E){let R=0;return R=v!==A?Et.Clamp((E-v)/(A-v)):0,R}static Hermite(v,A,E,R,O){const M=O*O,V=O*M;return v*(2*V-3*M+1)+E*(-2*V+3*M)+A*(V-2*M+O)+R*(V-M)}static RandomRange(v,A){return v===A?v:Math.random()*(A-v)+v}static RangeToPercent(v,A,E){return(v-A)/(E-A)}static PercentToRange(v,A,E){return(E-A)*v+A}static NormalizeRadians(v){return v-Et.TwoPi*Math.floor((v+Math.PI)/Et.TwoPi)}}Yt.Scalar=Et,Et.TwoPi=2*Math.PI,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.Vector4=void 0;const qt=Bt,Qt=Yt,Zt=Ut;class Mt{constructor(v,A,E,R){this.x=v,this.y=A,this.z=E,this.w=R}static Add(v,A){return new Mt(v.x,v.y,v.z,v.w).addInPlace(A)}static FromArray(v,A=0){return new Mt(v[A],v[A+1],v[A+2],v[A+3])}static FromArrayToRef(v,A,E){E.x=v[A],E.y=v[A+1],E.z=v[A+2],E.w=v[A+3]}static FromFloatArrayToRef(v,A,E){Mt.FromArrayToRef(v,A,E)}static FromFloatsToRef(v,A,E,R,O){O.x=v,O.y=A,O.z=E,O.w=R}static Zero(){return new Mt(0,0,0,0)}static One(){return new Mt(1,1,1,1)}static Normalize(v){const A=Mt.Zero();return Mt.NormalizeToRef(v,A),A}static NormalizeToRef(v,A){A.copyFrom(v),A.normalize()}static Minimize(v,A){const E=new Mt(v.x,v.y,v.z,v.w);return E.minimizeInPlace(A),E}static Maximize(v,A){const E=new Mt(v.x,v.y,v.z,v.w);return E.maximizeInPlace(A),E}static Distance(v,A){return Math.sqrt(Mt.DistanceSquared(v,A))}static DistanceSquared(v,A){const E=v.x-A.x,R=v.y-A.y,O=v.z-A.z,M=v.w-A.w;return E*E+R*R+O*O+M*M}static Center(v,A){const E=Mt.Add(v,A);return E.scaleInPlace(.5),E}static TransformNormal(v,A){const E=Mt.Zero();return Mt.TransformNormalToRef(v,A,E),E}static TransformNormalToRef(v,A,E){const R=A.m,O=v.x*R[0]+v.y*R[4]+v.z*R[8],M=v.x*R[1]+v.y*R[5]+v.z*R[9],V=v.x*R[2]+v.y*R[6]+v.z*R[10];E.x=O,E.y=M,E.z=V,E.w=v.w}static TransformNormalFromFloatsToRef(v,A,E,R,O,M){const V=O.m;M.x=v*V[0]+A*V[4]+E*V[8],M.y=v*V[1]+A*V[5]+E*V[9],M.z=v*V[2]+A*V[6]+E*V[10],M.w=R}toString(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"}getClassName(){return"Vector4"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,A=0){return v[A]=this.x,v[A+1]=this.y,v[A+2]=this.z,v[A+3]=this.w,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}add(v){return new Mt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addToRef(v,A){return A.x=this.x+v.x,A.y=this.y+v.y,A.z=this.z+v.z,A.w=this.w+v.w,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this.w-=v.w,this}subtract(v){return new Mt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}subtractToRef(v,A){return A.x=this.x-v.x,A.y=this.y-v.y,A.z=this.z-v.z,A.w=this.w-v.w,this}subtractFromFloats(v,A,E,R){return new Mt(this.x-v,this.y-A,this.z-E,this.w-R)}subtractFromFloatsToRef(v,A,E,R,O){return O.x=this.x-v,O.y=this.y-A,O.z=this.z-E,O.w=this.w-R,this}negate(){return new Mt(-this.x,-this.y,-this.z,-this.w)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scale(v){return new Mt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,A){return A.x=this.x*v,A.y=this.y*v,A.z=this.z*v,A.w=this.w*v,this}scaleAndAddToRef(v,A){return A.x+=this.x*v,A.y+=this.y*v,A.z+=this.z*v,A.w+=this.w*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}equalsWithEpsilon(v,A=qt.Epsilon){return v&&Qt.Scalar.WithinEpsilon(this.x,v.x,A)&&Qt.Scalar.WithinEpsilon(this.y,v.y,A)&&Qt.Scalar.WithinEpsilon(this.z,v.z,A)&&Qt.Scalar.WithinEpsilon(this.w,v.w,A)}equalsToFloats(v,A,E,R){return this.x===v&&this.y===A&&this.z===E&&this.w===R}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this.w*=v.w,this}multiply(v){return new Mt(this.x*v.x,this.y*v.y,this.z*v.z,this.w*v.w)}multiplyToRef(v,A){return A.x=this.x*v.x,A.y=this.y*v.y,A.z=this.z*v.z,A.w=this.w*v.w,this}multiplyByFloats(v,A,E,R){return new Mt(this.x*v,this.y*A,this.z*E,this.w*R)}divide(v){return new Mt(this.x/v.x,this.y/v.y,this.z/v.z,this.w/v.w)}divideToRef(v,A){return A.x=this.x/v.x,A.y=this.y/v.y,A.z=this.z/v.z,A.w=this.w/v.w,this}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return v.x<this.x&&(this.x=v.x),v.y<this.y&&(this.y=v.y),v.z<this.z&&(this.z=v.z),v.w<this.w&&(this.w=v.w),this}maximizeInPlace(v){return v.x>this.x&&(this.x=v.x),v.y>this.y&&(this.y=v.y),v.z>this.z&&(this.z=v.z),v.w>this.w&&(this.w=v.w),this}floor(){return new Mt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))}fract(){return new Mt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}normalize(){const v=this.length();return 0===v?this:this.scaleInPlace(1/v)}toVector3(){return new Zt.Vector3(this.x,this.y,this.z)}clone(){return new Mt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,A,E,R){return this.x=v,this.y=A,this.z=E,this.w=R,this}set(v,A,E,R){return this.copyFromFloats(v,A,E,R)}setAll(v){return this.x=this.y=this.z=this.w=v,this}}Gt.Vector4=Mt,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.Matrix=void 0;const Kt=Ut,$t=Wt,Jt=Ft,ee=Gt;class Dt{constructor(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}get m(){return this._m}static get IdentityReadOnly(){return Dt._identityReadOnly}static FromArray(v,A=0){const E=new Dt;return Dt.FromArrayToRef(v,A,E),E}static FromArrayToRef(v,A,E){for(let R=0;R<16;R++)E._m[R]=v[R+A];E._markAsUpdated()}static FromFloatArrayToRefScaled(v,A,E,R){for(let O=0;O<16;O++)R._m[O]=v[O+A]*E;R._markAsUpdated()}static FromValuesToRef(v,A,E,R,O,M,V,W,H,X,Z,K,$,J,et,it,nt){const ot=nt._m;ot[0]=v,ot[1]=A,ot[2]=E,ot[3]=R,ot[4]=O,ot[5]=M,ot[6]=V,ot[7]=W,ot[8]=H,ot[9]=X,ot[10]=Z,ot[11]=K,ot[12]=$,ot[13]=J,ot[14]=et,ot[15]=it,nt._markAsUpdated()}static FromValues(v,A,E,R,O,M,V,W,H,X,Z,K,$,J,et,it){const nt=new Dt,ot=nt._m;return ot[0]=v,ot[1]=A,ot[2]=E,ot[3]=R,ot[4]=O,ot[5]=M,ot[6]=V,ot[7]=W,ot[8]=H,ot[9]=X,ot[10]=Z,ot[11]=K,ot[12]=$,ot[13]=J,ot[14]=et,ot[15]=it,nt._markAsUpdated(),nt}static Compose(v,A,E){const R=new Dt;return Dt.ComposeToRef(v,A,E,R),R}static ComposeToRef(v,A,E,R){Dt.ScalingToRef(v.x,v.y,v.z,Jt.MathTmp.Matrix[1]),A.toRotationMatrix(Jt.MathTmp.Matrix[0]),Jt.MathTmp.Matrix[1].multiplyToRef(Jt.MathTmp.Matrix[0],R),R.setTranslation(E)}static Identity(){const v=Dt.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return v._updateIdentityStatus(!0),v}static IdentityToRef(v){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,v),v._updateIdentityStatus(!0)}static Zero(){const v=Dt.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return v._updateIdentityStatus(!1),v}static RotationX(v){const A=new Dt;return Dt.RotationXToRef(v,A),A}static Invert(v){const A=new Dt;return v.invertToRef(A),A}static RotationXToRef(v,A){const E=Math.sin(v),R=Math.cos(v);Dt.FromValuesToRef(1,0,0,0,0,R,E,0,0,-E,R,0,0,0,0,1,A),A._updateIdentityStatus(1===R&&0===E)}static RotationY(v){const A=new Dt;return Dt.RotationYToRef(v,A),A}static RotationYToRef(v,A){const E=Math.sin(v),R=Math.cos(v);Dt.FromValuesToRef(R,0,-E,0,0,1,0,0,E,0,R,0,0,0,0,1,A),A._updateIdentityStatus(1===R&&0===E)}static RotationZ(v){const A=new Dt;return Dt.RotationZToRef(v,A),A}static RotationZToRef(v,A){const E=Math.sin(v),R=Math.cos(v);Dt.FromValuesToRef(R,E,0,0,-E,R,0,0,0,0,1,0,0,0,0,1,A),A._updateIdentityStatus(1===R&&0===E)}static RotationAxis(v,A){const E=new Dt;return Dt.RotationAxisToRef(v,A,E),E}static RotationAxisToRef(v,A,E){const R=Math.sin(-A),O=Math.cos(-A),M=1-O;v.normalize();const V=E._m;V[0]=v.x*v.x*M+O,V[1]=v.x*v.y*M-v.z*R,V[2]=v.x*v.z*M+v.y*R,V[3]=0,V[4]=v.y*v.x*M+v.z*R,V[5]=v.y*v.y*M+O,V[6]=v.y*v.z*M-v.x*R,V[7]=0,V[8]=v.z*v.x*M-v.y*R,V[9]=v.z*v.y*M+v.x*R,V[10]=v.z*v.z*M+O,V[11]=0,V[12]=0,V[13]=0,V[14]=0,V[15]=1,E._markAsUpdated()}static RotationYawPitchRoll(v,A,E){const R=new Dt;return Dt.RotationYawPitchRollToRef(v,A,E,R),R}static RotationYawPitchRollToRef(v,A,E,R){$t.Quaternion.RotationYawPitchRollToRef(v,A,E,Jt.MathTmp.Quaternion[0]),Jt.MathTmp.Quaternion[0].toRotationMatrix(R)}static Scaling(v,A,E){const R=new Dt;return Dt.ScalingToRef(v,A,E,R),R}static ScalingToRef(v,A,E,R){Dt.FromValuesToRef(v,0,0,0,0,A,0,0,0,0,E,0,0,0,0,1,R),R._updateIdentityStatus(1===v&&1===A&&1===E)}static Translation(v,A,E){const R=new Dt;return Dt.TranslationToRef(v,A,E,R),R}static TranslationToRef(v,A,E,R){Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v,A,E,1,R),R._updateIdentityStatus(0===v&&0===A&&0===E)}static Lerp(v,A,E){const R=new Dt;return Dt.LerpToRef(v,A,E,R),R}static LerpToRef(v,A,E,R){for(let O=0;O<16;O++)R._m[O]=v._m[O]*(1-E)+A._m[O]*E;R._markAsUpdated()}static DecomposeLerp(v,A,E){const R=new Dt;return Dt.DecomposeLerpToRef(v,A,E,R),R}static DecomposeLerpToRef(v,A,E,R){const O=Jt.MathTmp.Vector3[0],M=Jt.MathTmp.Quaternion[0],V=Jt.MathTmp.Vector3[1];v.decompose(O,M,V);const W=Jt.MathTmp.Vector3[2],H=Jt.MathTmp.Quaternion[1],X=Jt.MathTmp.Vector3[3];A.decompose(W,H,X);const Z=Jt.MathTmp.Vector3[4];Kt.Vector3.LerpToRef(O,W,E,Z);const K=Jt.MathTmp.Quaternion[2];$t.Quaternion.SlerpToRef(M,H,E,K);const $=Jt.MathTmp.Vector3[5];Kt.Vector3.LerpToRef(V,X,E,$),Dt.ComposeToRef(Z,K,$,R)}static LookAtLH(v,A,E){const R=new Dt;return Dt.LookAtLHToRef(v,A,E,R),R}static LookAtLHToRef(v,A,E,R){const O=Jt.MathTmp.Vector3[0],M=Jt.MathTmp.Vector3[1],V=Jt.MathTmp.Vector3[2];A.subtractToRef(v,V),V.normalize(),Kt.Vector3.CrossToRef(E,V,O);const W=O.lengthSquared();0===W?O.x=1:O.normalizeFromLength(Math.sqrt(W)),Kt.Vector3.CrossToRef(V,O,M),M.normalize();const H=-Kt.Vector3.Dot(O,v),X=-Kt.Vector3.Dot(M,v),Z=-Kt.Vector3.Dot(V,v);Dt.FromValuesToRef(O.x,M.x,V.x,0,O.y,M.y,V.y,0,O.z,M.z,V.z,0,H,X,Z,1,R)}static LookAtRH(v,A,E){const R=new Dt;return Dt.LookAtRHToRef(v,A,E,R),R}static LookAtRHToRef(v,A,E,R){const O=Jt.MathTmp.Vector3[0],M=Jt.MathTmp.Vector3[1],V=Jt.MathTmp.Vector3[2];v.subtractToRef(A,V),V.normalize(),Kt.Vector3.CrossToRef(E,V,O);const W=O.lengthSquared();0===W?O.x=1:O.normalizeFromLength(Math.sqrt(W)),Kt.Vector3.CrossToRef(V,O,M),M.normalize();const H=-Kt.Vector3.Dot(O,v),X=-Kt.Vector3.Dot(M,v),Z=-Kt.Vector3.Dot(V,v);Dt.FromValuesToRef(O.x,M.x,V.x,0,O.y,M.y,V.y,0,O.z,M.z,V.z,0,H,X,Z,1,R)}static OrthoLH(v,A,E,R){const O=new Dt;return Dt.OrthoLHToRef(v,A,E,R,O),O}static OrthoLHToRef(v,A,E,R,O){const M=2/v,V=2/A,W=2/(R-E),H=-(R+E)/(R-E);Dt.FromValuesToRef(M,0,0,0,0,V,0,0,0,0,W,0,0,0,H,1,O),O._updateIdentityStatus(1===M&&1===V&&1===W&&0===H)}static OrthoOffCenterLH(v,A,E,R,O,M){const V=new Dt;return Dt.OrthoOffCenterLHToRef(v,A,E,R,O,M,V),V}static OrthoOffCenterLHToRef(v,A,E,R,O,M,V){const W=2/(A-v),H=2/(R-E),X=2/(M-O),Z=-(M+O)/(M-O),K=(v+A)/(v-A),$=(R+E)/(E-R);Dt.FromValuesToRef(W,0,0,0,0,H,0,0,0,0,X,0,K,$,Z,1,V),V._markAsUpdated()}static OrthoOffCenterRH(v,A,E,R,O,M){const V=new Dt;return Dt.OrthoOffCenterRHToRef(v,A,E,R,O,M,V),V}static OrthoOffCenterRHToRef(v,A,E,R,O,M,V){Dt.OrthoOffCenterLHToRef(v,A,E,R,O,M,V),V._m[10]*=-1}static PerspectiveLH(v,A,E,R){const O=new Dt,M=2*E/v,V=2*E/A,W=(R+E)/(R-E),H=-2*R*E/(R-E);return Dt.FromValuesToRef(M,0,0,0,0,V,0,0,0,0,W,1,0,0,H,0,O),O._updateIdentityStatus(!1),O}static PerspectiveFovLH(v,A,E,R){const O=new Dt;return Dt.PerspectiveFovLHToRef(v,A,E,R,O),O}static PerspectiveFovLHToRef(v,A,E,R,O,M=!0){const V=E,W=R,H=1/Math.tan(.5*v),X=M?H/A:H,Z=M?H:H*A,K=(W+V)/(W-V),$=-2*W*V/(W-V);Dt.FromValuesToRef(X,0,0,0,0,Z,0,0,0,0,K,1,0,0,$,0,O),O._updateIdentityStatus(!1)}static PerspectiveFovRH(v,A,E,R){const O=new Dt;return Dt.PerspectiveFovRHToRef(v,A,E,R,O),O}static PerspectiveFovRHToRef(v,A,E,R,O,M=!0){const V=E,W=R,H=1/Math.tan(.5*v),X=M?H/A:H,Z=M?H:H*A,K=-(W+V)/(W-V),$=-2*W*V/(W-V);Dt.FromValuesToRef(X,0,0,0,0,Z,0,0,0,0,K,-1,0,0,$,0,O),O._updateIdentityStatus(!1)}static PerspectiveFovWebVRToRef(v,A,E,R,O=!1){const M=O?-1:1,V=Math.tan(v.upDegrees*Math.PI/180),W=Math.tan(v.downDegrees*Math.PI/180),H=Math.tan(v.leftDegrees*Math.PI/180),X=Math.tan(v.rightDegrees*Math.PI/180),Z=2/(H+X),K=2/(V+W),$=R._m;$[0]=Z,$[1]=$[2]=$[3]=$[4]=0,$[5]=K,$[6]=$[7]=0,$[8]=(H-X)*Z*.5,$[9]=-(V-W)*K*.5,$[10]=-E/(A-E),$[11]=1*M,$[12]=$[13]=$[15]=0,$[14]=-2*E*A/(E-A),R._markAsUpdated()}static GetAsMatrix2x2(v){return[v._m[0],v._m[1],v._m[4],v._m[5]]}static GetAsMatrix3x3(v){return[v._m[0],v._m[1],v._m[2],v._m[4],v._m[5],v._m[6],v._m[8],v._m[9],v._m[10]]}static Transpose(v){const A=new Dt;return Dt.TransposeToRef(v,A),A}static TransposeToRef(v,A){const E=A._m,R=v._m;E[0]=R[0],E[1]=R[4],E[2]=R[8],E[3]=R[12],E[4]=R[1],E[5]=R[5],E[6]=R[9],E[7]=R[13],E[8]=R[2],E[9]=R[6],E[10]=R[10],E[11]=R[14],E[12]=R[3],E[13]=R[7],E[14]=R[11],E[15]=R[15],A._updateIdentityStatus(v._isIdentity,v._isIdentityDirty)}static Reflection(v){const A=new Dt;return Dt.ReflectionToRef(v,A),A}static ReflectionToRef(v,A){v.normalize();const E=v.normal.x,R=v.normal.y,O=v.normal.z,M=-2*E,V=-2*R,W=-2*O;Dt.FromValuesToRef(M*E+1,V*E,W*E,0,M*R,V*R+1,W*R,0,M*O,V*O,W*O+1,0,M*v.d,V*v.d,W*v.d,1,A)}static FromXYZAxesToRef(v,A,E,R){Dt.FromValuesToRef(v.x,v.y,v.z,0,A.x,A.y,A.z,0,E.x,E.y,E.z,0,0,0,0,1,R)}static FromQuaternionToRef(v,A){const E=v.x*v.x,R=v.y*v.y,O=v.z*v.z,M=v.x*v.y,V=v.z*v.w,W=v.z*v.x,H=v.y*v.w,X=v.y*v.z,Z=v.x*v.w;A._m[0]=1-2*(R+O),A._m[1]=2*(M+V),A._m[2]=2*(W-H),A._m[3]=0,A._m[4]=2*(M-V),A._m[5]=1-2*(O+E),A._m[6]=2*(X+Z),A._m[7]=0,A._m[8]=2*(W+H),A._m[9]=2*(X-Z),A._m[10]=1-2*(R+E),A._m[11]=0,A._m[12]=0,A._m[13]=0,A._m[14]=0,A._m[15]=1,A._markAsUpdated()}_markAsUpdated(){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0}isIdentity(){if(this._isIdentityDirty){this._isIdentityDirty=!1;const v=this._m;this._isIdentity=1===v[0]&&0===v[1]&&0===v[2]&&0===v[3]&&0===v[4]&&1===v[5]&&0===v[6]&&0===v[7]&&0===v[8]&&0===v[9]&&1===v[10]&&0===v[11]&&0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]}return this._isIdentity}isIdentityAs3x2(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2}determinant(){if(!0===this._isIdentity)return 1;const v=this._m,A=v[0],E=v[1],R=v[2],O=v[3],M=v[4],V=v[5],W=v[6],H=v[7],X=v[8],Z=v[9],K=v[10],$=v[11],J=v[12],et=v[13],it=v[14],nt=v[15],ot=K*nt-it*$,rt=Z*nt-et*$,st=Z*it-et*K,at=X*nt-J*$,ht=X*it-K*J,ct=X*et-J*Z;return A*+(V*ot-W*rt+H*st)+E*-(M*ot-W*at+H*ht)+R*+(M*rt-V*at+H*ct)+O*-(M*st-V*ht+W*ct)}toArray(){return this._m}asArray(){return this._m}invert(){return this.invertToRef(this),this}reset(){return Dt.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this}add(v){const A=new Dt;return this.addToRef(v,A),A}addToRef(v,A){for(let E=0;E<16;E++)A._m[E]=this._m[E]+v._m[E];return A._markAsUpdated(),this}addToSelf(v){for(let A=0;A<16;A++)this._m[A]+=v._m[A];return this._markAsUpdated(),this}invertToRef(v){if(!0===this._isIdentity)return Dt.IdentityToRef(v),this;const A=this._m,E=A[0],R=A[1],O=A[2],M=A[3],V=A[4],W=A[5],H=A[6],X=A[7],Z=A[8],K=A[9],$=A[10],J=A[11],et=A[12],it=A[13],nt=A[14],ot=A[15],rt=$*ot-nt*J,st=K*ot-it*J,at=K*nt-it*$,ht=Z*ot-et*J,ct=Z*nt-$*et,lt=Z*it-et*K,ut=+(W*rt-H*st+X*at),pt=-(V*rt-H*ht+X*ct),dt=+(V*st-W*ht+X*lt),gt=-(V*at-W*ct+H*lt),ft=E*ut+R*pt+O*dt+M*gt;if(0===ft)return v.copyFrom(this),this;const yt=1/ft,bt=H*ot-nt*X,vt=W*ot-it*X,wt=W*nt-it*H,Tt=V*ot-et*X,xt=V*nt-et*H,St=V*it-et*W,Ct=H*J-$*X,At=W*J-K*X,_t=W*$-K*H,It=V*J-Z*X,Pt=V*$-Z*H,Rt=V*K-Z*W,Ot=-(R*rt-O*st+M*at),kt=+(E*rt-O*ht+M*ct),Lt=-(E*st-R*ht+M*lt),Nt=+(E*at-R*ct+O*lt),zt=+(R*bt-O*vt+M*wt),Bt=-(E*bt-O*Tt+M*xt),Ft=+(E*vt-R*Tt+M*St),Vt=-(E*wt-R*xt+O*St),Ut=-(R*Ct-O*At+M*_t),Wt=+(E*Ct-O*It+M*Pt),Ht=-(E*At-R*It+M*Rt),Gt=+(E*_t-R*Pt+O*Rt);return Dt.FromValuesToRef(ut*yt,Ot*yt,zt*yt,Ut*yt,pt*yt,kt*yt,Bt*yt,Wt*yt,dt*yt,Lt*yt,Ft*yt,Ht*yt,gt*yt,Nt*yt,Vt*yt,Gt*yt,v),this}addAtIndex(v,A){return this._m[v]+=A,this._markAsUpdated(),this}multiplyAtIndex(v,A){return this._m[v]*=A,this._markAsUpdated(),this}setTranslationFromFloats(v,A,E){return this._m[12]=v,this._m[13]=A,this._m[14]=E,this._markAsUpdated(),this}setTranslation(v){return this.setTranslationFromFloats(v.x,v.y,v.z)}getTranslation(){return new Kt.Vector3(this._m[12],this._m[13],this._m[14])}getTranslationToRef(v){return v.x=this._m[12],v.y=this._m[13],v.z=this._m[14],this}removeRotationAndScaling(){const v=this.m;return Dt.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,v[12],v[13],v[14],v[15],this),this._updateIdentityStatus(0===v[12]&&0===v[13]&&0===v[14]&&1===v[15]),this}multiply(v){const A=new Dt;return this.multiplyToRef(v,A),A}copyFrom(v){v.copyToArray(this._m);const A=v;return this._updateIdentityStatus(A._isIdentity,A._isIdentityDirty,A._isIdentity3x2,A._isIdentity3x2Dirty),this}copyToArray(v,A=0){for(let E=0;E<16;E++)v[A+E]=this._m[E];return this}multiplyToRef(v,A){return this._isIdentity?(A.copyFrom(v),this):v._isIdentity?(A.copyFrom(this),this):(this.multiplyToArray(v,A._m,0),A._markAsUpdated(),this)}multiplyToArray(v,A,E){const R=this._m,O=v.m,M=R[0],V=R[1],W=R[2],H=R[3],X=R[4],Z=R[5],K=R[6],$=R[7],J=R[8],et=R[9],it=R[10],nt=R[11],ot=R[12],rt=R[13],st=R[14],at=R[15],ht=O[0],ct=O[1],lt=O[2],ut=O[3],pt=O[4],dt=O[5],gt=O[6],ft=O[7],yt=O[8],bt=O[9],vt=O[10],wt=O[11],Tt=O[12],xt=O[13],St=O[14],Ct=O[15];return A[E]=M*ht+V*pt+W*yt+H*Tt,A[E+1]=M*ct+V*dt+W*bt+H*xt,A[E+2]=M*lt+V*gt+W*vt+H*St,A[E+3]=M*ut+V*ft+W*wt+H*Ct,A[E+4]=X*ht+Z*pt+K*yt+$*Tt,A[E+5]=X*ct+Z*dt+K*bt+$*xt,A[E+6]=X*lt+Z*gt+K*vt+$*St,A[E+7]=X*ut+Z*ft+K*wt+$*Ct,A[E+8]=J*ht+et*pt+it*yt+nt*Tt,A[E+9]=J*ct+et*dt+it*bt+nt*xt,A[E+10]=J*lt+et*gt+it*vt+nt*St,A[E+11]=J*ut+et*ft+it*wt+nt*Ct,A[E+12]=ot*ht+rt*pt+st*yt+at*Tt,A[E+13]=ot*ct+rt*dt+st*bt+at*xt,A[E+14]=ot*lt+rt*gt+st*vt+at*St,A[E+15]=ot*ut+rt*ft+st*wt+at*Ct,this}equals(v){const A=v;if(!A)return!1;if((this._isIdentity||A._isIdentity)&&!this._isIdentityDirty&&!A._isIdentityDirty)return this._isIdentity&&A._isIdentity;const E=this.m,R=A.m;return E[0]===R[0]&&E[1]===R[1]&&E[2]===R[2]&&E[3]===R[3]&&E[4]===R[4]&&E[5]===R[5]&&E[6]===R[6]&&E[7]===R[7]&&E[8]===R[8]&&E[9]===R[9]&&E[10]===R[10]&&E[11]===R[11]&&E[12]===R[12]&&E[13]===R[13]&&E[14]===R[14]&&E[15]===R[15]}clone(){const v=new Dt;return v.copyFrom(this),v}getClassName(){return"Matrix"}getHashCode(){let v=this._m[0]||0;for(let A=1;A<16;A++)v=397*v^(this._m[A]||0);return v}decompose(v,A,E){if(this._isIdentity)return E&&E.setAll(0),v&&v.setAll(1),A&&A.copyFromFloats(0,0,0,1),!0;const R=this._m;E&&E.copyFromFloats(R[12],R[13],R[14]);const O=v||Jt.MathTmp.Vector3[0];if(O.x=Math.sqrt(R[0]*R[0]+R[1]*R[1]+R[2]*R[2]),O.y=Math.sqrt(R[4]*R[4]+R[5]*R[5]+R[6]*R[6]),O.z=Math.sqrt(R[8]*R[8]+R[9]*R[9]+R[10]*R[10]),this.determinant()<=0&&(O.y*=-1),0===O.x||0===O.y||0===O.z)return A&&A.copyFromFloats(0,0,0,1),!1;if(A){const v=1/O.x,E=1/O.y,M=1/O.z;Dt.FromValuesToRef(R[0]*v,R[1]*v,R[2]*v,0,R[4]*E,R[5]*E,R[6]*E,0,R[8]*M,R[9]*M,R[10]*M,0,0,0,0,1,Jt.MathTmp.Matrix[0]),$t.Quaternion.FromRotationMatrixToRef(Jt.MathTmp.Matrix[0],A)}return!0}getRow(v){if(v<0||v>3)return null;const A=4*v;return new ee.Vector4(this._m[A+0],this._m[A+1],this._m[A+2],this._m[A+3])}setRow(v,A){return this.setRowFromFloats(v,A.x,A.y,A.z,A.w)}transpose(){return Dt.Transpose(this)}transposeToRef(v){return Dt.TransposeToRef(this,v),this}setRowFromFloats(v,A,E,R,O){if(v<0||v>3)return this;const M=4*v;return this._m[M+0]=A,this._m[M+1]=E,this._m[M+2]=R,this._m[M+3]=O,this._markAsUpdated(),this}scale(v){const A=new Dt;return this.scaleToRef(v,A),A}scaleToRef(v,A){for(let E=0;E<16;E++)A._m[E]=this._m[E]*v;return A._markAsUpdated(),this}scaleAndAddToRef(v,A){for(let E=0;E<16;E++)A._m[E]+=this._m[E]*v;return A._markAsUpdated(),this}toNormalMatrix(v){const A=Jt.MathTmp.Matrix[0];this.invertToRef(A),A.transposeToRef(v);const E=v._m;Dt.FromValuesToRef(E[0],E[1],E[2],0,E[4],E[5],E[6],0,E[8],E[9],E[10],0,0,0,0,1,v)}getRotationMatrix(){const v=new Dt;return this.getRotationMatrixToRef(v),v}getRotationMatrixToRef(v){const A=Jt.MathTmp.Vector3[0];if(!this.decompose(A))return Dt.IdentityToRef(v),this;const E=this._m,R=1/A.x,O=1/A.y,M=1/A.z;return Dt.FromValuesToRef(E[0]*R,E[1]*R,E[2]*R,0,E[4]*O,E[5]*O,E[6]*O,0,E[8]*M,E[9]*M,E[10]*M,0,0,0,0,1,v),this}toggleModelMatrixHandInPlace(){const v=this._m;v[2]*=-1,v[6]*=-1,v[8]*=-1,v[9]*=-1,v[14]*=-1,this._markAsUpdated()}toggleProjectionMatrixHandInPlace(){const v=this._m;v[8]*=-1,v[9]*=-1,v[10]*=-1,v[11]*=-1,this._markAsUpdated()}_updateIdentityStatus(v,A=!1,E=!1,R=!0){this.updateFlag=Dt._updateFlagSeed++,this._isIdentity=v,this._isIdentity3x2=v||E,this._isIdentityDirty=!this._isIdentity&&A,this._isIdentity3x2Dirty=!this._isIdentity3x2&&R}}Ht.Matrix=Dt,Dt._updateFlagSeed=0,Dt._identityReadOnly=Dt.Identity(),Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Quaternion=void 0;const ie=Ht,ne=Ut,oe=Ft,se=Bt,ae=Yt;class jt{constructor(v=0,A=0,E=0,R=1){this.x=v,this.y=A,this.z=E,this.w=R}static FromRotationMatrix(v){const A=new jt;return jt.FromRotationMatrixToRef(v,A),A}static FromRotationMatrixToRef(v,A){const E=v.m,R=E[0],O=E[4],M=E[8],V=E[1],W=E[5],H=E[9],X=E[2],Z=E[6],K=E[10],$=R+W+K;let J;$>0?(J=.5/Math.sqrt($+1),A.w=.25/J,A.x=(Z-H)*J,A.y=(M-X)*J,A.z=(V-O)*J):R>W&&R>K?(J=2*Math.sqrt(1+R-W-K),A.w=(Z-H)/J,A.x=.25*J,A.y=(O+V)/J,A.z=(M+X)/J):W>K?(J=2*Math.sqrt(1+W-R-K),A.w=(M-X)/J,A.x=(O+V)/J,A.y=.25*J,A.z=(H+Z)/J):(J=2*Math.sqrt(1+K-R-W),A.w=(V-O)/J,A.x=(M+X)/J,A.y=(H+Z)/J,A.z=.25*J)}static Dot(v,A){return v.x*A.x+v.y*A.y+v.z*A.z+v.w*A.w}static AreClose(v,A){return jt.Dot(v,A)>=0}static Zero(){return new jt(0,0,0,0)}static Inverse(v){return new jt(-v.x,-v.y,-v.z,v.w)}static IsIdentity(v){return v&&0===v.x&&0===v.y&&0===v.z&&1===v.w}static RotationAxis(v,A){const E=A*se.DEG2RAD;return jt.RotationAxisToRef(v,E,new jt)}static RotationAxisToRef(v,A,E){const R=A*se.DEG2RAD,O=Math.sin(R/2);return v.normalize(),E.w=Math.cos(R/2),E.x=v.x*O,E.y=v.y*O,E.z=v.z*O,E}static FromArray(v,A=0){return new jt(v[A],v[A+1],v[A+2],v[A+3])}static FromEulerAnglesRef(v,A,E,R){return jt.RotationYawPitchRollToRef(A*se.DEG2RAD,v*se.DEG2RAD,E*se.DEG2RAD,R)}static RotationYawPitchRoll(v,A,E){const R=new jt;return jt.RotationYawPitchRollToRef(v,A,E,R),R}static RotationYawPitchRollToRef(v,A,E,R){const O=.5*A,M=.5*v,V=.5*E,W=Math.cos(O),H=Math.cos(M),X=Math.cos(V),Z=Math.sin(O),K=Math.sin(M),$=Math.sin(V);R.x=H*Z*X+K*W*$,R.y=K*W*X-H*Z*$,R.z=H*W*$-K*Z*X,R.w=H*W*X+K*Z*$}static RotationAlphaBetaGamma(v,A,E){const R=new jt;return jt.RotationAlphaBetaGammaToRef(v,A,E,R),R}static RotationAlphaBetaGammaToRef(v,A,E,R){const O=.5*(E+v),M=.5*(E-v),V=.5*A;R.x=Math.cos(M)*Math.sin(V),R.y=Math.sin(M)*Math.sin(V),R.z=Math.sin(O)*Math.cos(V),R.w=Math.cos(O)*Math.cos(V)}static RotationQuaternionFromAxis(v,A,E){const R=new jt(0,0,0,0);return jt.RotationQuaternionFromAxisToRef(v,A,E,R),R}static RotationQuaternionFromAxisToRef(v,A,E,R){const O=oe.MathTmp.Matrix[0];ie.Matrix.FromXYZAxesToRef(v.normalize(),A.normalize(),E.normalize(),O),jt.FromRotationMatrixToRef(O,R)}static Slerp(v,A,E){const R=jt.Identity;return jt.SlerpToRef(v,A,E,R),R}static SlerpToRef(v,A,E,R){let O,M,V=v.x*A.x+v.y*A.y+v.z*A.z+v.w*A.w,W=!1;if(V<0&&(W=!0,V=-V),V>.999999)M=1-E,O=W?-E:E;else{const v=Math.acos(V),A=1/Math.sin(v);M=Math.sin((1-E)*v)*A,O=W?-Math.sin(E*v)*A:Math.sin(E*v)*A}R.x=M*v.x+O*A.x,R.y=M*v.y+O*A.y,R.z=M*v.z+O*A.z,R.w=M*v.w+O*A.w}static Hermite(v,A,E,R,O){const M=O*O,V=O*M,W=2*V-3*M+1,H=-2*V+3*M,X=V-2*M+O,Z=V-M,K=v.x*W+E.x*H+A.x*X+R.x*Z,$=v.y*W+E.y*H+A.y*X+R.y*Z,J=v.z*W+E.z*H+A.z*X+R.z*Z,et=v.w*W+E.w*H+A.w*X+R.w*Z;return new jt(K,$,J,et)}static get Identity(){return new jt(0,0,0,1)}static Angle(v,A){const E=jt.Dot(v,A);return 2*Math.acos(Math.min(Math.abs(E),1))*se.RAD2DEG}static Euler(v,A,E){return jt.RotationYawPitchRoll(A*se.DEG2RAD,v*se.DEG2RAD,E*se.DEG2RAD)}static LookRotation(v,A=oe.MathTmp.staticUp){const E=ne.Vector3.Normalize(v),R=ne.Vector3.Normalize(ne.Vector3.Cross(A,E)),O=ne.Vector3.Cross(E,R),M=R.x,V=R.y,W=R.z,H=O.x,X=O.y,Z=O.z,K=E.x,$=E.y,J=E.z,et=M+X+J,it=new jt;if(et>0){let v=Math.sqrt(et+1);return it.w=.5*v,v=.5/v,it.x=(Z-$)*v,it.y=(K-W)*v,it.z=(V-H)*v,it}if(M>=X&&M>=J){const v=Math.sqrt(1+M-X-J),A=.5/v;return it.x=.5*v,it.y=(V+H)*A,it.z=(W+K)*A,it.w=(Z-$)*A,it}if(X>J){const v=Math.sqrt(1+X-M-J),A=.5/v;return it.x=(H+V)*A,it.y=.5*v,it.z=($+Z)*A,it.w=(K-W)*A,it}const nt=Math.sqrt(1+J-M-X),ot=.5/nt;return it.x=(K+W)*ot,it.y=($+Z)*ot,it.z=.5*nt,it.w=(V-H)*ot,it}static RotateTowards(v,A,E){const R=jt.Angle(v,A);if(0===R)return A;const O=Math.min(1,E/R);return jt.Slerp(v,A,O)}static FromToRotation(v,A,E=oe.MathTmp.staticUp){const R=v.normalize(),O=A.normalize(),M=ne.Vector3.Cross(R,O),V=Math.sqrt(R.lengthSquared()*O.lengthSquared())+ne.Vector3.Dot(R,O);return M.lengthSquared()<1e-4?Math.abs(V)<1e-4?new jt(E.x,E.y,E.z,0).normalized:jt.Identity:new jt(M.x,M.y,M.z,V).normalized}get normalized(){return this.normalize()}setFromToRotation(v,A,E=oe.MathTmp.staticUp){const R=jt.FromToRotation(v,A,E);this.x=R.x,this.y=R.y,this.z=R.z,this.w=R.w}set eulerAngles(v){this.setEuler(v.x,v.y,v.z)}get eulerAngles(){const v=new ne.Vector3,A=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,E=this.x*this.w-this.y*this.z;return E>.4995*A?(v.x=Math.PI/2,v.y=2*Math.atan2(this.y,this.x),v.z=0):E<-.4995*A?(v.x=-Math.PI/2,v.y=-2*Math.atan2(this.y,this.x),v.z=0):(v.x=Math.asin(2*(this.w*this.x-this.y*this.z)),v.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),v.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),v.x*=se.RAD2DEG,v.y*=se.RAD2DEG,v.z*=se.RAD2DEG,v.x=ae.Scalar.Repeat(v.x,360),v.y=ae.Scalar.Repeat(v.y,360),v.z=ae.Scalar.Repeat(v.z,360),v}toString(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`}get length(){return Math.sqrt(this.lengthSquared)}get lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}getClassName(){return"Quaternion"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v=397*v^(this.w||0),v}asArray(){return[this.x,this.y,this.z,this.w]}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z&&this.w===v.w}clone(){return new jt(this.x,this.y,this.z,this.w)}copyFrom(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=v.w,this}copyFromFloats(v,A,E,R){return this.x=v,this.y=A,this.z=E,this.w=R,this}set(v,A,E,R){return this.copyFromFloats(v,A,E,R)}setEuler(v,A,E){return jt.RotationYawPitchRollToRef(A*se.DEG2RAD,v*se.DEG2RAD,E*se.DEG2RAD,this),this}add(v){return new jt(this.x+v.x,this.y+v.y,this.z+v.z,this.w+v.w)}addInPlace(v){return this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this}subtract(v){return new jt(this.x-v.x,this.y-v.y,this.z-v.z,this.w-v.w)}scale(v){return new jt(this.x*v,this.y*v,this.z*v,this.w*v)}scaleToRef(v,A){return A.x=this.x*v,A.y=this.y*v,A.z=this.z*v,A.w=this.w*v,this}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}scaleAndAddToRef(v,A){return A.x+=this.x*v,A.y+=this.y*v,A.z+=this.z*v,A.w+=this.w*v,this}multiply(v){const A=new jt(0,0,0,1);return this.multiplyToRef(v,A),A}multiplyToRef(v,A){const E=this.x*v.w+this.y*v.z-this.z*v.y+this.w*v.x,R=-this.x*v.z+this.y*v.w+this.z*v.x+this.w*v.y,O=this.x*v.y-this.y*v.x+this.z*v.w+this.w*v.z,M=-this.x*v.x-this.y*v.y-this.z*v.z+this.w*v.w;return A.copyFromFloats(E,R,O,M),this}multiplyInPlace(v){return this.multiplyToRef(v,this),this}conjugateToRef(v){return v.copyFromFloats(-this.x,-this.y,-this.z,this.w),this}conjugateInPlace(){return this.x*=-1,this.y*=-1,this.z*=-1,this}conjugate(){return new jt(-this.x,-this.y,-this.z,this.w)}normalize(){const v=1/this.length;return this.x*=v,this.y*=v,this.z*=v,this.w*=v,this}angleAxis(v,A){if(0===A.lengthSquared())return jt.Identity;const E=jt.Identity;let R=v*se.DEG2RAD;R*=.5;let O=A.normalize();return O=A.scaleInPlace(Math.sin(R)),E.x=O.x,E.y=O.y,E.z=O.z,E.w=Math.cos(R),E.normalize()}toRotationMatrix(v){return ie.Matrix.FromQuaternionToRef(this,v),this}fromRotationMatrix(v){return jt.FromRotationMatrixToRef(v,this),this}}Wt.Quaternion=jt,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.Vector3=void 0;const he=Ft,ce=Bt,le=Wt,ue=Yt;class Xt{constructor(v=0,A=0,E=0){this.x=v,this.y=A,this.z=E}get isNonUniform(){const v=Math.abs(this.x),A=Math.abs(this.y);if(v!==A)return!0;const E=Math.abs(this.z);return v!==E||A!==E}static Add(v,A){return new Xt(v.x,v.y,v.z).addInPlace(A)}static GetClipFactor(v,A,E,R){const O=Xt.Dot(v,E)-R;return O/(O-(Xt.Dot(A,E)-R))}static GetAngleBetweenVectors(v,A,E){const R=v.normalizeToRef(he.MathTmp.Vector3[1]),O=A.normalizeToRef(he.MathTmp.Vector3[2]),M=Xt.Dot(R,O),V=he.MathTmp.Vector3[3];return Xt.CrossToRef(R,O,V),Xt.Dot(V,E)>0?Math.acos(M):-Math.acos(M)}static FromArray(v,A=0){return new Xt(v[A],v[A+1],v[A+2])}static FromFloatArray(v,A){return Xt.FromArray(v,A)}static FromArrayToRef(v,A,E){E.x=v[A],E.y=v[A+1],E.z=v[A+2]}static FromFloatArrayToRef(v,A,E){return Xt.FromArrayToRef(v,A,E)}static FromFloatsToRef(v,A,E,R){R.copyFromFloats(v,A,E)}static Zero(){return new Xt(0,0,0)}static One(){return new Xt(1,1,1)}static Up(){return new Xt(0,1,0)}static Down(){return new Xt(0,-1,0)}static Forward(){return new Xt(0,0,1)}static Backward(){return new Xt(0,0,-1)}static Right(){return new Xt(1,0,0)}static Left(){return new Xt(-1,0,0)}static TransformCoordinates(v,A){const E=Xt.Zero();return Xt.TransformCoordinatesToRef(v,A,E),E}static TransformCoordinatesToRef(v,A,E){return Xt.TransformCoordinatesFromFloatsToRef(v.x,v.y,v.z,A,E)}static TransformCoordinatesFromFloatsToRef(v,A,E,R,O){const M=R.m,V=v*M[0]+A*M[4]+E*M[8]+M[12],W=v*M[1]+A*M[5]+E*M[9]+M[13],H=v*M[2]+A*M[6]+E*M[10]+M[14],X=1/(v*M[3]+A*M[7]+E*M[11]+M[15]);O.x=V*X,O.y=W*X,O.z=H*X}static TransformNormal(v,A){const E=Xt.Zero();return Xt.TransformNormalToRef(v,A,E),E}static TransformNormalToRef(v,A,E){this.TransformNormalFromFloatsToRef(v.x,v.y,v.z,A,E)}static TransformNormalFromFloatsToRef(v,A,E,R,O){const M=R.m;O.x=v*M[0]+A*M[4]+E*M[8],O.y=v*M[1]+A*M[5]+E*M[9],O.z=v*M[2]+A*M[6]+E*M[10]}static CatmullRom(v,A,E,R,O){const M=O*O,V=O*M,W=.5*(2*A.x+(-v.x+E.x)*O+(2*v.x-5*A.x+4*E.x-R.x)*M+(-v.x+3*A.x-3*E.x+R.x)*V),H=.5*(2*A.y+(-v.y+E.y)*O+(2*v.y-5*A.y+4*E.y-R.y)*M+(-v.y+3*A.y-3*E.y+R.y)*V),X=.5*(2*A.z+(-v.z+E.z)*O+(2*v.z-5*A.z+4*E.z-R.z)*M+(-v.z+3*A.z-3*E.z+R.z)*V);return new Xt(W,H,X)}static Clamp(v,A,E){const R=new Xt;return Xt.ClampToRef(v,A,E,R),R}static ClampToRef(v,A,E,R){let O=v.x;O=O>E.x?E.x:O,O=O<A.x?A.x:O;let M=v.y;M=M>E.y?E.y:M,M=M<A.y?A.y:M;let V=v.z;V=V>E.z?E.z:V,V=V<A.z?A.z:V,R.copyFromFloats(O,M,V)}static Hermite(v,A,E,R,O){const M=O*O,V=O*M,W=2*V-3*M+1,H=-2*V+3*M,X=V-2*M+O,Z=V-M,K=v.x*W+E.x*H+A.x*X+R.x*Z,$=v.y*W+E.y*H+A.y*X+R.y*Z,J=v.z*W+E.z*H+A.z*X+R.z*Z;return new Xt(K,$,J)}static Lerp(v,A,E){const R=new Xt(0,0,0);return Xt.LerpToRef(v,A,E,R),R}static LerpToRef(v,A,E,R){R.x=v.x+(A.x-v.x)*E,R.y=v.y+(A.y-v.y)*E,R.z=v.z+(A.z-v.z)*E}static Dot(v,A){return v.x*A.x+v.y*A.y+v.z*A.z}static Cross(v,A){const E=Xt.Zero();return Xt.CrossToRef(v,A,E),E}static CrossToRef(v,A,E){const R=v.y*A.z-v.z*A.y,O=v.z*A.x-v.x*A.z,M=v.x*A.y-v.y*A.x;E.copyFromFloats(R,O,M)}static Normalize(v){const A=Xt.Zero();return Xt.NormalizeToRef(v,A),A}static NormalizeToRef(v,A){v.normalizeToRef(A)}static Minimize(v,A){const E=new Xt(v.x,v.y,v.z);return E.minimizeInPlace(A),E}static Maximize(v,A){const E=new Xt(v.x,v.y,v.z);return E.maximizeInPlace(A),E}static Distance(v,A){return Math.sqrt(Xt.DistanceSquared(v,A))}static DistanceSquared(v,A){const E=v.x-A.x,R=v.y-A.y,O=v.z-A.z;return E*E+R*R+O*O}static Center(v,A){const E=Xt.Add(v,A);return E.scaleInPlace(.5),E}static RotationFromAxis(v,A,E){const R=Xt.Zero();return Xt.RotationFromAxisToRef(v,A,E,R),R}static RotationFromAxisToRef(v,A,E,R){const O=he.MathTmp.Quaternion[0];le.Quaternion.RotationQuaternionFromAxisToRef(v,A,E,O),R.copyFrom(O.eulerAngles)}toString(){return`(${this.x}, ${this.y}, ${this.z})`}getClassName(){return"Vector3"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v=397*v^(this.z||0),v}asArray(){const v=[];return this.toArray(v,0),v}toArray(v,A=0){return v[A]=this.x,v[A+1]=this.y,v[A+2]=this.z,this}toQuaternion(){return le.Quaternion.Identity.setEuler(this.y,this.x,this.z)}addInPlace(v){return this.addInPlaceFromFloats(v.x,v.y,v.z)}addInPlaceFromFloats(v,A,E){return this.x+=v,this.y+=A,this.z+=E,this}add(v){return new Xt(this.x+v.x,this.y+v.y,this.z+v.z)}addToRef(v,A){return A.copyFromFloats(this.x+v.x,this.y+v.y,this.z+v.z)}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this.z-=v.z,this}subtract(v){return new Xt(this.x-v.x,this.y-v.y,this.z-v.z)}subtractToRef(v,A){return this.subtractFromFloatsToRef(v.x,v.y,v.z,A)}subtractFromFloats(v,A,E){return new Xt(this.x-v,this.y-A,this.z-E)}subtractFromFloatsToRef(v,A,E,R){return R.copyFromFloats(this.x-v,this.y-A,this.z-E)}applyMatrix4(v){this.applyMatrix4ToRef(v,this)}applyMatrix4ToRef(v,A){const{x:E,y:R,z:O}=this,{m:M}=v,V=1/(M[3]*E+M[7]*R+M[11]*O+M[15]);return A.x=(M[0]*E+M[4]*R+M[8]*O+M[12])*V,A.y=(M[1]*E+M[5]*R+M[9]*O+M[13])*V,A.z=(M[2]*E+M[6]*R+M[10]*O+M[14])*V,A}rotate(v){return this.rotateToRef(v,this)}rotateToRef(v,A){const{x:E,y:R,z:O}=this,{x:M,y:V,z:W,w:H}=v,X=H*E+V*O-W*R,Z=H*R+W*E-M*O,K=H*O+M*R-V*E,$=-M*E-V*R-W*O;return A.x=X*H+$*-M+Z*-W-K*-V,A.y=Z*H+$*-V+K*-M-X*-W,A.z=K*H+$*-W+X*-V-Z*-M,A}negate(){return new Xt(-this.x,-this.y,-this.z)}scaleInPlace(v){return this.x*=v,this.y*=v,this.z*=v,this}scale(v){return new Xt(this.x*v,this.y*v,this.z*v)}scaleToRef(v,A){return A.copyFromFloats(this.x*v,this.y*v,this.z*v)}scaleAndAddToRef(v,A){return A.addInPlaceFromFloats(this.x*v,this.y*v,this.z*v)}equals(v){return v&&this.x===v.x&&this.y===v.y&&this.z===v.z}equalsWithEpsilon(v,A=ce.Epsilon){return v&&ue.Scalar.WithinEpsilon(this.x,v.x,A)&&ue.Scalar.WithinEpsilon(this.y,v.y,A)&&ue.Scalar.WithinEpsilon(this.z,v.z,A)}equalsToFloats(v,A,E){return this.x===v&&this.y===A&&this.z===E}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this}multiply(v){return this.multiplyByFloats(v.x,v.y,v.z)}multiplyToRef(v,A){return A.copyFromFloats(this.x*v.x,this.y*v.y,this.z*v.z)}multiplyByFloats(v,A,E){return new Xt(this.x*v,this.y*A,this.z*E)}divide(v){return new Xt(this.x/v.x,this.y/v.y,this.z/v.z)}divideToRef(v,A){return A.copyFromFloats(this.x/v.x,this.y/v.y,this.z/v.z)}divideInPlace(v){return this.divideToRef(v,this)}minimizeInPlace(v){return this.minimizeInPlaceFromFloats(v.x,v.y,v.z)}maximizeInPlace(v){return this.maximizeInPlaceFromFloats(v.x,v.y,v.z)}minimizeInPlaceFromFloats(v,A,E){return v<this.x&&(this.x=v),A<this.y&&(this.y=A),E<this.z&&(this.z=E),this}maximizeInPlaceFromFloats(v,A,E){return v>this.x&&(this.x=v),A>this.y&&(this.y=A),E>this.z&&(this.z=E),this}floor(){return new Xt(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}fract(){return new Xt(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.normalizeFromLength(this.length())}normalizeFromLength(v){return 0===v||1===v?this:this.scaleInPlace(1/v)}normalizeToNew(){const v=new Xt(0,0,0);return this.normalizeToRef(v),v}normalizeToRef(v){const A=this.length();return 0===A||1===A?v.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/A,v)}clone(){return new Xt(this.x,this.y,this.z)}copyFrom(v){return this.copyFromFloats(v.x,v.y,v.z)}copyFromFloats(v,A,E){return this.x=v,this.y=A,this.z=E,this}set(v,A,E){return this.copyFromFloats(v,A,E)}setAll(v){return this.x=this.y=this.z=v,this}}Ut.Vector3=Xt,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.MathTmp=void 0;const de=Vt,fe=Ut,me=Wt,ye=Ht;Ft.MathTmp={Vector3:(0,de.buildArray)(6,fe.Vector3.Zero),Matrix:(0,de.buildArray)(2,ye.Matrix.Identity),Quaternion:(0,de.buildArray)(3,me.Quaternion.Zero),staticUp:fe.Vector3.Up(),tmpMatrix:ye.Matrix.Zero()};var be={};Object.defineProperty(be,"__esModule",{value:!0}),be.Angle=void 0;class te{constructor(v){this._radians=v,this._radians<0&&(this._radians+=2*Math.PI)}static BetweenTwoPoints(v,A){const E=A.subtract(v),R=Math.atan2(E.y,E.x);return new te(R)}static FromRadians(v){return new te(v)}static FromDegrees(v){return new te(v*Math.PI/180)}degrees(){return 180*this._radians/Math.PI}radians(){return this._radians}}be.Angle=te;var ve={},we={};Object.defineProperty(we,"__esModule",{value:!0}),we.Vector2=void 0;const Te=Bt,Se=Yt;class re{constructor(v=0,A=0){this.x=v,this.y=A}static Zero(){return new re(0,0)}static One(){return new re(1,1)}static Add(v,A){return new re(v.x,v.y).addInPlace(A)}static FromArray(v,A=0){return new re(v[A],v[A+1])}static FromArrayToRef(v,A,E){E.x=v[A],E.y=v[A+1]}static CatmullRom(v,A,E,R,O){const M=O*O,V=O*M,W=.5*(2*A.x+(-v.x+E.x)*O+(2*v.x-5*A.x+4*E.x-R.x)*M+(-v.x+3*A.x-3*E.x+R.x)*V),H=.5*(2*A.y+(-v.y+E.y)*O+(2*v.y-5*A.y+4*E.y-R.y)*M+(-v.y+3*A.y-3*E.y+R.y)*V);return new re(W,H)}static Clamp(v,A,E){let R=v.x;R=R>E.x?E.x:R,R=R<A.x?A.x:R;let O=v.y;return O=O>E.y?E.y:O,O=O<A.y?A.y:O,new re(R,O)}static Hermite(v,A,E,R,O){const M=O*O,V=O*M,W=2*V-3*M+1,H=-2*V+3*M,X=V-2*M+O,Z=V-M,K=v.x*W+E.x*H+A.x*X+R.x*Z,$=v.y*W+E.y*H+A.y*X+R.y*Z;return new re(K,$)}static Lerp(v,A,E){const R=v.x+(A.x-v.x)*E,O=v.y+(A.y-v.y)*E;return new re(R,O)}static Dot(v,A){return v.x*A.x+v.y*A.y}static Normalize(v){const A=new re(v.x,v.y);return A.normalize(),A}static Minimize(v,A){const E=v.x<A.x?v.x:A.x,R=v.y<A.y?v.y:A.y;return new re(E,R)}static Maximize(v,A){const E=v.x>A.x?v.x:A.x,R=v.y>A.y?v.y:A.y;return new re(E,R)}static Transform(v,A){const E=re.Zero();return re.TransformToRef(v,A,E),E}static TransformToRef(v,A,E){const R=A.m,O=v.x*R[0]+v.y*R[4]+R[12],M=v.x*R[1]+v.y*R[5]+R[13];E.x=O,E.y=M}static PointInTriangle(v,A,E,R){const O=.5*(-E.y*R.x+A.y*(-E.x+R.x)+A.x*(E.y-R.y)+E.x*R.y),M=O<0?-1:1,V=(A.y*R.x-A.x*R.y+(R.y-A.y)*v.x+(A.x-R.x)*v.y)*M,W=(A.x*E.y-A.y*E.x+(A.y-E.y)*v.x+(E.x-A.x)*v.y)*M;return V>0&&W>0&&V+W<2*O*M}static Distance(v,A){return Math.sqrt(re.DistanceSquared(v,A))}static DistanceSquared(v,A){const E=v.x-A.x,R=v.y-A.y;return E*E+R*R}static Center(v,A){const E=re.Add(v,A);return E.scaleInPlace(.5),E}static DistanceOfPointFromSegment(v,A,E){const R=re.DistanceSquared(A,E);if(0===R)return re.Distance(v,A);const O=E.subtract(A),M=Math.max(0,Math.min(1,re.Dot(v.subtract(A),O)/R)),V=A.add(O.multiplyByFloats(M,M));return re.Distance(v,V)}toString(){return"{X: "+this.x+" Y:"+this.y+"}"}getClassName(){return"Vector2"}getHashCode(){let v=this.x||0;return v=397*v^(this.y||0),v}toArray(v,A=0){return v[A]=this.x,v[A+1]=this.y,this}asArray(){const v=new Array;return this.toArray(v,0),v}copyFrom(v){return this.x=v.x,this.y=v.y,this}copyFromFloats(v,A){return this.x=v,this.y=A,this}set(v,A){return this.copyFromFloats(v,A)}add(v){return new re(this.x+v.x,this.y+v.y)}addToRef(v,A){return A.x=this.x+v.x,A.y=this.y+v.y,this}addInPlace(v){return this.x+=v.x,this.y+=v.y,this}addVector3(v){return new re(this.x+v.x,this.y+v.y)}subtract(v){return new re(this.x-v.x,this.y-v.y)}subtractToRef(v,A){return A.x=this.x-v.x,A.y=this.y-v.y,this}subtractInPlace(v){return this.x-=v.x,this.y-=v.y,this}multiplyInPlace(v){return this.x*=v.x,this.y*=v.y,this}multiply(v){return new re(this.x*v.x,this.y*v.y)}multiplyToRef(v,A){return A.x=this.x*v.x,A.y=this.y*v.y,this}multiplyByFloats(v,A){return new re(this.x*v,this.y*A)}divide(v){return new re(this.x/v.x,this.y/v.y)}divideToRef(v,A){return A.x=this.x/v.x,A.y=this.y/v.y,this}divideInPlace(v){return this.divideToRef(v,this)}negate(){return new re(-this.x,-this.y)}scaleInPlace(v){return this.x*=v,this.y*=v,this}scale(v){const A=new re(0,0);return this.scaleToRef(v,A),A}scaleToRef(v,A){return A.x=this.x*v,A.y=this.y*v,this}scaleAndAddToRef(v,A){return A.x+=this.x*v,A.y+=this.y*v,this}equals(v){return v&&this.x===v.x&&this.y===v.y}equalsWithEpsilon(v,A=Te.Epsilon){return v&&Se.Scalar.WithinEpsilon(this.x,v.x,A)&&Se.Scalar.WithinEpsilon(this.y,v.y,A)}floor(){return new re(Math.floor(this.x),Math.floor(this.y))}fract(){return new re(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){const v=this.length();if(0===v)return this;const A=1/v;return this.x*=A,this.y*=A,this}clone(){return new re(this.x,this.y)}}we.Vector2=re,Object.defineProperty(ve,"__esModule",{value:!0}),ve.Arc2=void 0;const Ce=be,_e=we,Ee=Bt;ve.Arc2=class{constructor(v,A,E){this.startPoint=v,this.midPoint=A,this.endPoint=E;const R=Math.pow(A.x,2)+Math.pow(A.y,2),O=(Math.pow(v.x,2)+Math.pow(v.y,2)-R)/2,M=(R-Math.pow(E.x,2)-Math.pow(E.y,2))/2,V=(v.x-A.x)*(A.y-E.y)-(A.x-E.x)*(v.y-A.y);this.centerPoint=new _e.Vector2((O*(A.y-E.y)-M*(v.y-A.y))/V,((v.x-A.x)*M-(A.x-E.x)*O)/V),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=Ce.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);const W=this.startAngle.degrees();let H=Ce.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),X=Ce.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();H-W>180&&(H-=360),H-W<-180&&(H+=360),X-H>180&&(X-=360),X-H<-180&&(X+=360),this.orientation=H-W<0?Ee.Orientation.CW:Ee.Orientation.CCW,this.angle=Ce.Angle.FromDegrees(this.orientation===Ee.Orientation.CW?W-X:X-W)}};var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.Axis=void 0;const Pe=Ut;class pe{}Ie.Axis=pe,pe.X=new Pe.Vector3(1,0,0),pe.Y=new Pe.Vector3(0,1,0),pe.Z=new Pe.Vector3(0,0,1);var Re={};Object.defineProperty(Re,"__esModule",{value:!0}),Re.BezierCurve=void 0,Re.BezierCurve=class{static Interpolate(v,A,E,R,O){const M=1-3*R+3*A,V=3*R-6*A,W=3*A;let H=v;for(let A=0;A<5;A++){const A=H*H;H-=1/(3*M*A+2*V*H+W)*(M*(A*H)+V*A+W*H-v),H=Math.min(1,Math.max(0,H))}return 3*Math.pow(1-H,2)*H*E+3*(1-H)*Math.pow(H,2)*O+Math.pow(H,3)}};var Oe={},ke={};Object.defineProperty(ke,"__esModule",{value:!0}),ke.Color4=void 0;const Le=Yt,Ne=Bt;class ge{constructor(v=0,A=0,E=0,R=1){this.r=v,this.g=A,this.b=E,this.a=R}static FromHexString(v){if("#"!==v.substring(0,1)||9!==v.length)return new ge(0,0,0,0);const A=parseInt(v.substring(1,3),16),E=parseInt(v.substring(3,5),16),R=parseInt(v.substring(5,7),16),O=parseInt(v.substring(7,9),16);return ge.FromInts(A,E,R,O)}static Lerp(v,A,E){const R=new ge(0,0,0,0);return ge.LerpToRef(v,A,E,R),R}static LerpToRef(v,A,E,R){R.r=v.r+(A.r-v.r)*E,R.g=v.g+(A.g-v.g)*E,R.b=v.b+(A.b-v.b)*E,R.a=v.a+(A.a-v.a)*E}static Red(){return new ge(1,0,0,1)}static Green(){return new ge(0,1,0,1)}static Blue(){return new ge(0,0,1,1)}static Black(){return new ge(0,0,0,1)}static White(){return new ge(1,1,1,1)}static Purple(){return new ge(.5,0,.5,1)}static Magenta(){return new ge(1,0,1,1)}static Yellow(){return new ge(1,1,0,1)}static Gray(){return new ge(.5,.5,.5,1)}static Teal(){return new ge(0,1,1,1)}static Clear(){return new ge(0,0,0,0)}static FromColor3(v,A=1){return new ge(v.r,v.g,v.b,A)}static FromArray(v,A=0){return new ge(v[A],v[A+1],v[A+2],v[A+3])}static FromInts(v,A,E,R){return new ge(v/255,A/255,E/255,R/255)}static CheckColors4(v,A){if(v.length===3*A){const A=[];for(let E=0;E<v.length;E+=3){const R=E/3*4;A[R]=v[E],A[R+1]=v[E+1],A[R+2]=v[E+2],A[R+3]=1}return A}return v}addInPlace(v){return this.r+=v.r,this.g+=v.g,this.b+=v.b,this.a+=v.a,this}asArray(){const v=new Array;return this.toArray(v,0),v}toArray(v,A=0){return v[A]=this.r,v[A+1]=this.g,v[A+2]=this.b,v[A+3]=this.a,this}add(v){return new ge(this.r+v.r,this.g+v.g,this.b+v.b,this.a+v.a)}subtract(v){return new ge(this.r-v.r,this.g-v.g,this.b-v.b,this.a-v.a)}subtractToRef(v,A){return A.r=this.r-v.r,A.g=this.g-v.g,A.b=this.b-v.b,A.a=this.a-v.a,this}scale(v){return new ge(this.r*v,this.g*v,this.b*v,this.a*v)}scaleToRef(v,A){return A.r=this.r*v,A.g=this.g*v,A.b=this.b*v,A.a=this.a*v,this}scaleAndAddToRef(v,A){return A.r+=this.r*v,A.g+=this.g*v,A.b+=this.b*v,A.a+=this.a*v,this}clampToRef(v=0,A=1,E){return E.r=Le.Scalar.Clamp(this.r,v,A),E.g=Le.Scalar.Clamp(this.g,v,A),E.b=Le.Scalar.Clamp(this.b,v,A),E.a=Le.Scalar.Clamp(this.a,v,A),this}multiply(v){return new ge(this.r*v.r,this.g*v.g,this.b*v.b,this.a*v.a)}multiplyToRef(v,A){return A.r=this.r*v.r,A.g=this.g*v.g,A.b=this.b*v.b,A.a=this.a*v.a,A}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v=397*v^(this.a||0),v}clone(){return new ge(this.r,this.g,this.b,this.a)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this.a=v.a,this}copyFromFloats(v,A,E,R){return this.r=v,this.g=A,this.b=E,this.a=R,this}set(v,A,E,R){return this.copyFromFloats(v,A,E,R)}toHexString(){const v=255*this.r|0,A=255*this.g|0,E=255*this.b|0,R=255*this.a|0;return"#"+Le.Scalar.ToHex(v)+Le.Scalar.ToHex(A)+Le.Scalar.ToHex(E)+Le.Scalar.ToHex(R)}toLinearSpace(){const v=new ge;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,Ne.ToLinearSpace),v.g=Math.pow(this.g,Ne.ToLinearSpace),v.b=Math.pow(this.b,Ne.ToLinearSpace),v.a=this.a,this}toGammaSpace(){const v=new ge;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,Ne.ToGammaSpace),v.g=Math.pow(this.g,Ne.ToGammaSpace),v.b=Math.pow(this.b,Ne.ToGammaSpace),v.a=this.a,this}}ke.Color4=ge,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.Color3=void 0;const Be=Bt,Fe=ke,Ve=Yt;class xe{constructor(v=0,A=0,E=0){this.r=v,this.g=A,this.b=E}static FromHexString(v){if("#"!==v.substring(0,1)||7!==v.length)return new xe(0,0,0);const A=parseInt(v.substring(1,3),16),E=parseInt(v.substring(3,5),16),R=parseInt(v.substring(5,7),16);return xe.FromInts(A,E,R)}static FromArray(v,A=0){return new xe(v[A],v[A+1],v[A+2])}static FromInts(v,A,E){return new xe(v/255,A/255,E/255)}static Lerp(v,A,E){const R=new xe(0,0,0);return xe.LerpToRef(v,A,E,R),R}static LerpToRef(v,A,E,R){R.r=v.r+(A.r-v.r)*E,R.g=v.g+(A.g-v.g)*E,R.b=v.b+(A.b-v.b)*E}static Red(){return new xe(1,0,0)}static Green(){return new xe(0,1,0)}static Blue(){return new xe(0,0,1)}static Black(){return new xe(0,0,0)}static White(){return new xe(1,1,1)}static Purple(){return new xe(.5,0,.5)}static Magenta(){return new xe(1,0,1)}static Yellow(){return new xe(1,1,0)}static Gray(){return new xe(.5,.5,.5)}static Teal(){return new xe(0,1,1)}static Random(){return new xe(Math.random(),Math.random(),Math.random())}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let v=this.r||0;return v=397*v^(this.g||0),v=397*v^(this.b||0),v}toArray(v,A=0){return v[A]=this.r,v[A+1]=this.g,v[A+2]=this.b,this}toColor4(v=1){return new Fe.Color4(this.r,this.g,this.b,v)}asArray(){const v=new Array;return this.toArray(v,0),v}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(v){return new xe(this.r*v.r,this.g*v.g,this.b*v.b)}multiplyToRef(v,A){return A.r=this.r*v.r,A.g=this.g*v.g,A.b=this.b*v.b,this}equals(v){return v&&this.r===v.r&&this.g===v.g&&this.b===v.b}equalsFloats(v,A,E){return this.r===v&&this.g===A&&this.b===E}scale(v){return new xe(this.r*v,this.g*v,this.b*v)}scaleToRef(v,A){return A.r=this.r*v,A.g=this.g*v,A.b=this.b*v,this}scaleAndAddToRef(v,A){return A.r+=this.r*v,A.g+=this.g*v,A.b+=this.b*v,this}clampToRef(v=0,A=1,E){return E.r=Ve.Scalar.Clamp(this.r,v,A),E.g=Ve.Scalar.Clamp(this.g,v,A),E.b=Ve.Scalar.Clamp(this.b,v,A),this}add(v){return new xe(this.r+v.r,this.g+v.g,this.b+v.b)}addToRef(v,A){return A.r=this.r+v.r,A.g=this.g+v.g,A.b=this.b+v.b,this}subtract(v){return new xe(this.r-v.r,this.g-v.g,this.b-v.b)}subtractToRef(v,A){return A.r=this.r-v.r,A.g=this.g-v.g,A.b=this.b-v.b,this}clone(){return new xe(this.r,this.g,this.b)}copyFrom(v){return this.r=v.r,this.g=v.g,this.b=v.b,this}copyFromFloats(v,A,E){return this.r=v,this.g=A,this.b=E,this}set(v,A,E){return this.copyFromFloats(v,A,E)}toHexString(){const v=255*this.r|0,A=255*this.g|0,E=255*this.b|0;return"#"+Ve.Scalar.ToHex(v)+Ve.Scalar.ToHex(A)+Ve.Scalar.ToHex(E)}toLinearSpace(){const v=new xe;return this.toLinearSpaceToRef(v),v}toLinearSpaceToRef(v){return v.r=Math.pow(this.r,Be.ToLinearSpace),v.g=Math.pow(this.g,Be.ToLinearSpace),v.b=Math.pow(this.b,Be.ToLinearSpace),this}toGammaSpace(){const v=new xe;return this.toGammaSpaceToRef(v),v}toGammaSpaceToRef(v){return v.r=Math.pow(this.r,Be.ToGammaSpace),v.g=Math.pow(this.g,Be.ToGammaSpace),v.b=Math.pow(this.b,Be.ToGammaSpace),this}toJSON(){return{r:this.r,g:this.g,b:this.b}}}Oe.Color3=xe;var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.Curve3=void 0;const We=Ut;class Ae{constructor(v){this._length=0,this._points=v,this._length=this._computeLength(v)}static CreateQuadraticBezier(v,A,E,R){R=R>2?R:3;const O=new Array,r=(v,A,E,R)=>(1-v)*(1-v)*A+2*v*(1-v)*E+v*v*R;for(let M=0;M<=R;M++)O.push(new We.Vector3(r(M/R,v.x,A.x,E.x),r(M/R,v.y,A.y,E.y),r(M/R,v.z,A.z,E.z)));return new Ae(O)}static CreateCubicBezier(v,A,E,R,O){O=O>3?O:4;const M=new Array,s=(v,A,E,R,O)=>(1-v)*(1-v)*(1-v)*A+3*v*(1-v)*(1-v)*E+3*v*v*(1-v)*R+v*v*v*O;for(let V=0;V<=O;V++)M.push(new We.Vector3(s(V/O,v.x,A.x,E.x,R.x),s(V/O,v.y,A.y,E.y,R.y),s(V/O,v.z,A.z,E.z,R.z)));return new Ae(M)}static CreateHermiteSpline(v,A,E,R,O){const M=new Array,V=1/O;for(let W=0;W<=O;W++)M.push(We.Vector3.Hermite(v,A,E,R,W*V));return new Ae(M)}static CreateCatmullRomSpline(v,A,E){const R=new Array,O=1/A;let M=0;if(E){const E=v.length;for(let V=0;V<E;V++){M=0;for(let W=0;W<A;W++)R.push(We.Vector3.CatmullRom(v[V%E],v[(V+1)%E],v[(V+2)%E],v[(V+3)%E],M)),M+=O}R.push(R[0])}else{const E=new Array;E.push(v[0].clone()),Array.prototype.push.apply(E,v),E.push(v[v.length-1].clone());let V=0;for(V=0;V<E.length-3;V++){M=0;for(let v=0;v<A;v++)R.push(We.Vector3.CatmullRom(E[V],E[V+1],E[V+2],E[V+3],M)),M+=O}V--,R.push(We.Vector3.CatmullRom(E[V],E[V+1],E[V+2],E[V+3],M))}return new Ae(R)}getPoints(){return this._points}length(){return this._length}continue(v){const A=this._points[this._points.length-1],E=this._points.slice(),R=v.getPoints();for(let v=1;v<R.length;v++)E.push(R[v].subtract(R[0]).add(A));return new Ae(E)}_computeLength(v){let A=0;for(let E=1;E<v.length;E++)A+=v[E].subtract(v[E-1]).length();return A}}Ue.Curve3=Ae;var He={},Xe={};Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.Plane=void 0;const Ge=Ut,Ye=Ht,qe=Ft;class ze{constructor(v,A,E,R){this.normal=new Ge.Vector3(v,A,E),this.d=R}static FromArray(v){return new ze(v[0],v[1],v[2],v[3])}static FromPoints(v,A,E){const R=new ze(0,0,0,0);return R.copyFromPoints(v,A,E),R}static FromPositionAndNormal(v,A){const E=new ze(0,0,0,0);return A.normalize(),E.normal=A,E.d=-(A.x*v.x+A.y*v.y+A.z*v.z),E}static SignedDistanceToPlaneFromPositionAndNormal(v,A,E){const R=-(A.x*v.x+A.y*v.y+A.z*v.z);return Ge.Vector3.Dot(E,A)+R}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new ze(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let v=this.normal.getHashCode();return v=397*v^(this.d||0),v}normalize(){const v=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let A=0;return 0!==v&&(A=1/v),this.normal.x*=A,this.normal.y*=A,this.normal.z*=A,this.d*=A,this}transform(v){const A=qe.MathTmp.Matrix[0];Ye.Matrix.TransposeToRef(v,A);const E=A.m,R=this.normal.x,O=this.normal.y,M=this.normal.z,V=this.d,W=R*E[0]+O*E[1]+M*E[2]+V*E[3],H=R*E[4]+O*E[5]+M*E[6]+V*E[7],X=R*E[8]+O*E[9]+M*E[10]+V*E[11],Z=R*E[12]+O*E[13]+M*E[14]+V*E[15];return new ze(W,H,X,Z)}dotCoordinate(v){return this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z+this.d}copyFromPoints(v,A,E){const R=A.x-v.x,O=A.y-v.y,M=A.z-v.z,V=E.x-v.x,W=E.y-v.y,H=E.z-v.z,X=O*H-M*W,Z=M*V-R*H,K=R*W-O*V,$=Math.sqrt(X*X+Z*Z+K*K);let J;return J=0!==$?1/$:0,this.normal.x=X*J,this.normal.y=Z*J,this.normal.z=K*J,this.d=-(this.normal.x*v.x+this.normal.y*v.y+this.normal.z*v.z),this}isFrontFacingTo(v,A){return Ge.Vector3.Dot(this.normal,v)<=A}signedDistanceTo(v){return Ge.Vector3.Dot(v,this.normal)+this.d}}Xe.Plane=ze,Object.defineProperty(He,"__esModule",{value:!0}),He.Frustum=void 0;const Qe=Xe;class Me{static GetPlanes(v){const A=[];for(let v=0;v<6;v++)A.push(new Qe.Plane(0,0,0,0));return Me.GetPlanesToRef(v,A),A}static GetNearPlaneToRef(v,A){const E=v.m;A.normal.x=E[3]+E[2],A.normal.y=E[7]+E[6],A.normal.z=E[11]+E[10],A.d=E[15]+E[14],A.normalize()}static GetFarPlaneToRef(v,A){const E=v.m;A.normal.x=E[3]-E[2],A.normal.y=E[7]-E[6],A.normal.z=E[11]-E[10],A.d=E[15]-E[14],A.normalize()}static GetLeftPlaneToRef(v,A){const E=v.m;A.normal.x=E[3]+E[0],A.normal.y=E[7]+E[4],A.normal.z=E[11]+E[8],A.d=E[15]+E[12],A.normalize()}static GetRightPlaneToRef(v,A){const E=v.m;A.normal.x=E[3]-E[0],A.normal.y=E[7]-E[4],A.normal.z=E[11]-E[8],A.d=E[15]-E[12],A.normalize()}static GetTopPlaneToRef(v,A){const E=v.m;A.normal.x=E[3]-E[1],A.normal.y=E[7]-E[5],A.normal.z=E[11]-E[9],A.d=E[15]-E[13],A.normalize()}static GetBottomPlaneToRef(v,A){const E=v.m;A.normal.x=E[3]+E[1],A.normal.y=E[7]+E[5],A.normal.z=E[11]+E[9],A.d=E[15]+E[13],A.normalize()}static GetPlanesToRef(v,A){Me.GetNearPlaneToRef(v,A[0]),Me.GetFarPlaneToRef(v,A[1]),Me.GetLeftPlaneToRef(v,A[2]),Me.GetRightPlaneToRef(v,A[3]),Me.GetTopPlaneToRef(v,A[4]),Me.GetBottomPlaneToRef(v,A[5])}}He.Frustum=Me;var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.Path2=void 0;const $e=we,Je=ve,ti=Bt;class De{constructor(v,A){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new $e.Vector2(v,A))}static StartingAt(v,A){return new De(v,A)}addLineTo(v,A){if(this.closed)return this;const E=new $e.Vector2(v,A),R=this._points[this._points.length-1];return this._points.push(E),this._length+=E.subtract(R).length(),this}addArcTo(v,A,E,R,O=36){if(this.closed)return this;const M=this._points[this._points.length-1],V=new $e.Vector2(v,A),W=new $e.Vector2(E,R),H=new Je.Arc2(M,V,W);let X=H.angle.radians()/O;H.orientation===ti.Orientation.CW&&(X*=-1);let Z=H.startAngle.radians()+X;for(let v=0;v<O;v++){const v=Math.cos(Z)*H.radius+H.centerPoint.x,A=Math.sin(Z)*H.radius+H.centerPoint.y;this.addLineTo(v,A),Z+=X}return this}close(){return this.closed=!0,this}length(){let v=this._length;if(!this.closed){const A=this._points[this._points.length-1];v+=this._points[0].subtract(A).length()}return v}getPoints(){return this._points}getPointAtLengthPosition(v){if(v<0||v>1)return $e.Vector2.Zero();const A=v*this.length();let E=0;for(let v=0;v<this._points.length;v++){const R=(v+1)%this._points.length,O=this._points[v],M=this._points[R].subtract(O),V=M.length()+E;if(A>=E&&A<=V){const v=M.normalize(),R=A-E;return new $e.Vector2(O.x+v.x*R,O.y+v.y*R)}E=V}return $e.Vector2.Zero()}}Ze.Path2=De;var ei={};Object.defineProperty(ei,"__esModule",{value:!0}),ei.Path3D=void 0;const ii=Ut,ni=Bt,oi=Yt;ei.Path3D=class{constructor(v,A=null,E){this.path=v,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(let A=0;A<v.length;A++)this._curve[A]=v[A].clone();this._raw=E||!1,this._compute(A)}getCurve(){return this._curve}getTangents(){return this._tangents}getNormals(){return this._normals}getBinormals(){return this._binormals}getDistances(){return this._distances}update(v,A=null){for(let A=0;A<v.length;A++)this._curve[A].x=v[A].x,this._curve[A].y=v[A].y,this._curve[A].z=v[A].z;return this._compute(A),this}_compute(v){const A=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[A-1]=this._curve[A-1].subtract(this._curve[A-2]),this._raw||this._tangents[A-1].normalize();const E=this._tangents[0],R=this._normalVector(this._curve[0],E,v);let O,M,V,W;this._normals[0]=R,this._raw||this._normals[0].normalize(),this._binormals[0]=ii.Vector3.Cross(E,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(let v=1;v<A;v++)O=this._getLastNonNullVector(v),v<A-1&&(M=this._getFirstNonNullVector(v),this._tangents[v]=O.add(M),this._tangents[v].normalize()),this._distances[v]=this._distances[v-1]+O.length(),V=this._tangents[v],W=this._binormals[v-1],this._normals[v]=ii.Vector3.Cross(W,V),this._raw||this._normals[v].normalize(),this._binormals[v]=ii.Vector3.Cross(V,this._normals[v]),this._raw||this._binormals[v].normalize()}_getFirstNonNullVector(v){let A=1,E=this._curve[v+A].subtract(this._curve[v]);for(;0===E.length()&&v+A+1<this._curve.length;)A++,E=this._curve[v+A].subtract(this._curve[v]);return E}_getLastNonNullVector(v){let A=1,E=this._curve[v].subtract(this._curve[v-A]);for(;0===E.length()&&v>A+1;)A++,E=this._curve[v].subtract(this._curve[v-A]);return E}_normalVector(v,A,E){let R,O=A.length();if(0===O&&(O=1),null==E){let v;v=oi.Scalar.WithinEpsilon(Math.abs(A.y)/O,1,ni.Epsilon)?oi.Scalar.WithinEpsilon(Math.abs(A.x)/O,1,ni.Epsilon)?oi.Scalar.WithinEpsilon(Math.abs(A.z)/O,1,ni.Epsilon)?ii.Vector3.Zero():new ii.Vector3(0,0,1):new ii.Vector3(1,0,0):new ii.Vector3(0,-1,0),R=ii.Vector3.Cross(A,v)}else R=ii.Vector3.Cross(A,E),ii.Vector3.CrossToRef(R,A,R);return R.normalize(),R}};var ri={};Object.defineProperty(ri,"__esModule",{value:!0}),ri.Size=void 0;class je{constructor(v,A){this.width=v,this.height=A}get surface(){return this.width*this.height}static Zero(){return new je(0,0)}static Lerp(v,A,E){const R=v.width+(A.width-v.width)*E,O=v.height+(A.height-v.height)*E;return new je(R,O)}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let v=this.width||0;return v=397*v^(this.height||0),v}copyFrom(v){this.width=v.width,this.height=v.height}copyFromFloats(v,A){return this.width=v,this.height=A,this}set(v,A){return this.copyFromFloats(v,A)}multiplyByFloats(v,A){return new je(this.width*v,this.height*A)}clone(){return new je(this.width,this.height)}equals(v){return!!v&&this.width===v.width&&this.height===v.height}add(v){return new je(this.width+v.width,this.height+v.height)}subtract(v){return new je(this.width-v.width,this.height-v.height)}}ri.Size=je,function(v){var A=Nt&&Nt.__createBinding||(Object.create?function(v,A,E,R){void 0===R&&(R=E),Object.defineProperty(v,R,{enumerable:!0,get:function(){return A[E]}})}:function(v,A,E,R){void 0===R&&(R=E),v[R]=A[E]}),E=Nt&&Nt.__exportStar||function(v,E){for(var R in v)"default"===R||Object.prototype.hasOwnProperty.call(E,R)||A(E,v,R)};Object.defineProperty(v,"__esModule",{value:!0}),E(Bt,v),E(Ft,v),E(be,v),E(ve,v),E(Ie,v),E(Re,v),E(Oe,v),E(ke,v),E(Ue,v),E(He,v),E(Ht,v),E(Ze,v),E(ei,v),E(Xe,v),E(Wt,v),E(Yt,v),E(ri,v),E(we,v),E(Ut,v),E(Gt,v),E(zt,v)}(zt);var si,ai,hi,ci,li={looping:!0,speed:1,weight:1,layer:0},ui=function(v){function e(A,E){void 0===E&&(E=li);var R=v.call(this)||this;return R.isAnimationClip=!0,R.looping=li.looping,R.weight=li.weight,R.playing=!1,R.shouldReset=!1,R.speed=li.speed,R.name=f("AnimClip"),R.layer=li.layer,R.clip=A,R.setParams(o({},E)),R}return i(e,v),e.prototype.setParams=function(v){return this.looping=void 0!==v.looping?v.looping:this.looping,this.speed=v.speed||this.speed,this.weight=v.weight||this.weight,this.layer=v.layer||this.layer,this},e.prototype.toJSON=function(){var A=JSON.parse(JSON.stringify(v.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),A},e.prototype.play=function(v){var A;void 0===v&&(v=!1),null===(A=this.owner)||void 0===A||A.play(this,v)},e.prototype.pause=function(){var v;null===(v=this.owner)||void 0===v||v.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var v;null===(v=this.owner)||void 0===v||v.stop(this)},r([nt.readonly,s("design:type",String)],e.prototype,"clip",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"looping",void 0),r([nt.field,s("design:type",Number)],e.prototype,"weight",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"playing",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"shouldReset",void 0),r([nt.field,s("design:type",Number)],e.prototype,"speed",void 0),r([nt.readonly,s("design:type",String)],e.prototype,"name",void 0),e}(nt);v.InputEventType=void 0,(si=v.InputEventType||(v.InputEventType={}))[si.DOWN=0]="DOWN",si[si.UP=1]="UP",v.CameraMode=void 0,(ai=v.CameraMode||(v.CameraMode={}))[ai.FirstPerson=0]="FirstPerson",ai[ai.ThirdPerson=1]="ThirdPerson",ai[ai.BuildingToolGodMode=2]="BuildingToolGodMode",v.LandRole=void 0,(hi=v.LandRole||(v.LandRole={})).OWNER="owner",hi.OPERATOR="operator",v.ActionButton=void 0,(ci=v.ActionButton||(v.ActionButton={})).POINTER="POINTER",ci.PRIMARY="PRIMARY",ci.SECONDARY="SECONDARY",ci.ANY="ANY",ci.FORWARD="FORWARD",ci.BACKWARD="BACKWARD",ci.RIGHT="RIGHT",ci.LEFT="LEFT",ci.JUMP="JUMP",ci.WALK="WALK",ci.ACTION_3="ACTION_3",ci.ACTION_4="ACTION_4",ci.ACTION_5="ACTION_5",ci.ACTION_6="ACTION_6";var pi,di,Ke=function(v){if(this.callback=v,!v||!("apply"in v)||!("call"in v))throw new Error("Callback is not a function");mi.ensureInstance()},gi=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerDown")],e)}(Ke),fi=function(v){function e(){return null!==v&&v.apply(this,arguments)||this}return i(e,v),r([P("pointerUp")],e)}(Ke),en=function(v,A){this.fn=v,this.useRaycast=A},mi=function(){function e(){this.buttonIdMapping=[v.ActionButton.POINTER,v.ActionButton.PRIMARY,v.ActionButton.SECONDARY,v.ActionButton.ANY,v.ActionButton.FORWARD,v.ActionButton.BACKWARD,v.ActionButton.RIGHT,v.ActionButton.LEFT,v.ActionButton.JUMP,v.ActionButton.WALK,v.ActionButton.ACTION_3,v.ActionButton.ACTION_4,v.ActionButton.ACTION_5,v.ActionButton.ACTION_6],this.subscriptions=this.buttonIdMapping.reduce((function(v,A){var E;return o(o({},v),((E={})[A]={BUTTON_DOWN:[],BUTTON_UP:[]},E))}),{}),this.internalState=this.buttonIdMapping.reduce((function(v,A){var E;return o(o({},v),((E={})[A]={BUTTON_DOWN:!1},E))}),{})}return Object.defineProperty(e,"instance",{get:function(){return e.ensureInstance(),e._instance},enumerable:!1,configurable:!0}),e.ensureInstance=function(){e._instance||(e._instance=new e)},e.prototype.isButtonPressed=function(v){return this.internalState[v]},e.prototype.subscribe=function(v,A,E,R){var O=this;return this.subscriptions[A][v].push(new en(R,E)),function(){O.unsubscribe(v,A,R)}},e.prototype.unsubscribe=function(v,A,E){var R=this.getSubscriptionId(v,A,E);return R>-1&&this.subscriptions[A][v].splice(R,1)},e.prototype.handlePointerEvent=function(A){var E=this.getPointerById(A.buttonId);if(E){var R=o(o({},A),{button:E,direction:(new zt.Vector3).copyFrom(A.direction),origin:(new zt.Vector3).copyFrom(A.origin),hit:void 0}),O=A.hit?o(o({},A.hit),{hitPoint:(new zt.Vector3).copyFrom(A.hit.hitPoint),normal:(new zt.Vector3).copyFrom(A.hit.normal),worldNormal:(new zt.Vector3).copyFrom(A.hit.worldNormal)}):void 0;if(A.type===v.InputEventType.DOWN){this.internalState[E].BUTTON_DOWN=!0;for(var M=0;M<this.subscriptions[E].BUTTON_DOWN.length;M++)(V=this.subscriptions[E].BUTTON_DOWN[M]).useRaycast?R.hit=O:R.hit=void 0,V.fn(R);O&&O.entityId&&N.engine&&(H=(W=N.engine.entities[O.entityId])&&W.getComponentOrNull(gi))&&(R.hit=O,H.callback(R))}else{for(this.internalState[E].BUTTON_DOWN=!1,M=0;M<this.subscriptions[E].BUTTON_UP.length;M++){var V;(V=this.subscriptions[E].BUTTON_UP[M]).useRaycast?R.hit=O:R.hit=void 0,V.fn(R)}var W,H;O&&O.entityId&&N.engine&&(H=(W=N.engine.entities[O.entityId])&&W.getComponentOrNull(fi))&&(R.hit=O,H.callback(R))}}},e.prototype.getSubscriptionId=function(v,A,E){for(var R=0;R<this.subscriptions[A][v].length;R++)if(this.subscriptions[A][v][R].fn===E)return R;return-1},e.prototype.getPointerById=function(A){if(A<0||A>=this.buttonIdMapping.length)return null;var E=this.buttonIdMapping[A];return E===v.ActionButton.ANY?null:E},e}();v.CLASS_ID=void 0,(pi=v.CLASS_ID||(v.CLASS_ID={}))[pi.TRANSFORM=1]="TRANSFORM",pi[pi.UUID_CALLBACK=8]="UUID_CALLBACK",pi[pi.BOX_SHAPE=16]="BOX_SHAPE",pi[pi.SPHERE_SHAPE=17]="SPHERE_SHAPE",pi[pi.PLANE_SHAPE=18]="PLANE_SHAPE",pi[pi.CONE_SHAPE=19]="CONE_SHAPE",pi[pi.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",pi[pi.TEXT_SHAPE=21]="TEXT_SHAPE",pi[pi.NFT_SHAPE=22]="NFT_SHAPE",pi[pi.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",pi[pi.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",pi[pi.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",pi[pi.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",pi[pi.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",pi[pi.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",pi[pi.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",pi[pi.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",pi[pi.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",pi[pi.BILLBOARD=32]="BILLBOARD",pi[pi.ANIMATION=33]="ANIMATION",pi[pi.FONT=34]="FONT",pi[pi.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",pi[pi.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",pi[pi.GLTF_SHAPE=54]="GLTF_SHAPE",pi[pi.OBJ_SHAPE=55]="OBJ_SHAPE",pi[pi.AVATAR_SHAPE=56]="AVATAR_SHAPE",pi[pi.BASIC_MATERIAL=64]="BASIC_MATERIAL",pi[pi.PBR_MATERIAL=65]="PBR_MATERIAL",pi[pi.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",pi[pi.SOUND=67]="SOUND",pi[pi.TEXTURE=68]="TEXTURE",pi[pi.VIDEO_CLIP=70]="VIDEO_CLIP",pi[pi.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",pi[pi.AVATAR_TEXTURE=72]="AVATAR_TEXTURE",pi[pi.AUDIO_CLIP=200]="AUDIO_CLIP",pi[pi.AUDIO_SOURCE=201]="AUDIO_SOURCE",pi[pi.AUDIO_STREAM=202]="AUDIO_STREAM",pi[pi.GIZMOS=203]="GIZMOS",pi[pi.SMART_ITEM=204]="SMART_ITEM",pi[pi.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",pi[pi.AVATAR_ATTACH=206]="AVATAR_ATTACH",pi[pi.CAMERA_MODE_AREA=207]="CAMERA_MODE_AREA",pi[pi.NAME=300]="NAME",pi[pi.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",pi[pi.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT",v.AvatarModifiers=void 0,(di=v.AvatarModifiers||(v.AvatarModifiers={})).HIDE_AVATARS="HIDE_AVATARS",di.DISABLE_PASSPORTS="DISABLE_PASSPORTS";var yi,bi=function(A){function n(v){var E=A.call(this)||this;return E.area=v.area,E.modifiers=v.modifiers,E.excludeIds=v.excludeIds,E}return i(n,A),r([nt.field,s("design:type",Object)],n.prototype,"area",void 0),r([nt.field,s("design:type",Array)],n.prototype,"modifiers",void 0),r([nt.field,s("design:type",Array)],n.prototype,"excludeIds",void 0),r([P("engine.avatarModifierArea",v.CLASS_ID.AVATAR_MODIFIER_AREA),s("design:paramtypes",[Object])],n)}(nt),vi=function(A){function n(v){void 0===v&&(v={});var E=A.call(this)||this;return E.position=v.position||zt.Vector3.Zero(),E.rotation=v.rotation||zt.Quaternion.Identity,E.scale=v.scale||new zt.Vector3(1,1,1),E}return i(n,A),Object.defineProperty(n.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),n.prototype.lookAt=function(v,A){void 0===A&&(A=zt.MathTmp.staticUp);var E=new zt.Matrix;return zt.Matrix.LookAtLHToRef(this.position,v,A,E),E.invert(),zt.Quaternion.FromRotationMatrixToRef(E,this.rotation),this},n.prototype.rotate=function(v,A){return this.rotation.multiplyInPlace(this.rotation.angleAxis(A,v)),this},n.prototype.translate=function(v){return this.position.addInPlace(v),this},r([nt.field,s("design:type",zt.Vector3)],n.prototype,"position",void 0),r([nt.field,s("design:type",zt.Quaternion)],n.prototype,"rotation",void 0),r([nt.field,s("design:type",zt.Vector3)],n.prototype,"scale",void 0),r([P("engine.transform",v.CLASS_ID.TRANSFORM),s("design:paramtypes",[Object])],n)}(nt);v.AttachToAvatarAnchorPointId=void 0,(yi=v.AttachToAvatarAnchorPointId||(v.AttachToAvatarAnchorPointId={}))[yi.Position=0]="Position",yi[yi.NameTag=1]="NameTag",yi[yi.LeftHand=2]="LeftHand",yi[yi.RightHand=3]="RightHand";var wi,Ti=function(A){function n(E){void 0===E&&(E={});var R=A.call(this)||this;return R.avatarId=E.avatarId||"",R.anchorPointId=E.anchorPointId||v.AttachToAvatarAnchorPointId.Position,R}return i(n,A),r([nt.field,s("design:type",String)],n.prototype,"avatarId",void 0),r([nt.field,s("design:type",Number)],n.prototype,"anchorPointId",void 0),r([nt.field,s("design:type",String)],n.prototype,"avatarSceneId",void 0),r([P("engine.transform",v.CLASS_ID.AVATAR_ATTACH),s("design:paramtypes",[Object])],n)}(nt),xi=function(A){function n(v,E,R){void 0===v&&(v=!0),void 0===E&&(E=!0),void 0===R&&(R=!0);var O=A.call(this)||this;return O.x=!0,O.y=!0,O.z=!0,O.x=v,O.y=E,O.z=R,O}return i(n,A),r([nt.field,s("design:type",Boolean)],n.prototype,"x",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"y",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"z",void 0),r([P("engine.billboard",v.CLASS_ID.BILLBOARD),s("design:paramtypes",[Boolean,Boolean,Boolean])],n)}(nt),Si=function(v){function e(){var A=null!==v&&v.apply(this,arguments)||this;return A.withCollisions=!0,A.isPointerBlocker=!0,A.visible=!0,A}return i(e,v),r([nt.field,s("design:type",Boolean)],e.prototype,"withCollisions",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"visible",void 0),e}(nt),Ci=function(A){function n(){return null!==A&&A.apply(this,arguments)||this}return i(n,A),r([nt.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.BOX_SHAPE)],n)}(Si),Ai=function(A){function n(){return null!==A&&A.apply(this,arguments)||this}return i(n,A),r([N("engine.shape",v.CLASS_ID.SPHERE_SHAPE)],n)}(Si),_i=function(A){function n(){return null!==A&&A.apply(this,arguments)||this}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"segments",void 0),r([nt.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CIRCLE_SHAPE)],n)}(Si),Ei=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.width=1,v.height=1,v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"width",void 0),r([nt.field,s("design:type",Number)],n.prototype,"height",void 0),r([nt.field,s("design:type",Array)],n.prototype,"uvs",void 0),r([N("engine.shape",v.CLASS_ID.PLANE_SHAPE)],n)}(Si),Ii=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.radiusTop=0,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([nt.field,s("design:type",Object)],n.prototype,"radius",void 0),r([nt.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CONE_SHAPE)],n)}(Si),Pi=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.radiusTop=1,v.radiusBottom=1,v.segmentsHeight=1,v.segmentsRadial=36,v.openEnded=!1,v.radius=null,v.arc=360,v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"radiusTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"radiusBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"segmentsHeight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"segmentsRadial",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"openEnded",void 0),r([nt.field,s("design:type",Object)],n.prototype,"radius",void 0),r([nt.field,s("design:type",Number)],n.prototype,"arc",void 0),r([N("engine.shape",v.CLASS_ID.CYLINDER_SHAPE)],n)}(Si),Oi=function(A){function n(v){var E=A.call(this)||this;return E.src=v,E}return i(n,A),r([Si.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.GLTF_SHAPE),s("design:paramtypes",[String])],n)}(Si);v.PictureFrameStyle=void 0,(wi=v.PictureFrameStyle||(v.PictureFrameStyle={}))[wi.Classic=0]="Classic",wi[wi.Baroque_Ornament=1]="Baroque_Ornament",wi[wi.Diamond_Ornament=2]="Diamond_Ornament",wi[wi.Minimal_Wide=3]="Minimal_Wide",wi[wi.Minimal_Grey=4]="Minimal_Grey",wi[wi.Blocky=5]="Blocky",wi[wi.Gold_Edges=6]="Gold_Edges",wi[wi.Gold_Carved=7]="Gold_Carved",wi[wi.Gold_Wide=8]="Gold_Wide",wi[wi.Gold_Rounded=9]="Gold_Rounded",wi[wi.Metal_Medium=10]="Metal_Medium",wi[wi.Metal_Wide=11]="Metal_Wide",wi[wi.Metal_Slim=12]="Metal_Slim",wi[wi.Metal_Rounded=13]="Metal_Rounded",wi[wi.Pins=14]="Pins",wi[wi.Minimal_Black=15]="Minimal_Black",wi[wi.Minimal_White=16]="Minimal_White",wi[wi.Tape=17]="Tape",wi[wi.Wood_Slim=18]="Wood_Slim",wi[wi.Wood_Wide=19]="Wood_Wide",wi[wi.Wood_Twigs=20]="Wood_Twigs",wi[wi.Canvas=21]="Canvas",wi[wi.None=22]="None";var Di,ki=function(A){function n(E,R){void 0===R&&(R={});var O=A.call(this)||this;O.src=E;var M=new zt.Color3(.6404918,.611472,.8584906),V=v.PictureFrameStyle.Classic;return"r"in R?M=R:null!==R&&(R.color&&(M=R.color),R.style&&(V=R.style)),O.color=M,O.style=V,O}return i(n,A),r([Si.readonly,s("design:type",String)],n.prototype,"src",void 0),r([Si.readonly,s("design:type",Number)],n.prototype,"style",void 0),r([nt.field,s("design:type",zt.Color3)],n.prototype,"color",void 0),r([N("engine.shape",v.CLASS_ID.NFT_SHAPE),s("design:paramtypes",[String,Object])],n)}(Si),Li=function(A){function n(v,E){var R=A.call(this)||this,O=new RegExp("data:[a-z-]+/[a-z-]+;base64");if((v.length>2048||O.test(v))&&u("⚠️🚨 Base64 textures will be deprecated in version 7 of decentraland-ecs"),R.src=v,E)for(var M in E)R[M]=E[M];return R}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"src",void 0),r([nt.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([nt.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([nt.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.TEXTURE),s("design:paramtypes",[String,Object])],n)}(nt),Ni=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.states=[],v}return i(n,A),n.prototype.addClip=function(v){var A=this;return this.states.push(v),v.onChange((function(){A.dirty=!0})),v.owner=this,this},n.prototype.getClip=function(v){for(var A=0;A<this.states.length;A++){var E=this.states[A];if(E.clip===v)return E}var R=new ui(v);return this.addClip(R),R},n.prototype.stop=function(v){if(v)v.playing=!1,v.shouldReset=!0;else for(var A=0;A<this.states.length;A++){var E=this.states[A];this.stop(E)}},n.prototype.play=function(v,A){void 0===A&&(A=!1);for(var E=0;E<this.states.length;E++){var R=this.states[E];R.layer===v.layer&&v!==R&&this.pause(R)}A&&(v.shouldReset=!0),v.playing=!0,v.dirty=!0,v.data.nonce=Math.random()},n.prototype.pause=function(v){if(v)v.playing=!1;else for(var A=0;A<this.states.length;A++){var E=this.states[A];this.pause(E)}},r([nt.readonly,s("design:type",Array)],n.prototype,"states",void 0),r([P("engine.animator",v.CLASS_ID.ANIMATION)],n)}(Si),Mi=function(A){function n(v){var E=A.call(this)||this;return E.src=v,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.shape",v.CLASS_ID.OBJ_SHAPE),s("design:paramtypes",[String])],n)}(Si),zi=function(A){function n(v){void 0===v&&(v="");var E=A.call(this)||this;return E.src=v,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"src",void 0),r([N("engine.font",v.CLASS_ID.FONT),s("design:paramtypes",[String])],n)}(nt);v.Fonts=void 0,(Di=v.Fonts||(v.Fonts={})).SanFrancisco="builtin:SF-UI-Text-Regular SDF",Di.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",Di.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",Di.LiberationSans="builtin:LiberationSans SDF",Di.SansSerif="SansSerif",Di.SansSerif_Heavy="SansSerif_Heavy",Di.SansSerif_Bold="SansSerif_Bold",Di.SansSerif_SemiBold="SansSerif_SemiBold";var Bi,Fi=function(A){function n(v){var E=A.call(this)||this;return E.outlineWidth=0,E.outlineColor=new zt.Color3(1,1,1),E.color=new zt.Color3(1,1,1),E.fontSize=10,E.opacity=1,E.value="",E.lineSpacing="0px",E.lineCount=0,E.textWrapping=!1,E.shadowBlur=0,E.shadowOffsetX=0,E.shadowOffsetY=0,E.shadowColor=new zt.Color3(1,1,1),E.hTextAlign="center",E.vTextAlign="center",E.width=1,E.height=1,E.paddingTop=0,E.paddingRight=0,E.paddingBottom=0,E.paddingLeft=0,E.billboard=!1,E.visible=!0,v&&(E.value=v),E}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([nt.field,s("design:type",zt.Color3)],n.prototype,"outlineColor",void 0),r([nt.field,s("design:type",zt.Color3)],n.prototype,"color",void 0),r([nt.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([nt.component,s("design:type",zi)],n.prototype,"font",void 0),r([nt.field,s("design:type",Number)],n.prototype,"opacity",void 0),r([nt.field,s("design:type",String)],n.prototype,"value",void 0),r([nt.field,s("design:type",String)],n.prototype,"lineSpacing",void 0),r([nt.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([nt.field,s("design:type",zt.Color3)],n.prototype,"shadowColor",void 0),r([nt.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([nt.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([nt.field,s("design:type",Number)],n.prototype,"width",void 0),r([nt.field,s("design:type",Number)],n.prototype,"height",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"billboard",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"visible",void 0),r([P("engine.text",v.CLASS_ID.TEXT_SHAPE),s("design:paramtypes",[String])],n)}(nt);v.TransparencyMode=void 0,(Bi=v.TransparencyMode||(v.TransparencyMode={}))[Bi.OPAQUE=0]="OPAQUE",Bi[Bi.ALPHA_TEST=1]="ALPHA_TEST",Bi[Bi.ALPHA_BLEND=2]="ALPHA_BLEND",Bi[Bi.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",Bi[Bi.AUTO=4]="AUTO";var Vi,Ui=function(A){function n(){var E=null!==A&&A.apply(this,arguments)||this;return E.alphaTest=.5,E.castShadows=!0,E.transparencyMode=v.TransparencyMode.AUTO,E}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([nt.field,s("design:type",Object)],n.prototype,"albedoColor",void 0),r([nt.field,s("design:type",zt.Color3)],n.prototype,"emissiveColor",void 0),r([nt.field,s("design:type",Number)],n.prototype,"metallic",void 0),r([nt.field,s("design:type",Number)],n.prototype,"roughness",void 0),r([nt.field,s("design:type",zt.Color3)],n.prototype,"reflectivityColor",void 0),r([nt.field,s("design:type",Number)],n.prototype,"directIntensity",void 0),r([nt.field,s("design:type",Number)],n.prototype,"microSurface",void 0),r([nt.field,s("design:type",Number)],n.prototype,"emissiveIntensity",void 0),r([nt.field,s("design:type",Number)],n.prototype,"specularIntensity",void 0),r([nt.component,s("design:type",Object)],n.prototype,"albedoTexture",void 0),r([nt.component,s("design:type",Object)],n.prototype,"alphaTexture",void 0),r([nt.component,s("design:type",Object)],n.prototype,"emissiveTexture",void 0),r([nt.component,s("design:type",Object)],n.prototype,"bumpTexture",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([nt.field,s("design:type",Number)],n.prototype,"transparencyMode",void 0),r([N("engine.material",v.CLASS_ID.PBR_MATERIAL)],n)}(nt),Wi=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.alphaTest=.5,v.castShadows=!0,v}return i(n,A),r([nt.component,s("design:type",Object)],n.prototype,"texture",void 0),r([nt.field,s("design:type",Number)],n.prototype,"alphaTest",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"castShadows",void 0),r([N("engine.material",v.CLASS_ID.BASIC_MATERIAL)],n)}(nt),Hi=function(v){function e(A){var E=v.call(this)||this;if(E.uuid=f("UUID"),!A||!("apply"in A)||!("call"in A))throw new Error("Callback is not a function");return E.callback=A,E}return i(e,v),e.uuidEvent=function(v,A){if(delete v[A]){var E=A+"_"+Math.random();v[E]=void 0,Object.defineProperty(v,E,o(o({},Object.getOwnPropertyDescriptor(v,E)),{enumerable:!1})),Object.defineProperty(v,A.toString(),{get:function(){return this[E]},set:function(v){var R=this[E];if(v){if(!(v instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[A]=v.uuid}else this.data[A]=null;if(this[E]=v,v!==R){this.dirty=!0;for(var O=0;O<this.subscriptions.length;O++)this.subscriptions[O](A,v,R)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},r([nt.field,s("design:type",Function)],e.prototype,"callback",void 0),e}(nt),Xi=function(A){function n(){var E=null!==A&&A.apply(this,arguments)||this;return E.button=v.ActionButton.ANY,E.hoverText="Interact",E.distance=10,E.showFeedback=!0,E}return i(n,A),n.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},r([nt.field,s("design:type",String)],n.prototype,"button",void 0),r([nt.field,s("design:type",String)],n.prototype,"hoverText",void 0),r([nt.field,s("design:type",Number)],n.prototype,"distance",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"showFeedback",void 0),n}(Hi),Gi=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.type="onPointerLock",v}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onPointerLock",v.CLASS_ID.UUID_CALLBACK)],n)}(Hi),Yi=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.type="onAnimationEnd",v}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onAnimationEnd",v.CLASS_ID.UUID_CALLBACK)],n)}(Hi),ji=function(A){function n(){return null!==A&&A.apply(this,arguments)||this}return i(n,A),r([P("engine.smartItem",v.CLASS_ID.SMART_ITEM)],n)}(nt),qi=function(A){function n(v){var E=A.call(this)||this;return E.url=v,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"url",void 0),r([N("engine.VideoClip",v.CLASS_ID.VIDEO_CLIP),s("design:paramtypes",[String])],n)}(nt);v.VideoStatus=void 0,(Vi=v.VideoStatus||(v.VideoStatus={}))[Vi.NONE=0]="NONE",Vi[Vi.ERROR=1]="ERROR",Vi[Vi.LOADING=2]="LOADING",Vi[Vi.READY=3]="READY",Vi[Vi.PLAYING=4]="PLAYING",Vi[Vi.BUFFERING=5]="BUFFERING";var Qi,Zi=function(A){function n(E,R){var O=A.call(this)||this;if(O.volume=1,O.playbackRate=1,O.loop=!1,O.seek=-1,O._position=-1,O._videoLength=-1,O._status=v.VideoStatus.NONE,O.playing=!1,!(E instanceof qi))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(O.videoClipId=D(E),R)for(var M in R)O[M]=R[M];return O}return i(n,A),n.prototype.play=function(){this.playing=!0},n.prototype.pause=function(){this.playing=!1},n.prototype.reset=function(){this.seekTime(0),this.pause()},n.prototype.seekTime=function(v){this.seek=v,this.dirty=!0,this.data.nonce=Math.random()},n.prototype.toJSON=function(){if(this.seek>=0){var v=JSON.parse(JSON.stringify(A.prototype.toJSON.call(this)));return this.seek=-1,v}return A.prototype.toJSON.call(this)},n.prototype.update=function(A){A.videoClipId===this.videoClipId&&(this._status=A.videoStatus||v.VideoStatus.NONE,this._videoLength=A.totalVideoLength,this._position=A.currentOffset)},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"videoLength",{get:function(){return this._videoLength},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),r([nt.readonly,s("design:type",String)],n.prototype,"videoClipId",void 0),r([nt.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([nt.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([nt.field,s("design:type",Number)],n.prototype,"volume",void 0),r([nt.field,s("design:type",Number)],n.prototype,"playbackRate",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"seek",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([N("engine.VideoTexture",v.CLASS_ID.VIDEO_TEXTURE),s("design:paramtypes",[qi,Object])],n)}(nt),Ki=function(A){function n(v){var E=A.call(this)||this;return E.area=v.area,E.cameraMode=v.cameraMode,E}return i(n,A),r([nt.field,s("design:type",Object)],n.prototype,"area",void 0),r([nt.field,s("design:type",Number)],n.prototype,"cameraMode",void 0),r([P("engine.cameraModeArea",v.CLASS_ID.CAMERA_MODE_AREA),s("design:paramtypes",[Object])],n)}(nt),$i=function(A){function n(v,E){var R=A.call(this)||this;if(R.userId=v,E)for(var O in E)R[O]=E[O];return R}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"userId",void 0),r([nt.readonly,s("design:type",Number)],n.prototype,"samplingMode",void 0),r([nt.readonly,s("design:type",Number)],n.prototype,"wrap",void 0),r([nt.readonly,s("design:type",Boolean)],n.prototype,"hasAlpha",void 0),r([N("engine.texture",v.CLASS_ID.AVATAR_TEXTURE),s("design:paramtypes",[String,Object])],n)}(nt),Ji=function(){function e(){var A=this;this.position=new zt.Vector3,this.rotation=new zt.Quaternion,this.feetPosition=new zt.Vector3,this.worldPosition=new zt.Vector3,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=v.CameraMode.ThirdPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(v){switch(v.type){case"positionChanged":A.positionChanged(v.data);break;case"rotationChanged":A.rotationChanged(v.data);break;case"cameraModeChanged":A.cameraModeChanged(v.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return A.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return A.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return A.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return A.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return A.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return A.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return A.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return A.lastEventPosition.y-A.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return A.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return A.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return A.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return A.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return A.lastEventRotation.w}})}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),e.prototype.positionChanged=function(v){this.lastEventPosition=v.position,this.lastEventWorldPosition=v.cameraPosition,this._playerHeight=v.playerHeight},e.prototype.rotationChanged=function(v){this.lastEventRotation=v.quaternion},e.prototype.cameraModeChanged=function(v){this._cameraMode=v.cameraMode},e}();!function(v){v.HitFirst="rqhf",v.HitAll="rqha"}(Qi||(Qi={}));var tn,nn=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(v){var A=Ji.instance.rotation,E=zt.Matrix.Identity();A.toRotationMatrix(E);var R=zt.Vector3.TransformCoordinates(zt.Vector3.Forward(),E);return{origin:Ji.instance.position,direction:R,distance:v}},t.prototype.getRayFromPositions=function(v,A){var E=A.subtract(v),R=E.length();return{origin:v,direction:E.normalize(),distance:R}},t.prototype.hitFirst=function(v,A,E){var R="number"==typeof E?Qi.HitFirst+E:m();this.queries[R]=A,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:R,queryType:"HitFirst",ray:v})},t.prototype.hitAll=function(v,A,E){var R="number"==typeof E?Qi.HitAll+E:m();this.queries[R]=A,"undefined"!=typeof dcl&&dcl.query("raycast",{queryId:R,queryType:"HitAll",ray:v})},t.prototype.hitFirstAvatar=function(v,A){u("not implemented yet")},t.prototype.hitAllAvatars=function(v,A){u("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(v){this.queries[v.payload.queryId](v.payload.payload),delete this.queries[v.payload.queryId]},t}(),on=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(gt,this,(function(v){"HitFirst"===v.payload.queryType?nn.instance.handleRaycastHitFirstResponse(v):"HitAll"===v.payload.queryType&&nn.instance.handleRaycastHitAllResponse(v)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}(),rn=function(){function t(){}return t.prototype.activate=function(v){v.eventManager.addListener(ft,this,(function(v){mi.instance.handlePointerEvent(v.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("actionButtonEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("actionButtonEvent"))},t}(),sn=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(v){v.eventManager.addListener(dt,this,this.handleEvent),v.eventManager.addListener(W,this,this.componentAdded),v.eventManager.addListener(V,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(v){for(var A in v.components){var E=v.components[A];E instanceof Hi&&(this.handlerMap[E.uuid]=E)}},t.prototype.onRemoveEntity=function(v){for(var A in v.components){var E=v.components[A];E instanceof Hi&&delete this.handlerMap[E.uuid]}},t.prototype.componentAdded=function(v){if(v.entity.isAddedToEngine()){var A=v.entity.components[v.componentName];A instanceof Hi&&(this.handlerMap[A.uuid]=A)}},t.prototype.componentRemoved=function(v){v.entity.isAddedToEngine()&&v.component instanceof Hi&&delete this.handlerMap[v.component.uuid]},t.prototype.handleEvent=function(v){if(v.uuid in this.handlerMap){var A=this.handlerMap[v.uuid];A&&A.callback&&"call"in A.callback&&A.callback(v.payload)}},t}(),an=new on,hn=new rn,cn=new sn,ln=function(A){function n(v){var E=A.call(this)||this;return E.loop=!1,E.volume=1,E.url=v,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"url",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([nt.field,s("design:type",String)],n.prototype,"loadingCompleteEventId",void 0),r([nt.field,s("design:type",Number)],n.prototype,"volume",void 0),r([N("engine.AudioClip",v.CLASS_ID.AUDIO_CLIP),s("design:paramtypes",[String])],n)}(nt),un=function(A){function n(v){var E=A.call(this)||this;if(E.audioClip=v,E.loop=!1,E.volume=1,E.playing=!1,E.pitch=1,E.playedAtTimestamp=Date.now(),!(v instanceof ln))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return E.audioClipId=D(v),E}return i(n,A),n.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},r([nt.readonly,s("design:type",String)],n.prototype,"audioClipId",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"loop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"volume",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([nt.field,s("design:type",Number)],n.prototype,"pitch",void 0),r([nt.field,s("design:type",Number)],n.prototype,"playedAtTimestamp",void 0),r([P("engine.AudioSource",v.CLASS_ID.AUDIO_SOURCE),s("design:paramtypes",[ln])],n)}(nt),pn=function(A){function n(v){var E=A.call(this)||this;return E.playing=!1,E.volume=1,E.url=v,E.playing=!0,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"url",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"playing",void 0),r([nt.field,s("design:type",Number)],n.prototype,"volume",void 0),r([P("engine.AudioStream",v.CLASS_ID.AUDIO_STREAM),s("design:paramtypes",[String])],n)}(nt);v.Gizmo=void 0,(tn=v.Gizmo||(v.Gizmo={})).MOVE="MOVE",tn.ROTATE="ROTATE",tn.SCALE="SCALE",tn.NONE="NONE";var dn,gn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.type="gizmoEvent",v}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.gizmoEvent",v.CLASS_ID.UUID_CALLBACK)],n)}(Hi),fn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.position=!0,v.rotation=!0,v.scale=!0,v.cycle=!0,v.localReference=!1,v}return i(n,A),r([nt.field,s("design:type",Boolean)],n.prototype,"position",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"rotation",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"scale",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"cycle",void 0),r([nt.field,s("design:type",String)],n.prototype,"selectedGizmo",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"localReference",void 0),r([P("engine.gizmos",v.CLASS_ID.GIZMOS)],n)}(nt),mn=function(A){function n(v){var E=A.call(this,v)||this;return E.type="onFocus",cn.handlerMap[E.uuid]=E,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onFocus",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Hi),yn=function(A){function n(v){var E=A.call(this,v)||this;return E.type="onTextSubmit",cn.handlerMap[E.uuid]=E,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onTextSubmit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Hi),bn=function(A){function n(v){var E=A.call(this,v)||this;return E.type="onBlur",cn.handlerMap[E.uuid]=E,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onBlur",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Hi),vn=function(A){function n(v){var E=A.call(this,v)||this;return E.type="onEnter",cn.handlerMap[E.uuid]=E,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Hi),wn=function(A){function n(v){var E=A.call(this,v)||this;return E.type="onChange",cn.handlerMap[E.uuid]=E,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onChange",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Hi),Tn=function(A){function n(v,E){var R=A.call(this,v)||this;return R.type="onClick",cn.handlerMap[R.uuid]=R,E&&(R.showFeedback=!(!1===E.showFeedback),E.button&&(R.button=E.button),E.hoverText&&(R.hoverText=E.hoverText),E.distance&&(R.distance=E.distance)),R}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.onClick",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Xi),xn=function(A){function n(v,E){var R=A.call(this,v)||this;return R.type="pointerDown",cn.handlerMap[R.uuid]=R,E&&(R.showFeedback=!(!1===E.showFeedback),E.button&&(R.button=E.button),E.hoverText&&(R.hoverText=E.hoverText),E.distance&&(R.distance=E.distance)),R}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerDown",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Xi),Sn=function(A){function n(v,E){var R=A.call(this,v)||this;return R.type="pointerUp",cn.handlerMap[R.uuid]=R,E&&(R.showFeedback=!(!1===E.showFeedback),E.button&&(R.button=E.button),E.hoverText&&(R.hoverText=E.hoverText),E.distance&&(R.distance=E.distance)),R}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerUp",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Xi),Cn=function(A){function n(v,E){var R=A.call(this,v)||this;return R.type="pointerHoverEnter",cn.handlerMap[R.uuid]=R,E&&E.distance&&(R.distance=E.distance),R}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverEnter",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function,Object])],n)}(Xi),An=function(A){function n(v){var E=A.call(this,v)||this;return E.type="pointerHoverExit",cn.handlerMap[E.uuid]=E,E.distance=160,E}return i(n,A),r([nt.readonly,s("design:type",String)],n.prototype,"type",void 0),r([P("engine.pointerHoverExit",v.CLASS_ID.UUID_CALLBACK),s("design:paramtypes",[Function])],n)}(Xi),_n=function(v){function e(A){var E=v.call(this)||this;return E.name=null,E.visible=!0,E.opacity=1,E.hAlign="center",E.vAlign="center",E.width="100px",E.height="50px",E.positionX="0px",E.positionY="0px",E.isPointerBlocker=!0,A&&(E._parent=A,E.data.parentComponent=D(A)),E}return i(e,v),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),r([nt.field,s("design:type",Object)],e.prototype,"name",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"visible",void 0),r([nt.field,s("design:type",Number)],e.prototype,"opacity",void 0),r([nt.field,s("design:type",String)],e.prototype,"hAlign",void 0),r([nt.field,s("design:type",String)],e.prototype,"vAlign",void 0),r([nt.uiValue,s("design:type",Object)],e.prototype,"width",void 0),r([nt.uiValue,s("design:type",Object)],e.prototype,"height",void 0),r([nt.uiValue,s("design:type",Object)],e.prototype,"positionX",void 0),r([nt.uiValue,s("design:type",Object)],e.prototype,"positionY",void 0),r([nt.field,s("design:type",Boolean)],e.prototype,"isPointerBlocker",void 0),e}(nt),En=function(A){function n(){return A.call(this,null)||this}return i(n,A),r([N("engine.shape",v.CLASS_ID.UI_FULLSCREEN_SHAPE),s("design:paramtypes",[])],n)}(_n),In=function(A){function n(){return A.call(this,null)||this}return i(n,A),r([N("engine.shape",v.CLASS_ID.UI_WORLD_SPACE_SHAPE),s("design:paramtypes",[])],n)}(_n),Pn=function(A){function n(){return A.call(this,null)||this}return i(n,A),r([N("engine.shape",v.CLASS_ID.UI_SCREEN_SPACE_SHAPE),s("design:paramtypes",[])],n)}(_n),Rn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.thickness=0,v.color=zt.Color4.Clear(),v.alignmentUsesSize=!0,v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"color",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"alignmentUsesSize",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_RECT)],n)}(_n);v.UIStackOrientation=void 0,(dn=v.UIStackOrientation||(v.UIStackOrientation={}))[dn.VERTICAL=0]="VERTICAL",dn[dn.HORIZONTAL=1]="HORIZONTAL";var On=function(A){function n(){var E=null!==A&&A.apply(this,arguments)||this;return E.adaptWidth=!0,E.adaptHeight=!0,E.color=zt.Color4.Clear(),E.stackOrientation=v.UIStackOrientation.VERTICAL,E.spacing=0,E}return i(n,A),r([nt.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"color",void 0),r([nt.field,s("design:type",Number)],n.prototype,"stackOrientation",void 0),r([nt.field,s("design:type",Number)],n.prototype,"spacing",void 0),r([N("engine.shape",v.CLASS_ID.UI_CONTAINER_STACK)],n)}(_n),Dn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.fontSize=10,v.fontWeight="normal",v.thickness=0,v.cornerRadius=0,v.color=zt.Color4.White(),v.background=zt.Color4.White(),v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=zt.Color4.Black(),v.text="button",v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([nt.field,s("design:type",String)],n.prototype,"fontWeight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"thickness",void 0),r([nt.field,s("design:type",Number)],n.prototype,"cornerRadius",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"color",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"background",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"shadowColor",void 0),r([nt.field,s("design:type",String)],n.prototype,"text",void 0),r([N("engine.shape",v.CLASS_ID.UI_BUTTON_SHAPE)],n)}(_n),kn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.outlineWidth=0,v.outlineColor=zt.Color4.White(),v.color=zt.Color4.White(),v.fontSize=10,v.fontAutoSize=!1,v.value="",v.lineSpacing=0,v.lineCount=0,v.adaptWidth=!1,v.adaptHeight=!1,v.textWrapping=!1,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=zt.Color4.Black(),v.hTextAlign="left",v.vTextAlign="bottom",v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"outlineColor",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"color",void 0),r([nt.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"fontAutoSize",void 0),r([nt.component,s("design:type",zi)],n.prototype,"font",void 0),r([nt.field,s("design:type",String)],n.prototype,"value",void 0),r([nt.field,s("design:type",Number)],n.prototype,"lineSpacing",void 0),r([nt.field,s("design:type",Number)],n.prototype,"lineCount",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"adaptWidth",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"adaptHeight",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"shadowColor",void 0),r([nt.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([nt.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([N("engine.shape",v.CLASS_ID.UI_TEXT_SHAPE)],n)}(_n),Ln=function(A){function n(v){var E=A.call(this,v)||this;return E.outlineWidth=0,E.outlineColor=zt.Color4.Black(),E.color=zt.Color4.Clear(),E.fontSize=10,E.value="",E.placeholder="",E.margin=10,E.hTextAlign="left",E.vTextAlign="bottom",E.focusedBackground=zt.Color4.Black(),E.textWrapping=!1,E.shadowBlur=0,E.shadowOffsetX=0,E.shadowOffsetY=0,E.shadowColor=zt.Color4.White(),E.paddingTop=0,E.paddingRight=0,E.paddingBottom=0,E.paddingLeft=0,E.onTextSubmit=null,E.onChanged=null,E.onFocus=null,E.onBlur=null,E.onTextChanged=new wn((function(v){var A=v.value,R=A.value,O=A.isSubmit,M=E.dirty;if(E.value=R,E.dirty=M,O&&E.onTextSubmit){var V={text:R};E.onTextSubmit.callback(V)}else if(!O&&E.onChanged){var W={value:R,pointerId:v.pointerId};E.onChanged.callback(W)}})),E}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"outlineWidth",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"outlineColor",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"color",void 0),r([nt.field,s("design:type",Number)],n.prototype,"fontSize",void 0),r([nt.component,s("design:type",zi)],n.prototype,"font",void 0),r([nt.field,s("design:type",String)],n.prototype,"value",void 0),r([nt.field,s("design:type",String)],n.prototype,"placeholder",void 0),r([nt.field,s("design:type",Number)],n.prototype,"margin",void 0),r([nt.field,s("design:type",String)],n.prototype,"hTextAlign",void 0),r([nt.field,s("design:type",String)],n.prototype,"vTextAlign",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"focusedBackground",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"textWrapping",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowBlur",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetX",void 0),r([nt.field,s("design:type",Number)],n.prototype,"shadowOffsetY",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"shadowColor",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Hi.uuidEvent,s("design:type",wn)],n.prototype,"onTextChanged",void 0),r([Hi.uuidEvent,s("design:type",Object)],n.prototype,"onFocus",void 0),r([Hi.uuidEvent,s("design:type",Object)],n.prototype,"onBlur",void 0),r([N("engine.shape",v.CLASS_ID.UI_INPUT_TEXT_SHAPE),s("design:paramtypes",[Object])],n)}(_n),Nn=function(A){function n(v,E){var R=A.call(this,v)||this;return R.sourceLeft=0,R.sourceTop=0,R.sourceWidth=1,R.sourceHeight=1,R.paddingTop=0,R.paddingRight=0,R.paddingBottom=0,R.paddingLeft=0,R.sizeInPixels=!0,R.onClick=null,R.source=E,R}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"sourceLeft",void 0),r([nt.field,s("design:type",Number)],n.prototype,"sourceTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"sourceWidth",void 0),r([nt.field,s("design:type",Number)],n.prototype,"sourceHeight",void 0),r([nt.component,s("design:type",Object)],n.prototype,"source",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"sizeInPixels",void 0),r([Hi.uuidEvent,s("design:type",Object)],n.prototype,"onClick",void 0),r([N("engine.shape",v.CLASS_ID.UI_IMAGE_SHAPE),s("design:paramtypes",[_n,Object])],n)}(_n),Mn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.valueX=0,v.valueY=0,v.backgroundColor=zt.Color4.Clear(),v.isHorizontal=!1,v.isVertical=!1,v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.onChanged=null,v}return i(n,A),r([nt.field,s("design:type",Number)],n.prototype,"valueX",void 0),r([nt.field,s("design:type",Number)],n.prototype,"valueY",void 0),r([nt.field,s("design:type",zt.Color4)],n.prototype,"backgroundColor",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"isHorizontal",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"isVertical",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingTop",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingRight",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingBottom",void 0),r([nt.field,s("design:type",Number)],n.prototype,"paddingLeft",void 0),r([Hi.uuidEvent,s("design:type",Object)],n.prototype,"onChanged",void 0),r([N("engine.shape",v.CLASS_ID.UI_SLIDER_SHAPE)],n)}(_n),zn=function(A){function n(){var v=null!==A&&A.apply(this,arguments)||this;return v.useDummyModel=!1,v.talking=!1,v}var E;return i(n,A),E=n,n.Dummy=function(){var v=new E;return v.useDummyModel=!0,v},r([nt.field,s("design:type",String)],n.prototype,"id",void 0),r([nt.field,s("design:type",String)],n.prototype,"name",void 0),r([nt.field,s("design:type",String)],n.prototype,"expressionTriggerId",void 0),r([nt.field,s("design:type",Number)],n.prototype,"expressionTriggerTimestamp",void 0),r([nt.field,s("design:type",String)],n.prototype,"bodyShape",void 0),r([nt.field,s("design:type",Array)],n.prototype,"wearables",void 0),r([nt.field,s("design:type",Array)],n.prototype,"emotes",void 0),r([nt.field,s("design:type",Object)],n.prototype,"skinColor",void 0),r([nt.field,s("design:type",Object)],n.prototype,"hairColor",void 0),r([nt.field,s("design:type",Object)],n.prototype,"eyeColor",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"useDummyModel",void 0),r([nt.field,s("design:type",Boolean)],n.prototype,"talking",void 0),E=r([P("engine.avatarShape",v.CLASS_ID.AVATAR_SHAPE)],n)}(nt),Bn=null,Fn=null,Vn=null;function Ri(){return Vn||(Vn=new pt),Vn}var Un=function(){function t(){var v=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!Fn){(Fn=dcl.loadModule("@decentraland/CommunicationsController",{})).then((function(v){Bn=v}));var v=Ri();dcl.subscribe("comms"),dcl.onEvent((function(A){"comms"===A.type&&v.notifyObservers(A.data)}))}return Fn}().then((function(){v.connected=!0,v.flush()}))}return t.prototype.on=function(v,A){return Ri().add((function(E){try{var R=JSON.parse(E.message);R.message===v&&A(R.payload,E.sender)}catch(E){dcl.error("Error parsing comms message "+(E.message||""),E)}}))},t.prototype.sendRaw=function(v){this.messageQueue.push(v),this.connected&&this.flush()},t.prototype.emit=function(v,A){var E=JSON.stringify({message:v,payload:A});this.sendRaw(E),Ri().notifyObservers({message:E,sender:"self"})},t.prototype.flush=function(){var v=this;if(0!==this.messageQueue.length&&this.connected&&Bn&&!this.flushing){var A=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(Bn.rpcHandle,"send",[A]).then((function(A){v.flushing=!1,v.flush()}),(function(A){v.flushing=!1,y("Error flushing MessageBus",A)}))}},t}(),Wn=new rt("scene");Wn.uuid="0";var Hn=new st(Wn);N.engine=Hn,"undefined"!=typeof dcl&&(Hn.addSystem(new Lt(dcl),1/0),mt(dcl)),Hn.addSystem(cn),Hn.addSystem(hn),Hn.addSystem(an),v.AVATAR_OBSERVABLE="AVATAR_OBSERVABLE",v.Angle=zt.Angle,v.AnimationState=ui,v.Animator=Ni,v.Arc2=zt.Arc2,v.AttachToAvatar=Ti,v.Attachable=A,v.AudioClip=ln,v.AudioSource=un,v.AudioStream=pn,v.AvatarModifierArea=bi,v.AvatarShape=zn,v.AvatarTexture=$i,v.Axis=zt.Axis,v.BasicMaterial=Wi,v.BezierCurve=zt.BezierCurve,v.Billboard=xi,v.BoxShape=Ci,v.Camera=Ji,v.CameraModeArea=Ki,v.CircleShape=_i,v.Color3=zt.Color3,v.Color4=zt.Color4,v.Component=P,v.ComponentAdded=W,v.ComponentGroup=ot,v.ComponentRemoved=V,v.ConeShape=Ii,v.Curve3=zt.Curve3,v.CylinderShape=Pi,v.DEG2RAD=zt.DEG2RAD,v.DisposableComponent=N,v.DisposableComponentCreated=J,v.DisposableComponentRemoved=et,v.DisposableComponentUpdated=it,v.Engine=st,v.Entity=rt,v.Epsilon=zt.Epsilon,v.EventConstructor=x,v.EventManager=O,v.Font=zi,v.Frustum=zt.Frustum,v.GLTFShape=Oi,v.Gizmos=fn,v.GlobalPointerDown=gi,v.GlobalPointerUp=fi,v.Input=mi,v.Material=Ui,v.Matrix=zt.Matrix,v.MessageBus=Un,v.MultiObserver=ut,v.NFTShape=ki,v.OBJShape=Mi,v.Observable=pt,v.ObservableComponent=nt,v.Observer=Y,v.ObserverEventState=lt,v.OnAnimationEnd=Yi,v.OnBlur=bn,v.OnChanged=wn,v.OnClick=Tn,v.OnEnter=vn,v.OnFocus=mn,v.OnGizmoEvent=gn,v.OnPointerDown=xn,v.OnPointerHoverEnter=Cn,v.OnPointerHoverExit=An,v.OnPointerLock=Gi,v.OnPointerUUIDEvent=Xi,v.OnPointerUp=Sn,v.OnTextSubmit=yn,v.OnUUIDEvent=Hi,v.Orientation=zt.Orientation,v.ParentChanged=H,v.Path2=zt.Path2,v.Path3D=zt.Path3D,v.PhysicsCast=nn,v.Plane=zt.Plane,v.PlaneShape=Ei,v.PointerEvent=ft,v.PointerEventComponent=Ke,v.PointerEventSystem=rn,v.Quaternion=zt.Quaternion,v.RAD2DEG=zt.RAD2DEG,v.RaycastEventSystem=on,v.RaycastResponse=gt,v.Scalar=zt.Scalar,v.Shape=Si,v.Size=zt.Size,v.SmartItem=ji,v.Space=zt.Space,v.SphereShape=Ai,v.Subscription=en,v.TextShape=Fi,v.Texture=Li,v.ToGammaSpace=zt.ToGammaSpace,v.ToLinearSpace=zt.ToLinearSpace,v.Transform=vi,v.UIButton=Dn,v.UICanvas=Pn,v.UIContainerRect=Rn,v.UIContainerStack=On,v.UIFullScreen=En,v.UIImage=Nn,v.UIInputText=Ln,v.UIScrollRect=Mn,v.UIShape=_n,v.UIText=kn,v.UIValue=X,v.UIWorldSpace=In,v.UUIDEvent=dt,v.UUIDEventSystem=sn,v.Vector2=zt.Vector2,v.Vector3=zt.Vector3,v.Vector4=zt.Vector4,v.VideoClip=qi,v.VideoTexture=Zi,v._initEventObservables=mt,v.buildArray=function(v,A){for(var E=[],R=0;R<v;++R)E.push(A());return E},v.engine=Hn,v.error=y,v.executeTask=G,v.getComponentClassId=L,v.getComponentId=D,v.getComponentName=F,v.getMessageObserver=Ri,v.isDisposableComponent=U,v.log=u,v.newId=f,v.onCameraModeChangedObservable=yt,v.onEnterScene=wt,v.onEnterSceneObservable=vt,v.onIdleStateChangedObservable=bt,v.onLeaveScene=xt,v.onLeaveSceneObservable=Tt,v.onPlayerClickedObservable=kt,v.onPlayerConnectedObservable=Pt,v.onPlayerDisconnectedObservable=Rt,v.onPlayerExpressionObservable=Ct,v.onPointerLockedStateChange=At,v.onProfileChanged=It,v.onRealmChangedObservable=Ot,v.onSceneReadyObservable=St,v.onVideoEvent=_t,v.openExternalURL=function(v){"undefined"!=typeof dcl?dcl.openExternalUrl(v):y("ERROR: openExternalURL dcl is undefined")},v.openNFTDialog=function(v,A){if(void 0===A&&(A=null),"undefined"!=typeof dcl){var E=v.match(/ethereum:\/\/(.+)\/(.+)/);if(!E||E.length<3)return;dcl.openNFTDialog(E[1],E[2],A)}else y("ERROR: openNFTDialog dcl is undefined")},v.pointerEventSystem=hn,v.raycastEventSystem=an,v.teleportTo=function(v){var A;A=[v],void 0===ht&&"undefined"!=typeof dcl&&(ht=dcl.loadModule("@decentraland/UserActionModule",{})),void 0!==ht&&"undefined"!=typeof dcl&&ht.then((function(v){dcl.callRpc(v.rpcHandle,"requestTeleport",A)}))},v.uuid=m,v.uuidEventSystem=cn,Object.defineProperty(v,"__esModule",{value:!0})}(this.self=this.self||{}),define("@dcl/ecs-scene-utils",["exports","@decentraland/EnvironmentAPI"],(function(v,A){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var n=function(v,A){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,A){v.__proto__=A}||function(v,A){for(var E in A)Object.prototype.hasOwnProperty.call(A,E)&&(v[E]=A[E])})(v,A)};function i(v,A){function i(){this.constructor=v}n(v,A),v.prototype=null===A?Object.create(A):(i.prototype=A.prototype,new i)}function r(v,A,E,R){var O,M=arguments.length,V=M<3?A:null===R?R=Object.getOwnPropertyDescriptor(A,E):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)V=Reflect.decorate(v,A,E,R);else for(var W=v.length-1;W>=0;W--)(O=v[W])&&(V=(M<3?O(V):M>3?O(A,E,V):O(A,E))||V);return M>3&&V&&Object.defineProperty(A,E,V),V}function o(v,A,E,R){return new(E||(E=Promise))((function(O,M){function a(v){try{u(R.next(v))}catch(v){M(v)}}function s(v){try{u(R.throw(v))}catch(v){M(v)}}function u(v){var A;v.done?O(v.value):(A=v.value,A instanceof E?A:new E((function(v){v(A)}))).then(a,s)}u((R=R.apply(v,A||[])).next())}))}function a(v,A){var E,R,O,M,V={label:0,sent:function(){if(1&O[0])throw O[1];return O[1]},trys:[],ops:[]};return M={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function s(M){return function(W){return function(M){if(E)throw new TypeError("Generator is already executing.");for(;V;)try{if(E=1,R&&(O=2&M[0]?R.return:M[0]?R.throw||((O=R.return)&&O.call(R),0):R.next)&&!(O=O.call(R,M[1])).done)return O;switch(R=0,O&&(M=[2&M[0],O.value]),M[0]){case 0:case 1:O=M;break;case 4:return V.label++,{value:M[1],done:!1};case 5:V.label++,R=M[1],M=[0];continue;case 7:M=V.ops.pop(),V.trys.pop();continue;default:if(!((O=(O=V.trys).length>0&&O[O.length-1])||6!==M[0]&&2!==M[0])){V=0;continue}if(3===M[0]&&(!O||M[1]>O[0]&&M[1]<O[3])){V.label=M[1];break}if(6===M[0]&&V.label<O[1]){V.label=O[1],O=M;break}if(O&&V.label<O[2]){V.label=O[2],V.ops.push(M);break}O[2]&&V.ops.pop(),V.trys.pop();continue}M=A.call(v,V)}catch(v){M=[6,v],R=0}finally{E=O=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,W])}}}function s(v){var A="function"==typeof Symbol&&Symbol.iterator,E=A&&v[A],R=0;if(E)return E.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&R>=v.length&&(v=void 0),{value:v&&v[R++],done:!v}}};throw new TypeError(A?"Object is not iterable.":"Symbol.iterator is not defined.")}var E,R=function(){function e(){this._components=[],this._componentGroups=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var A,E;try{for(var R=s(this._components),O=R.next();!O.done;O=R.next())if(v==O.value)return}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(A)throw A.error}}this._components.push(v),this._componentGroups.push(engine.getComponentGroup(v,Transform))},e.prototype.update=function(v){for(var A=0;A<this._components.length;A++)this.updateComponent(v,this._components[A],this._componentGroups[A])},e.prototype.updateComponent=function(v,A,E){E.entities.forEach((function(E){var R=E.getComponent(Transform),O=E.getComponent(A);O.update(v),O.assignValueToTransform(R),O.hasFinished()&&(E.removeComponent(O),null!=O.onFinishCallback&&O.onFinishCallback())}))},e._instance=null,e}();function h(A,E){switch(A){case v.InterpolationType.LINEAR:return E;case v.InterpolationType.EASEINQUAD:return function(v){return v*v}(E);case v.InterpolationType.EASEOUTQUAD:return function(v){return v*(2-v)}(E);case v.InterpolationType.EASEQUAD:return function(v){return v*v/(2*(v*v-v)+1)}(E);case v.InterpolationType.EASEINSINE:return function(v){return 1-Math.cos(v*Math.PI/2)}(E);case v.InterpolationType.EASEOUTSINE:return function(v){return Math.sin(v*Math.PI/2)}(E);case v.InterpolationType.EASESINE:return function(v){return-(Math.cos(Math.PI*v)-1)/2}(E);case v.InterpolationType.EASEINEXPO:return function(v){return 0===v?0:Math.pow(2,10*v-10)}(E);case v.InterpolationType.EASEOUTEXPO:return function(v){return 1===v?1:1-Math.pow(2,-10*v)}(E);case v.InterpolationType.EASEEXPO:return function(v){return 0===v?0:1===v?1:v<.5?Math.pow(2,20*v-10)/2:(2-Math.pow(2,-20*v+10))/2}(E);case v.InterpolationType.EASEINELASTIC:return function(v){var A=2*Math.PI/3;return 0===v?0:1===v?1:-Math.pow(2,10*v-10)*Math.sin((10*v-10.75)*A)}(E);case v.InterpolationType.EASEOUTELASTIC:return function(v){var A=2*Math.PI/3;return 0===v?0:1===v?1:Math.pow(2,-10*v)*Math.sin((10*v-.75)*A)+1}(E);case v.InterpolationType.EASEELASTIC:return function(v){var A=2*Math.PI/4.5;return 0===v?0:1===v?1:v<.5?-Math.pow(2,20*v-10)*Math.sin((20*v-11.125)*A)/2:Math.pow(2,-20*v+10)*Math.sin((20*v-11.125)*A)/2+1}(E);case v.InterpolationType.EASEINBOUNCE:return function(v){return 1-l(1-v)}(E);case v.InterpolationType.EASEOUTEBOUNCE:return function(v){return l(v)}(E);case v.InterpolationType.EASEBOUNCE:return function(v){return v<.5?(1-l(1-2*v))/2:(1+l(2*v-1))/2}(E);default:return E}}function l(v){var A=7.5625,E=2.75;return v<1/E?A*v*v:v<2/E?A*(v-=1.5/E)*v+.75:v<2.5/E?A*(v-=2.25/E)*v+.9375:A*(v-=2.625/E)*v+.984375}v.InterpolationType=void 0,(E=v.InterpolationType||(v.InterpolationType={}))[E.LINEAR=0]="LINEAR",E[E.EASEINQUAD=1]="EASEINQUAD",E[E.EASEOUTQUAD=2]="EASEOUTQUAD",E[E.EASEQUAD=3]="EASEQUAD",E.EASEINSINE="easeinsine",E.EASEOUTSINE="easeoutsine",E.EASESINE="easeinoutsine",E.EASEINEXPO="easeinexpo",E.EASEOUTEXPO="easeoutexpo",E.EASEEXPO="easeinoutexpo",E.EASEINELASTIC="easeinelastic",E.EASEOUTELASTIC="easeoutelastic",E.EASEELASTIC="easeinoutelastic",E.EASEINBOUNCE="easeinbounce",E.EASEOUTEBOUNCE="easeoutbounce",E.EASEBOUNCE="easeinoutbounce";var O,M=function(){function t(E,O,M,V,W){void 0===W&&(W=v.InterpolationType.LINEAR),this.start=E,this.end=O,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=V,this.interpolationType=W,0!=M?this.speed=1/M:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),R.createAndAddToEngine().addComponentType(A)}var A;return A=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.start,this.end,this.lerpTime)},A=r([Component("moveTransformComponent")],t)}(),V=function(){function t(E,O,M,V,W){void 0===W&&(W=v.InterpolationType.LINEAR),this.start=E,this.end=O,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=V,this.interpolationType=W,0!=M?this.speed=1/M:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),R.createAndAddToEngine().addComponentType(A)}var A;return A=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.rotation=Quaternion.Slerp(this.start,this.end,this.lerpTime)},A=r([Component("rotateTransformComponent")],t)}(),W=function(){function t(E,O,M,V,W){void 0===W&&(W=v.InterpolationType.LINEAR),this.start=E,this.end=O,this.normalizedTime=0,this.lerpTime=0,this.onFinishCallback=V,this.interpolationType=W,0!=M?this.speed=1/M:(this.speed=0,this.normalizedTime=1,this.lerpTime=1),R.createAndAddToEngine().addComponentType(A)}var A;return A=t,t.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed,0,1),this.lerpTime=h(this.interpolationType,this.normalizedTime)},t.prototype.hasFinished=function(){return this.normalizedTime>=1},t.prototype.assignValueToTransform=function(v){v.scale=Vector3.Lerp(this.start,this.end,this.lerpTime)},A=r([Component("scaleTransformComponent")],t)}(),H=function(){function e(A,E,O,M){if(this.speed=[],this.normalizedTime=0,this.currentIndex=0,this.points=A,this.onFinishCallback=O,this.onPointReachedCallback=M,A.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(E>0){for(var V=0,W=[],H=0;H<A.length-1;H++){var X=Vector3.Distance(A[H],A[H+1]);V+=X,W.push(X)}for(H=0;H<W.length;H++)this.speed.push(1/(W[H]/V*E))}else this.normalizedTime=1,this.currentIndex=A.length-2;R.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,this.onPointReachedCallback&&this.currentIndex<this.points.length-1&&this.onPointReachedCallback(this.points[this.currentIndex],this.points[this.currentIndex+1]))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime)},v=r([Component("followPathComponent")],e)}(),X=function(){function e(A,E,O,M,V,W){if(this.speed=[],this.turnToFaceNext=!1,this.facingNext=!1,this.normalizedTime=0,this.currentIndex=0,this.points=Curve3.CreateCatmullRomSpline(A,O,!!V).getPoints(),this.onFinishCallback=W,this.turnToFaceNext=M||!1,this.points.length<2)throw new Error("At least 2 points are needed for FollowPathComponent.");if(E>0){for(var H=0,X=[],Z=0;Z<this.points.length-1;Z++){var K=Vector3.Distance(this.points[Z],this.points[Z+1]);H+=K,X.push(K)}for(Z=0;Z<X.length;Z++)this.speed.push(1/(X[Z]/H*E))}else this.normalizedTime=1,this.currentIndex=A.length-2;R.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.normalizedTime=Scalar.Clamp(this.normalizedTime+v*this.speed[this.currentIndex],0,1),this.normalizedTime>=1&&this.currentIndex<this.points.length-2&&(this.currentIndex++,this.normalizedTime=0,1==this.turnToFaceNext&&(this.facingNext=!1))},e.prototype.hasFinished=function(){return this.currentIndex>=this.points.length-2&&this.normalizedTime>=1},e.prototype.assignValueToTransform=function(v){v.position=Vector3.Lerp(this.points[this.currentIndex],this.points[this.currentIndex+1],this.normalizedTime),this.facingNext||(this.facingNext=!0,this.currentIndex<this.points.length-1?v.lookAt(this.points[this.currentIndex+1]):v.lookAt(this.points[0]))},v=r([Component("followCurvedPathComponent")],e)}(),Z=function(){function e(A,E){this.rotationVelocity=A,this.onFinishCallback=E,this.rotation=Quaternion.Identity,this.finished=!1,R.createAndAddToEngine().addComponentType(v)}var v;return v=e,e.prototype.update=function(v){this.rotation=Quaternion.Slerp(Quaternion.Identity,this.rotationVelocity,v)},e.prototype.hasFinished=function(){return this.finished},e.prototype.assignValueToTransform=function(v){v.rotation=v.rotation.multiply(this.rotation)},e.prototype.stop=function(){this.finished=!0},v=r([Component("keepRotatingComponent")],e)}();v.ToggleState=void 0,(O=v.ToggleState||(v.ToggleState={}))[O.Off=0]="Off",O[O.On=1]="On";var K=function(){function t(A,E){void 0===A&&(A=v.ToggleState.On),this.enabled=!0,this.state=v.ToggleState.Off,this.set(A),E&&this.setCallback(E)}return t.prototype.set=function(v){this.state=v,this.onValueChangedCallback&&this.onValueChangedCallback(v)},t.prototype.toggle=function(){this.enabled&&this.set(1-this.state)},t.prototype.isOn=function(){return this.state==v.ToggleState.On},t.prototype.setCallback=function(v){this.onValueChangedCallback=v},r([Component("toggle")],t)}(),$=function(){function e(){this._components=[],e._instance=this}return e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.registerCustomComponent=function(v){this.createAndAddToEngine()._components.push(v)},e.prototype.addComponentType=function(v){var A,E;try{for(var R=s(this._components),O=R.next();!O.done;O=R.next())if(v==O.value)return}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(A)throw A.error}}this._components.push(v)},e.prototype.update=function(v){var A=this;this._components.forEach((function(E){A.updateComponent(v,E)}))},e.prototype.updateComponent=function(v,A){var E=engine.getEntitiesWithComponent(A);for(var R in E)if(E.hasOwnProperty(R)){var O=E[R],M=O.getComponent(A);M.elapsedTime+=v,M.elapsedTime>=M.targetTime&&M.onTargetTimeReached(O)}},e._instance=null,e}(),J=function(){function e(A,E){var R=this;$.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=A/1e3,this.onTimeReachedCallback=E,this.onTargetTimeReached=function(v){R.onTimeReachedCallback&&R.onTimeReachedCallback(),v.removeComponent(R)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerDelay")],e)}(),et=function(){function e(A,E){var R=this;$.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=A/1e3,this.onTimeReachedCallback=E,this.onTargetTimeReached=function(v){R.onTimeReachedCallback&&R.onTimeReachedCallback(),v.removeComponent(R),engine.removeEntity(v)}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerExpireIn")],e)}(),it=function(){function e(A,E){var R=this;$.createAndAddToEngine().addComponentType(v),this.elapsedTime=0,this.targetTime=A/1e3,this.onTimeReachedCallback=E,this.onTargetTimeReached=function(){R.elapsedTime=0,R.onTimeReachedCallback&&R.onTimeReachedCallback()}}var v;return v=e,e.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=r([Component("timerInterval")],e)}();function I(v,A,E,R,O,M){var V=new Entity;V.addComponent(new Transform(M||{position:new Vector3(0,1.5,0)})),V.setParent(A);var W=new TextShape(v);return W.fontSize=O||3,W.color=R||Color3.Black(),V.addComponent(W),E&&V.addComponent(new Billboard),engine.addEntity(V),V}var nt,ot,rt=function(){function e(){this._triggers={},e._instance=this,this._cameraTriggerWrapper=new at(new P(new Vector3(.5,1.8,.5),new Vector3(0,.91,0))),this._componentGroup=engine.getComponentGroup(ht)}return Object.defineProperty(e,"instance",{get:function(){return this.createAndAddToEngine()},enumerable:!1,configurable:!0}),e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e.prototype.setCameraTriggerShape=function(v){this._cameraTriggerWrapper.setShape(v)},e.prototype.update=function(){var v=this,A=this._componentGroup.entities;for(var E in A.forEach((function(A){v.shouldWrapTriggerEntity(A)&&v.wrapTriggerEntity(A)})),this._triggers)if(this._triggers.hasOwnProperty(E)){var R=this._triggers[E];R.isDebugging()&&R.updateDebugEntity(),R.isInEngine()?null!=R.trigger&&R.trigger.enabled?(R.wasEnabled||R.isDebugging()&&R.addDebugEntity(),R.wasEnabled=!0,(R.trigger.onCameraEnter||R.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(R),(R.trigger.onTriggerEnter||R.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(R)):R.wasEnabled&&(R.wasEnabled=!1,R.isDebugging()&&R.removeDebugEntity(),e.removeTriggerFromSystem(R)):(R.isDebugging()&&R.removeDebugEntity(),e.removeTriggerFromSystem(R),delete this._triggers[E])}},e.prototype.shouldWrapTriggerEntity=function(v){return null==this._triggers[v.uuid]||null==this._triggers[v.uuid]},e.prototype.wrapTriggerEntity=function(v){this._triggers[v.uuid]=new st(v)},e.removeTriggerFromSystem=function(v){for(var A,E=v.getActiveCollisions(),R=0;R<E.length;R++)!(E[R]===(null===(A=e._instance)||void 0===A?void 0:A._cameraTriggerWrapper)||null==E[R].trigger)&&E[R].trigger.onTriggerExit&&v.entity&&E[R].trigger.onTriggerExit(v.entity),E[R].disengageActiveCollision(v),v.disengageActiveCollision(E[R])},e.disengageCollision=function(v,A){v.disengageActiveCollision(A),A.disengageActiveCollision(v),v.trigger.onTriggerExit&&A.entity&&v.trigger.onTriggerExit(A.entity),A.trigger.onTriggerExit&&v.entity&&A.trigger.onTriggerExit(v.entity)},e.engageCollision=function(v,A){v.engageCollision(A),A.engageCollision(v),v.trigger.onTriggerEnter&&A.entity&&v.trigger.onTriggerEnter(A.entity),A.trigger.onTriggerEnter&&v.entity&&A.trigger.onTriggerEnter(v.entity)},e.prototype.checkCollisionAgainstCamera=function(v){var A=v.hasActiveCollision(this._cameraTriggerWrapper),E=e.areColliding(v,this._cameraTriggerWrapper);A&&!E?(v.disengageActiveCollision(this._cameraTriggerWrapper),v.trigger.onCameraExit&&v.trigger.onCameraExit()):!A&&E&&(v.engageCollision(this._cameraTriggerWrapper),v.trigger.onCameraEnter&&v.trigger.onCameraEnter())},e.prototype.checkCollisionAgainstOtherTriggers=function(v){for(var A in this._triggers)if(this._triggers.hasOwnProperty(A)&&A!=v.uuid&&this._triggers[A].trigger.enabled&&e.canTriggersCollide(v,this._triggers[A])){var E=v.hasActiveCollision(this._triggers[A]),R=e.areColliding(v,this._triggers[A]);E&&!R?e.disengageCollision(v,this._triggers[A]):!E&&R&&e.engageCollision(v,this._triggers[A])}},e.canTriggersCollide=function(v,A){return 0==v.trigger.triggeredByLayer||0!=(A.trigger.layer&v.trigger.triggeredByLayer)},e.areColliding=function(v,A){return v.getShape()instanceof P&&A.getShape()instanceof P?e.areCollidingAABB(v.getGlobalPosition(),v.getShape(),A.getGlobalPosition(),A.getShape()):v.getShape()instanceof k&&A.getShape()instanceof k?e.areCollidingSphere(v.getGlobalPosition(),v.getShape(),A.getGlobalPosition(),A.getShape()):v.getShape()instanceof P&&A.getShape()instanceof k?e.areCollidingAABBSphere(v.getGlobalPosition(),v.getShape(),A.getGlobalPosition(),A.getShape()):v.getShape()instanceof k&&A.getShape()instanceof P&&e.areCollidingAABBSphere(A.getGlobalPosition(),A.getShape(),v.getGlobalPosition(),v.getShape())},e.areCollidingAABB=function(v,A,E,R){var O=e.getBoxShapeValues(v,A),M=e.getBoxShapeValues(E,R);return O.min.x<=M.max.x&&O.max.x>=M.min.x&&O.min.y<=M.max.y&&O.max.y>=M.min.y&&O.min.z<=M.max.z&&O.max.z>=M.min.z},e.areCollidingSphere=function(v,A,E,R){return Vector3.DistanceSquared(v.add(A.position),E.add(R.position))<A.radius*A.radius+R.radius*R.radius},e.areCollidingAABBSphere=function(v,A,E,R){var O=e.getBoxShapeValues(v,A),M=E.add(R.position),V=R.radius,W=0;return M.x<O.min.x&&(W+=(O.min.x-M.x)*(O.min.x-M.x)),M.x>O.max.x&&(W+=(M.x-O.max.x)*(M.x-O.max.x)),M.y<O.min.y&&(W+=(O.min.y-M.y)*(O.min.y-M.y)),M.y>O.max.y&&(W+=(M.y-O.max.y)*(M.y-O.max.y)),M.z<O.min.z&&(W+=(O.min.z-M.z)*(O.min.z-M.z)),M.z>O.max.z&&(W+=(M.z-O.max.z)*(M.z-O.max.z)),W<V*V},e.getBoxShapeValues=function(v,A){var E=v.add(A.position);return{center:E,min:E.subtract(A.size.scale(.5)),max:E.add(A.size.scale(.5))}},e._instance=null,e}(),st=function(){function e(v){this.wasEnabled=!0,this._uuid="",this._collidingWith={},this._isDebug=!1,this._debugEntity=null,this._entity=v,v&&(this._trigger=v.getComponent(ht),this._uuid=v.uuid,this._isDebug=this._trigger.debugEnabled,this._isDebug&&this.addDebugEntity())}return Object.defineProperty(e.prototype,"entity",{get:function(){return this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trigger",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),e.prototype.getGlobalPosition=function(){return this._entity?e.getEntityWorldPosition(this._entity):Vector3.Zero()},e.prototype.getShape=function(){return this._trigger.shape},e.prototype.isInEngine=function(){return null!=this._entity&&this._entity.isAddedToEngine()},e.prototype.getActiveCollisions=function(){var v=[];for(var A in this._collidingWith)this._collidingWith.hasOwnProperty(A)&&v.push(this._collidingWith[A]);return v},e.prototype.hasActiveCollision=function(v){return null!=this._collidingWith[v.uuid]&&null!=this._collidingWith[v.uuid]},e.prototype.disengageActiveCollision=function(v){delete this._collidingWith[v.uuid]},e.prototype.engageCollision=function(v){this._collidingWith[v.uuid]=v},e.prototype.isDebugging=function(){return this._isDebug},e.prototype.addDebugEntity=function(){return o(this,void 0,void 0,(function(){var v,E,R;return a(this,(function(O){switch(O.label){case 0:return[4,!A.isPreviewMode()];case 1:return O.sent()||(e._debugMaterial||(e._debugMaterial=new Material,e._debugMaterial.alphaTest=.5),null==this._debugEntity&&(this._debugEntity=new Entity,v=new Transform,this._debugEntity.addComponent(v),this._debugEntity.addComponent(e._debugMaterial),this.getShape()instanceof P&&((E=new BoxShape).withCollisions=!1,this._debugEntity.addComponent(E),v.scale=this.getShape().size),this.getShape()instanceof k&&((E=new SphereShape).withCollisions=!1,this._debugEntity.addComponent(E),R=this.getShape().radius,v.scale=new Vector3(R,R,R))),engine.addEntity(this._debugEntity)),[2]}}))}))},e.prototype.removeDebugEntity=function(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)},e.prototype.updateDebugEntity=function(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))},e.getEntityWorldPosition=function(v){var A=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),E=v.getParent();if(null!=E){var R=E.hasComponent(Transform)?E.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(E).add(A.rotate(R))}return A},e._debugMaterial=null,e}(),at=function(v){function t(A){var E=v.call(this)||this;return E._shape=A,E._uuid="cameraTrigger",E}return i(t,v),t.prototype.getGlobalPosition=function(){return Camera.instance.position},t.prototype.getShape=function(){return this._shape},t.prototype.setShape=function(v){this._shape=v},t.prototype.isInEngine=function(){return!1},t.prototype.hasActiveCollision=function(v){return!1},t.prototype.disengageActiveCollision=function(v){},t.prototype.engageCollision=function(v){},t.prototype.isDebugging=function(){return!1},t}(st),ht=function(){function e(v,A){this.enabled=!0,this.layer=0,this.triggeredByLayer=0,this._debugEnabled=!1,rt.createAndAddToEngine(),this.shape=v,A&&(A.layer&&(this.layer=A.layer),A.triggeredByLayer&&(this.triggeredByLayer=A.triggeredByLayer),A.onTriggerEnter&&(this.onTriggerEnter=A.onTriggerEnter),A.onTriggerExit&&(this.onTriggerExit=A.onTriggerExit),A.onCameraEnter&&(this.onCameraEnter=A.onCameraEnter),A.onCameraExit&&(this.onCameraExit=A.onCameraExit),A.enableDebug&&(this._debugEnabled=A.enableDebug))}return Object.defineProperty(e.prototype,"debugEnabled",{get:function(){return this._debugEnabled},enumerable:!1,configurable:!0}),r([Component("triggerComponent")],e)}(),P=function(v,A){void 0===v&&(v=Vector3.One().scale(2)),void 0===A&&(A=Vector3.Zero()),this.size=v,this.position=A},k=function(v,A){void 0===v&&(v=2),void 0===A&&(A=Vector3.Zero()),this.radius=v,this.position=A};v.ActionsSequenceSystem=function(){function e(v){this.beginSequenceNode=null,this.currentSequenceNode=null,this.running=!1,this.started=!1,v&&this.startSequence(v)}return e.prototype.startSequence=function(v){this.beginSequenceNode=v.beginSequenceNode,this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.setOnFinishCallback=function(v){this.onFinishCallback=v},e.prototype.isRunning=function(){return this.running},e.prototype.stop=function(){this.running=!1},e.prototype.resume=function(){null!=this.beginSequenceNode&&(this.running=!0)},e.prototype.reset=function(){this.currentSequenceNode=this.beginSequenceNode,this.running=!0,this.started=!1},e.prototype.getRunningAction=function(){var v=this.currentSequenceNode;if(this.currentSequenceNode instanceof lt)do{v=v.currentInnerSequence}while(v instanceof lt);return v.action},e.prototype.update=function(v){this.running&&(this.started?this.currentSequenceNode.hasFinish()?(this.currentSequenceNode.onFinish(),this.currentSequenceNode=this.currentSequenceNode.next,this.currentSequenceNode?this.currentSequenceNode.onStart():(this.running=!1,this.onFinishCallback&&this.onFinishCallback())):this.currentSequenceNode.update(v):(this.currentSequenceNode.onStart(),this.started=!0))},e}(),nt=v.ActionsSequenceSystem||(v.ActionsSequenceSystem={}),ot=function(){function e(){this.currentSequenceNode=null,this.beginSequenceNode=null,this.whileNodeStack=[]}return e.prototype.then=function(v){if(null==this.currentSequenceNode)this.currentSequenceNode=new ct,this.currentSequenceNode.action=v,this.beginSequenceNode=this.currentSequenceNode;else{var A=new ct;A.action=v,this.currentSequenceNode=this.currentSequenceNode.then(A)}return this},e.prototype.if=function(v){var A=new ut(v);return null==this.currentSequenceNode?(this.currentSequenceNode=A,this.beginSequenceNode=A):this.currentSequenceNode=this.currentSequenceNode.then(A),this},e.prototype.else=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof ut))throw new Error("IF statement is needed to be called before ELSE statement.");v.closed=!0;var A=new pt(v);return this.currentSequenceNode=this.currentSequenceNode.then(A),this},e.prototype.endIf=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof ut||v instanceof pt))throw new Error("IF statement is needed to be called before ENDIF statement.");return v.closed=!0,this},e.prototype.while=function(v){var A=new dt(v);return null==this.currentSequenceNode?(this.currentSequenceNode=A,this.beginSequenceNode=A):this.currentSequenceNode=this.currentSequenceNode.then(A),this.whileNodeStack.push(A),this},e.prototype.endWhile=function(){var v=this.currentSequenceNode.getSequence();if(!(v instanceof dt))throw new Error("WHILE statement is needed to be called before ENDWHILE statement.");return v.closed=!0,this.whileNodeStack.length>0&&this.whileNodeStack.splice(this.whileNodeStack.length-1,1),this},e.prototype.breakWhile=function(){if(!(this.whileNodeStack.length>0))throw new Error("WHILE statement is needed to be called before BREAKWHILE statement.");return this.currentSequenceNode=this.currentSequenceNode.then(new gt(this.whileNodeStack[this.whileNodeStack.length-1])),this},e}(),nt.SequenceBuilder=ot;var ct=function(){function e(){this.action=null,this.next=null}return e.prototype.then=function(v){return this.next=v,v},e.prototype.onStart=function(){this.action&&this.action.onStart()},e.prototype.update=function(v){this.action&&this.action.update(v)},e.prototype.onFinish=function(){this.action&&this.action.onFinish()},e.prototype.hasFinish=function(){return!this.action||this.action.hasFinished},e.prototype.getSequence=function(){return this},e}(),lt=function(v){function t(){var A=null!==v&&v.apply(this,arguments)||this;return A.currentInnerSequence=null,A.startingInnerSequence=null,A.closed=!1,A}return i(t,v),t.prototype.then=function(v){if(null==this.currentInnerSequence)this.currentInnerSequence=v,this.startingInnerSequence=v;else{if(this.closed)return this.next=v,v;this.currentInnerSequence=this.currentInnerSequence.then(v)}return this},t.prototype.onStart=function(){this.currentInnerSequence=this.startingInnerSequence,this.currentInnerSequence&&this.currentInnerSequence.onStart()},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.onFinish=function(){this.currentInnerSequence&&this.currentInnerSequence.onFinish()},t.prototype.hasFinish=function(){return null==this.currentInnerSequence},t.prototype.getSequence=function(){if(this.currentInnerSequence){var v=this.currentInnerSequence.getSequence();if(v instanceof t&&!v.closed)return v}return this},t}(ct),ut=function(v){function t(A){var E=v.call(this)||this;return E.result=!1,E.condition=A,E}return i(t,v),t.prototype.onStart=function(){this.result=this.condition(),this.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(lt),pt=function(v){function t(A){var E=v.call(this)||this;return E.ifSequence=null,E.ifSequence=A,E}return i(t,v),t.prototype.onStart=function(){this.ifSequence&&!this.ifSequence.result?v.prototype.onStart.call(this):this.currentInnerSequence=null},t}(lt),dt=function(v){function t(A){var E=v.call(this)||this;return E.breakWhile=!1,E.condition=A,E}return i(t,v),t.prototype.onStart=function(){this.breakWhile=!1,this.condition()?v.prototype.onStart.call(this):this.currentInnerSequence=null},t.prototype.update=function(v){this.currentInnerSequence&&(this.currentInnerSequence.hasFinish()?(this.currentInnerSequence.onFinish(),this.currentInnerSequence=this.currentInnerSequence.next,null==this.currentInnerSequence&&(this.currentInnerSequence=this.startingInnerSequence),this.currentInnerSequence&&this.currentInnerSequence.onStart()):this.currentInnerSequence.update(v))},t.prototype.hasFinish=function(){return this.breakWhile||!this.condition()},t}(lt),gt=function(v){function t(A){var E=v.call(this)||this;return E.whileNode=A,E}return i(t,v),t.prototype.onStart=function(){this.whileNode.breakWhile=!0},t}(ct);v.Delay=J,v.ExpireIn=et,v.FollowCurvedPathComponent=X,v.FollowPathComponent=H,v.Interpolate=h,v.Interval=it,v.KeepRotatingComponent=Z,v.MoveTransformComponent=M,v.RotateTransformComponent=V,v.ScaleTransformComponent=W,v.SequenceNode=ct,v.ToggleComponent=K,v.TransformSystem=R,v.TriggerBoxShape=P,v.TriggerComponent=ht,v.TriggerSphereShape=k,v.TriggerSystem=rt,v.addLabel=I,v.addOneTimeTrigger=function(v,A,E){var R=!1,O=!1,M=new Entity;M.addComponent(new Transform({}));var V={};return A.layer&&(V.layer=A.layer),A.triggeredByLayer&&(V.triggeredByLayer=A.triggeredByLayer),A.onCameraEnter&&(V.onCameraEnter=function(){R||(R=!0,A.onCameraEnter()),!R&&A.onCameraEnter||!O&&A.onCameraExit||engine.removeEntity(M)}),A.onCameraExit&&(V.onCameraExit=function(){O||(O=!0,A.onCameraExit()),!R&&A.onCameraEnter||!O&&A.onCameraExit||engine.removeEntity(M)}),A.enableDebug&&(V.enableDebug=A.enableDebug),M.addComponent(new ht(v,V)),E&&M.setParent(E),engine.addEntity(M),M},v.addTestCube=function(v,E,R,O,M,V,W){return o(this,void 0,void 0,(function(){var H,X,Z;return a(this,(function(K){switch(K.label){case 0:return(H=!W)?[4,!A.isPreviewMode()]:[3,2];case 1:H=K.sent(),K.label=2;case 2:return H?[2]:((X=new Entity).addComponent(new Transform(v)),M?(X.addComponent(new SphereShape),X.getComponent(Transform).scale.setAll(.5)):X.addComponent(new BoxShape),engine.addEntity(X),X.addComponent(new OnPointerDown(E,{hoverText:R||"click",button:ActionButton.POINTER})),O&&((Z=new Material).albedoColor=O,X.addComponent(Z)),V&&(X.getComponent(BoxShape).withCollisions=!1),R&&I(R,X,!0),[2,X])}}))}))},v.clamp=function(v,A,E){var R=v;return v>E?R=E:v<A&&(R=A),R},v.getEntityWorldPosition=function e(v){var A=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),E=v.getParent();if(null!=E&&"0"!=E.uuid){if("FirstPersonCameraEntityReference"==E.uuid){var R=Camera.instance.rotation.clone();return Camera.instance.position.clone().add(A.rotate(R))}if("AvatarEntityReference"==E.uuid){var O=Camera.instance.rotation;return R=Quaternion.Euler(0,O.eulerAngles.y,0),Camera.instance.position.clone().add(A.rotate(R)).add(new Vector3(0,-.875,0))}return R=E.hasComponent(Transform)?E.getComponent(Transform).rotation:Quaternion.Identity,e(E).add(A.rotate(R))}return A},v.getEntityWorldRotation=function e(v){var A=v.hasComponent(Transform)?v.getComponent(Transform).rotation.clone():Quaternion.Zero(),E=v.getParent();if(null!=E&&"0"!=E.uuid){if("FirstPersonCameraEntityReference"==E.uuid){var R=Camera.instance.rotation.clone();return A.multiply(R)}return"AvatarEntityReference"==E.uuid?(R=Quaternion.Euler(0,Camera.instance.rotation.eulerAngles.y,0),A.multiply(R)):(R=e(E),A.multiply(R))}return A},v.map=function(v,A,E,R,O){return(v-A)/(E-A)*(O-R)+R},v.sendRequest=function(v,A,E,R){return o(this,void 0,void 0,(function(){var O,M,V;return a(this,(function(W){switch(W.label){case 0:return W.trys.push([0,6,,7]),O={method:A||"GET"},E&&(O.headers=E),R&&(O.body=JSON.stringify(R)),[4,fetch(v,O)];case 1:M=W.sent(),W.label=2;case 2:return W.trys.push([2,4,,5]),[4,M.json()];case 3:return[2,W.sent()];case 4:return W.sent(),[2,M];case 5:return[3,7];case 6:return V=W.sent(),log("error fetching from ",v," : ",V),[3,7];case 7:return[2]}}))}))},v.setTimeout=function(v,A){var E=new Entity;return E.addComponent(new J(v,(function(){A(),engine.removeEntity(E)}))),engine.addEntity(E),E},Object.defineProperty(v,"__esModule",{value:!0})})),function(v,A){"object"==typeof exports&&"undefined"!=typeof module?A(exports):"function"==typeof define&&define.amd?define("@dcl/npc-scene-utils",["exports"],A):A((v="undefined"!=typeof globalThis?globalThis:v||self)["@dcl/npc-scene-utils"]={})}(this,(function(v){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var e=function(v,A){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,A){v.__proto__=A}||function(v,A){for(var E in A)Object.prototype.hasOwnProperty.call(A,E)&&(v[E]=A[E])})(v,A)};function i(v,A){function o(){this.constructor=v}e(v,A),v.prototype=null===A?Object.create(A):(o.prototype=A.prototype,new o)}function o(v,A,E,R){var O,M=arguments.length,V=M<3?A:null===R?R=Object.getOwnPropertyDescriptor(A,E):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)V=Reflect.decorate(v,A,E,R);else for(var W=v.length-1;W>=0;W--)(O=v[W])&&(V=(M<3?O(V):M>3?O(A,E,V):O(A,E))||V);return M>3&&V&&Object.defineProperty(A,E,V),V}function n(v){var A="function"==typeof Symbol&&Symbol.iterator,E=A&&v[A],R=0;if(E)return E.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&R>=v.length&&(v=void 0),{value:v&&v[R++],done:!v}}};throw new TypeError(A?"Object is not iterable.":"Symbol.iterator is not defined.")}var A=o([Component("trackUserFlag")],(function(v,A,R){this.lockXZRotation=!1,this.active=!1,E||(E=!0,engine.addSystem(new O)),this.lockXZRotation=v||!1,this.rotSpeed=A||2,R&&(this.active=!0)})),E=!1,R=Camera.instance,O=function(){function t(){this.followingNPCs=engine.getComponentGroup(A)}return t.prototype.update=function(v){var E,O;try{for(var M=n(this.followingNPCs.entities),V=M.next();!V.done;V=M.next()){var W=V.value,H=W.getComponent(Transform),X=W.getComponent(A);if(X.active){var Z=new Vector3(R.position.x,R.position.y,R.position.z).subtract(H.position);H.rotation=Quaternion.Slerp(H.rotation,Quaternion.LookRotation(Z),v*X.rotSpeed),X.lockXZRotation&&(H.rotation.x=0,H.rotation.z=0)}}}catch(v){E={error:v}}finally{try{V&&!V.done&&(O=M.return)&&O.call(M)}finally{if(E)throw E.error}}},t}(),M=new UICanvas;M.visible=!0;var V,W,H,X=new Font(Fonts.SanFrancisco),Z=new Font(Fonts.SanFrancisco_Heavy),K=new Texture("https://decentraland.org/images/ui/light-atlas-v3.png"),$=new Texture("https://decentraland.org/images/ui/dark-atlas-v3.png"),J=new Texture("https://decentraland.org/images/ui/dialog-bubbles.png");function T(v,A,E,R){void 0===E&&(E=512),void 0===R&&(R=512),function(v,A,E,R,O){v.uvs=[A.x,A.y,E.x,E.y,R.x,R.y,O.x,O.y,A.x,A.y,E.x,E.y,R.x,R.y,O.x,O.y]}(v,new Vector2(A.sourceLeft/E,(R-A.sourceTop-A.sourceHeight)/R),new Vector2((A.sourceLeft+A.sourceWidth)/E,(R-A.sourceTop-A.sourceHeight)/R),new Vector2((A.sourceLeft+A.sourceWidth)/E,(R-A.sourceTop)/R),new Vector2(A.sourceLeft/E,(R-A.sourceTop)/R))}function C(v,A){v.sourceWidth=A.sourceWidth,v.sourceHeight=A.sourceHeight,v.sourceLeft=A.sourceLeft?A.sourceLeft:0,v.sourceTop=A.sourceTop?A.sourceTop:0}function y(v){var A=-10-4*v;return A>-65?A:-65}(V=v.ButtonStyles||(v.ButtonStyles={})).E="e",V.F="f",V.DARK="dark",V.RED="red",V.ROUNDBLACK="roundblack",V.ROUNDWHITE="roundwhite",V.ROUNDSILVER="roundsilver",V.ROUNDGOLD="roundgold",V.SQUAREBLACK="squareblack",V.SQUAREWHITE="squarewhite",V.SQUARESILVER="squaresilver",V.SQUAREGOLD="squaregold",V.WHITE="white",(W=v.NPCState||(v.NPCState={})).STANDING="standing",W.TALKING="talking",W.FOLLOWPATH="followPath",(H=v.NPCLerpType||(v.NPCLerpType={})).SMOOTH_PATH="smooth",H.RIGID_PATH="rigid";var et,it={buttons:{buttonE:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},buttonF:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},white:{sourceWidth:174,sourceHeight:46,sourceLeft:698,sourceTop:662},buttonRed:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},buttonDark:{sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},roundBlack:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:458},squareBlack:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:457},roundWhite:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:494},squareWhite:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:493},roundSilver:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:531},squareSilver:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:531},roundGold:{sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:567},squareGold:{sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:567}},buttonLabels:{E:{sourceWidth:26,sourceHeight:26,sourceLeft:697,sourceTop:611},F:{sourceWidth:26,sourceHeight:26,sourceLeft:733,sourceTop:611},EBlack:{sourceWidth:26,sourceHeight:26,sourceLeft:766,sourceTop:611},FBlack:{sourceWidth:26,sourceHeight:26,sourceLeft:802,sourceTop:611}},backgrounds:{promptBackground:{sourceWidth:416,sourceHeight:352,sourceLeft:501,sourceTop:12},promptLargeBackground:{sourceWidth:480,sourceHeight:384,sourceLeft:7,sourceTop:12},promptSlantedBackground:{sourceWidth:486,sourceHeight:326,sourceLeft:7,sourceTop:413},NPCDialog:{sourceWidth:766,sourceHeight:248,sourceLeft:22,sourceTop:756}},icons:{closeW:{sourceWidth:32,sourceHeight:32,sourceLeft:942,sourceTop:306},closeD:{sourceWidth:32,sourceHeight:32,sourceLeft:986,sourceTop:306},closeWLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:512,sourceTop:381},closeDLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:583,sourceTop:381},closeWNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:252},closeDNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:214},closeWNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:214},closeDNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:260},FDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:4},FWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:4},EDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:40},EWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:40},Timer:{sourceWidth:24,sourceHeight:32.2,sourceLeft:718,sourceTop:388},TimerLarge:{sourceWidth:48,sourceHeight:68,sourceLeft:662,sourceTop:386},ClickWhite:{sourceWidth:32,sourceHeight:48,sourceLeft:799,sourceTop:389},ClickDark:{sourceWidth:32,sourceHeight:48,sourceLeft:757,sourceTop:389}},checkboxes:{wOff:{sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:76},wOn:{sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:104},dOff:{sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:76},dOn:{sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:104},wLargeOff:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:132},wLargeOn:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:168},dLargeOff:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:132},dLargeOn:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:168}},switches:{roundOff:{sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:454},roundRed:{sourceWidth:64,sourceHeight:32,sourceLeft:853,sourceTop:454},roundGreen:{sourceWidth:64,sourceHeight:32,sourceLeft:923,sourceTop:454},squareOff:{sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:501},squareRed:{sourceWidth:64,sourceHeight:32,sourceLeft:852,sourceTop:501},squareGreen:{sourceWidth:64,sourceHeight:32,sourceLeft:921,sourceTop:501}},bubbles:{short:{sourceWidth:232,sourceHeight:168,sourceLeft:610,sourceTop:834},normal:{sourceWidth:572,sourceHeight:168,sourceLeft:16,sourceTop:834},long:{sourceWidth:994,sourceHeight:306,sourceLeft:12,sourceTop:508},huge:{sourceWidth:994,sourceHeight:478,sourceLeft:12,sourceTop:14}}},nt=function(){function t(A,E){var R=this;rt.createAndAddToEngine(),this.elapsedTime=0,this.targetTime=A,this.onTimeReachedCallback=E,this.onTargetTimeReached=function(A){R.onTimeReachedCallback(),A.removeComponent(v)}}var v;return v=t,t.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=o([Component("npcTimerDelay")],t)}(),ot=engine.getComponentGroup(nt),rt=function(){function t(){t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(v){var A,E;try{for(var R=n(ot.entities),O=R.next();!O.done;O=R.next()){var M=O.value,V=M.getComponent(nt);V.elapsedTime+=v,V.elapsedTime>=V.targetTime&&V.onTargetTimeReached(M)}}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(A)throw A.error}}},t._instance=null,t}();!function(v){v[v.Confirm=0]="Confirm",v[v.Cancel=1]="Cancel",v[v.Next=2]="Next",v[v.Button3=3]="Button3",v[v.Button4=4]="Button4"}(et||(et={}));var st=.75,at=-262.5,ht=262.5,ct=37.5,lt=192,ut=192,pt=7.5,dt=112.5,gt=112.5,ft=-48.75,yt=-48.75,bt=19.5,vt=19.5,wt=function(){function e(A,E,R,O){var V=this;this.NPCScript=[],this.isDialogOpen=!1,this.isQuestionPanel=!1,this.isFixedScreen=!1,this.activeTextId=0,this.UIOpenTime=0,this.defaultSound=null,this.canvas=M,this.ClickAction=null,this.EButtonAction=null,this.FButtonAction=null,this.defaultPortrait=A||null,this.uiTheme=O||(E?$:K),this.container=new UIContainerRect(M),this.container.width="100%",this.container.vAlign="bottom",this.container.positionY=105,this.container.visible=!1,this.panel=new UIImage(this.container,this.uiTheme),C(this.panel,it.backgrounds.NPCDialog),this.panel.width=574.5,this.panel.height=186,this.panel.onClick=new OnClick((function(){V.confirmText(et.Next)})),this.defaultPortraitTexture=new Texture(A?A.path:this.uiTheme.src),this.portrait=new UIImage(this.container,this.defaultPortraitTexture),this.portrait.sourceWidth=A&&A.section?A.section.sourceWidth:256,this.portrait.sourceHeight=A&&A.section?A.section.sourceHeight:256,this.portrait.width=A&&A.width?A.width*st:lt,this.portrait.height=A&&A.height?A.height*st:lt,this.portrait.positionX=A&&A.offsetX?A.offsetX*st+at:at,this.portrait.positionY=A&&A.offsetY?A.offsetY*st+0:0,this.portrait.onClick=new OnClick((function(){V.confirmText(et.Next)})),this.image=new UIImage(this.container,new Texture(this.uiTheme.src)),this.image.sourceWidth=256,this.image.sourceHeight=256,this.image.sourceTop=0,this.image.sourceLeft=0,this.image.width=ut,this.image.height=ut,this.image.positionX=ht,this.image.positionY=ct,this.image.onClick=new OnClick((function(){V.confirmText(et.Next)})),this.text=new UIText(this.container),this.text.adaptWidth=!1,this.text.textWrapping=!0,this.text.width=345,this.text.positionX=30,this.text.hAlign="center",this.text.vAlign="center",this.text.font=Z,this.text.fontSize=18,this.text.hTextAlign="left",this.text.vTextAlign="center",this.text.positionY=pt,this.text.color=E?Color4.White():Color4.Black(),this.text.isPointerBlocker=!1,this.soundEnt=new Entity,this.soundEnt.addComponent(new Transform),engine.addEntity(this.soundEnt),this.soundEnt.setParent(Attachable.AVATAR),R&&(this.soundEnt.addComponent(new AudioSource(new AudioClip(R))),this.soundEnt.getComponent(AudioSource).volume=.5,this.defaultSound=R),this.button1=new xt(this.container,this.uiTheme,"yes",dt,ft,(function(){V.confirmText(et.Confirm)}),!!E,v.ButtonStyles.E),this.button1.hide(),this.button2=new xt(this.container,this.uiTheme,"no",-60,yt,(function(){V.confirmText(et.Cancel)}),!!E,v.ButtonStyles.F),this.button2.hide(),this.button3=new xt(this.container,this.uiTheme,"maybe",-60,-60,(function(){V.confirmText(et.Button3)}),!!E,v.ButtonStyles.DARK),this.button3.hide(),this.button4=new xt(this.container,this.uiTheme,"maybe",gt,-60,(function(){V.confirmText(et.Button4)}),!!E,v.ButtonStyles.DARK),this.button4.hide(),this.skipButton=new xt(this.container,this.uiTheme,"Skip",-225,-75,(function(){V.skipDialogs()}),!1,$?v.ButtonStyles.WHITE:v.ButtonStyles.F),this.skipButton.image.width=60,this.skipButton.image.height=22.5,this.skipButton.label.hTextAlign="left",this.skipButton.label.fontSize=9,this.skipButton.label.positionX=30,this.skipButton.label.font=Z,this.skipButton.icon.height=15,this.skipButton.icon.width=15,this.skipButton.icon.positionX=-15,this.skipButton.hide(),this.leftClickIcon=new UIImage(this.container,this.uiTheme),this.leftClickIcon.width=24,this.leftClickIcon.height=36,this.leftClickIcon.positionX=255,this.leftClickIcon.positionY=-60,this.leftClickIcon.visible=!1,C(this.leftClickIcon,E?it.icons.ClickDark:it.icons.ClickWhite),Tt.createAndAddToEngine()}return e.prototype.openDialogWindow=function(v,A){var E=this;this.UIOpenTime=+Date.now(),this.NPCScript=v,this.activeTextId=A?"number"==typeof A?A:z(v,A):0;var R=v[this.activeTextId]?v[this.activeTextId]:{text:""};if(R.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(R.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce()),R.portrait?(this.portrait.source=new Texture(R.portrait.path),this.portrait.positionX=R.portrait.offsetX?R.portrait.offsetX*st+at:at,this.portrait.positionY=R.portrait.offsetY?R.portrait.offsetY*st+0:0,this.portrait.width=R.portrait.width?R.portrait.width*st:lt,this.portrait.height=R.portrait.height?R.portrait.height*st:lt,R.portrait.section&&C(this.portrait,R.portrait.section),this.portrait.visible=!0):this.defaultPortrait?(this.portrait.source=this.defaultPortraitTexture,this.portrait.positionX=this.defaultPortrait&&this.defaultPortrait.offsetX?this.defaultPortrait.offsetX*st+at:at,this.portrait.positionY=this.defaultPortrait&&this.defaultPortrait.offsetY?this.defaultPortrait.offsetY*st+0:0,this.portrait.width=this.defaultPortrait&&this.defaultPortrait.width?this.defaultPortrait.width*st:lt,this.portrait.height=this.defaultPortrait&&this.defaultPortrait.height?this.defaultPortrait.height*st:lt,this.defaultPortrait.section&&C(this.portrait,this.defaultPortrait.section),this.portrait.visible=!0):(log("No portrait"),this.portrait.visible=!1),R.image){var O=R.image;log("setting image to ",O.path),this.image.source=new Texture(O.path),this.image.positionX=O.offsetX?O.offsetX*st+ht:ht,this.image.positionY=O.offsetY?O.offsetY*st+ct:ct,this.image.width=O.width?O.width*st:ut,this.portrait.height=O.height?O.height*st:ut,O.section&&C(this.image,O.section),this.image.visible=!0}else this.image.visible=!1;this.text.fontSize=R.fontSize?R.fontSize*st:18,this.text.positionY=R.offsetY?R.offsetY*st+pt:pt,this.text.positionX=R.offsetX?R.offsetX*st:0,this.text.visible=!0,this.container.visible=!0,Tt._instance.newText(this,R.text,this.activeTextId,R.typeSpeed?R.typeSpeed:void 0),this.ClickAction||(this.ClickAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.POINTER,!1,(function(v){!E.isDialogOpen||+Date.now()-E.UIOpenTime<100||(Tt._instance.done?E.isQuestionPanel||E.isFixedScreen||E.confirmText(et.Next):Tt._instance.rush())})),this.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){!E.isDialogOpen||+Date.now()-E.UIOpenTime<100||(E.isQuestionPanel?E.confirmText(et.Confirm):E.isQuestionPanel||E.isFixedScreen||E.confirmText(et.Next))})),this.FButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,(function(v){!E.isDialogOpen||+Date.now()-E.UIOpenTime<100||(E.isQuestionPanel?E.confirmText(et.Cancel):R.skipable&&!E.isFixedScreen&&E.skipDialogs())}))),this.layoutDialogWindow(this.activeTextId),this.isDialogOpen=!0},e.prototype.confirmText=function(v){var A=this.NPCScript[this.activeTextId];if(this.UIOpenTime=+Date.now(),v==et.Next&&!A.isQuestion){if(A.triggeredByNext&&A.triggeredByNext(),A.isEndOfDialog)return void this.closeDialogWindow();this.activeTextId++}v==et.Confirm&&A.buttons&&A.buttons.length>=1&&("number"==typeof A.buttons[0].goToDialog?this.activeTextId=A.buttons[0].goToDialog:this.activeTextId=z(this.NPCScript,A.buttons[0].goToDialog),A.buttons[0].triggeredActions&&A.buttons[0].triggeredActions()),v==et.Cancel&&A.buttons&&A.buttons.length>=2&&("number"==typeof A.buttons[1].goToDialog?this.activeTextId=A.buttons[1].goToDialog:this.activeTextId=z(this.NPCScript,A.buttons[1].goToDialog),A.buttons[1].triggeredActions&&A.buttons[1].triggeredActions()),v==et.Button3&&A.buttons&&A.buttons.length>=3&&("number"==typeof A.buttons[2].goToDialog?this.activeTextId=A.buttons[2].goToDialog:this.activeTextId=z(this.NPCScript,A.buttons[2].goToDialog),A.buttons[2].triggeredActions&&A.buttons[2].triggeredActions()),v==et.Button4&&A.buttons&&A.buttons.length>=4&&("number"==typeof A.buttons[3].goToDialog?this.activeTextId=A.buttons[3].goToDialog:this.activeTextId=z(this.NPCScript,A.buttons[3].goToDialog),A.buttons[3].triggeredActions&&A.buttons[3].triggeredActions()),A=this.NPCScript[this.activeTextId],Tt._instance.newText(this,A.text,this.activeTextId,A.typeSpeed?A.typeSpeed:void 0)},e.prototype.layoutDialogWindow=function(v){var A=this,E=this.NPCScript[v]?this.NPCScript[v]:{text:""},R=E.offsetY?E.offsetY*st+pt:pt;if(E.buttons&&E.buttons.length>=3?R+=37.5:E.buttons&&E.buttons.length>=1&&(R+=18),this.text.fontSize=E.fontSize?E.fontSize*st:18,this.text.positionY=R,E.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(E.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce()),E.portrait?(this.portrait.source=new Texture(E.portrait.path),this.portrait.positionX=E.portrait.offsetX?E.portrait.offsetX*st+at:at,this.portrait.positionY=E.portrait.offsetY?E.portrait.offsetY*st+0:0,this.portrait.width=E.portrait.width?E.portrait.width*st:lt,this.portrait.height=E.portrait.height?E.portrait.height*st:lt,E.portrait.section&&C(this.portrait,E.portrait.section),this.portrait.visible=!0):this.defaultPortrait?(this.portrait.source=new Texture(this.defaultPortrait.path),this.portrait.positionX=this.defaultPortrait&&this.defaultPortrait.offsetX?this.defaultPortrait.offsetX*st+at:at,this.portrait.positionY=this.defaultPortrait&&this.defaultPortrait.offsetY?this.defaultPortrait.offsetY*st+0:0,this.portrait.width=this.defaultPortrait&&this.defaultPortrait.width?this.defaultPortrait.width*st:lt,this.portrait.height=this.defaultPortrait&&this.defaultPortrait.height?this.defaultPortrait.height*st:lt,this.defaultPortrait.section&&C(this.portrait,this.defaultPortrait.section),this.portrait.visible=!0):(log("No portrait"),this.portrait.visible=!1),this.image.visible=!1,E.image){var O=E.image;log("setting image to ",O.path),this.image.source=new Texture(O.path),this.image.positionX=O.offsetX?O.offsetX*st+ht:ht,this.image.positionY=O.offsetY?O.offsetY*st+ct:ct,this.image.width=E.image.width?E.image.width*st:ut,this.image.height=E.image.height?E.image.height*st:ut,O.section&&C(this.image,O.section),this.image.visible=!0}else this.image.visible=!1;this.isQuestionPanel=!!E.isQuestion&&E.isQuestion,this.isFixedScreen=!!E.isFixedScreen&&E.isFixedScreen,this.button1.hide(),this.button2.hide(),this.button3.hide(),this.button4.hide(),this.leftClickIcon.visible=!1,E.isQuestion?(this.skipButton.hide(),E.buttons&&E.buttons.length>=1&&this.button1.update(E.buttons[0].label,E.buttons[0].offsetX?E.buttons[0].offsetX*st+dt:dt,E.buttons.length>=3?E.buttons[0].offsetY?E.buttons[0].offsetY*st-15:-15:E.buttons[0].offsetY?E.buttons[0].offsetY*st+ft:ft),E.buttons&&E.buttons.length>=2&&this.button2.update(E.buttons[1].label,E.buttons[1].offsetX*st?E.buttons[1].offsetX*st-60:-60,E.buttons.length>=3?E.buttons[1].offsetY*st?E.buttons[1].offsetY*st-15:-15:E.buttons[1].offsetY*st?E.buttons[1].offsetY*st+yt:yt),E.buttons&&E.buttons.length>=3&&this.button3.update(E.buttons[2].label,E.buttons[2].offsetX*st?E.buttons[2].offsetX*st-60:-60,E.buttons[2].offsetY*st?E.buttons[2].offsetY*st-60:-60),E.buttons&&E.buttons.length>=4&&this.button4.update(E.buttons[3].label,E.buttons[3].offsetX*st?E.buttons[3].offsetX*st+gt:gt,E.buttons[3].offsetY*st?E.buttons[3].offsetY*st-60:-60),St.addComponentOrReplace(new nt(.7,(function(){E.buttons&&E.buttons.length>=1&&A.button1.show(),E.buttons&&E.buttons.length>=2&&A.button2.show(),E.buttons&&E.buttons.length>=3&&A.button3.show(),E.buttons&&E.buttons.length>=4&&A.button4.show()})))):this.isFixedScreen||(this.leftClickIcon.visible=!0,E.skipable?this.skipButton.show():this.skipButton.hide())},e.prototype.closeDialogWindow=function(){this.isDialogOpen&&(this.isDialogOpen=!1,this.portrait.visible=!1,this.text.value="",this.text.visible=!1,this.button1.hide(),this.button2.hide(),this.button3.hide(),this.button4.hide(),this.skipButton.hide(),this.leftClickIcon.visible=!1,this.container.visible=!1)},e.prototype.skipDialogs=function(){if(this.isDialogOpen&&!(+Date.now()-this.UIOpenTime<100)){for(;this.NPCScript[this.activeTextId]&&this.NPCScript[this.activeTextId].skipable&&!this.NPCScript[this.activeTextId].isQuestion;){if(this.NPCScript[this.activeTextId].triggeredByNext&&this.NPCScript[this.activeTextId].triggeredByNext(),this.NPCScript[this.activeTextId].skipable&&this.NPCScript[this.activeTextId].isEndOfDialog)return void this.closeDialogWindow();this.activeTextId+=1}this.confirmText(et.Next)}},e}(),Tt=function(){function t(){this.timer=0,this.speed=45,this.visibleChars=0,this.fullText="",this.UIText=null,this.done=!0,t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(v){if(!this.done&&(this.timer+=v,this.timer>=2/this.speed)){var A=Math.floor(this.timer/(1/this.speed));this.timer=0,this.visibleChars+=A,this.closeTag(A),this.visibleChars>=this.fullText.length&&(this.done=!0,this.visibleChars=this.fullText.length),this.UIText&&(this.UIText.value=this.fullText.substr(0,this.visibleChars))}},t.prototype.newText=function(v,A,E,R){this.timer=0,this.done=!1,this.UIText=v.text,this.fullText=A,this.visibleChars=0,R&&R<=0?this.rush():this.speed=R||45,v.layoutDialogWindow(E)},t.prototype.rush=function(){this.done=!0,this.timer=0,this.visibleChars=this.fullText.length,this.UIText&&(this.UIText.value=this.fullText)},t.prototype.closeTag=function(v){if(0!=this.visibleChars&&0!=v){for(var A=!1,E=!1,R=this.visibleChars-v;R<this.visibleChars;R++)A?">"==this.fullText.substr(R,1)&&(E=!0):"<"==this.fullText.substr(R,1)&&(A=!0);if(A&&!E)for(;this.visibleChars<this.fullText.length&&">"!=this.fullText.substr(this.visibleChars-1,1);)this.visibleChars+=1}},t._instance=null,t}(),xt=function(A){function o(E,R,O,M,V,W,H,Z){var J=A.call(this)||this;if(J.icon=null,J.image=new UIImage(E,R),J.image.positionX=M,J.image.positionY=V,J.image.width=130.5,J.image.height=34.5,J.label=new UIText(J.image),J.style=Z||null,J.onClick=W,J.style)switch(J.style){case v.ButtonStyles.E:C(J.image,it.buttons.buttonE),J.label.positionX=18.75,J.icon=new UIImage(J.image,1==H?$:K),J.icon.width=bt,J.icon.height=vt,J.icon.hAlign="center",J.icon.vAlign="center",J.icon.isPointerBlocker=!1,C(J.icon,it.buttonLabels.E),J.icon.positionX=y(O.length);break;case v.ButtonStyles.F:C(J.image,it.buttons.buttonF),J.label.positionX=18.75,J.icon=new UIImage(J.image,1==H?$:K),J.icon.width=bt,J.icon.height=vt,J.icon.hAlign="center",J.icon.vAlign="center",J.icon.isPointerBlocker=!1,C(J.icon,it.buttonLabels.F),J.icon.positionX=y(O.length);break;case v.ButtonStyles.WHITE:C(J.image,it.buttons.white),J.label.positionX=18.75,J.icon=new UIImage(J.image,1==H?$:K),J.icon.width=bt,J.icon.height=vt,J.icon.hAlign="center",J.icon.vAlign="center",J.icon.isPointerBlocker=!1,C(J.icon,it.buttonLabels.FBlack),J.icon.positionX=y(O.length);break;case v.ButtonStyles.RED:C(J.image,it.buttons.buttonRed);break;case v.ButtonStyles.DARK:C(J.image,it.buttons.buttonDark);break;case v.ButtonStyles.ROUNDBLACK:C(J.image,it.buttons.roundBlack);break;case v.ButtonStyles.ROUNDWHITE:C(J.image,it.buttons.roundWhite);break;case v.ButtonStyles.ROUNDSILVER:C(J.image,it.buttons.roundSilver);break;case v.ButtonStyles.ROUNDGOLD:C(J.image,it.buttons.roundGold);break;case v.ButtonStyles.SQUAREBLACK:C(J.image,it.buttons.squareBlack);break;case v.ButtonStyles.SQUAREWHITE:C(J.image,it.buttons.squareWhite);break;case v.ButtonStyles.SQUARESILVER:C(J.image,it.buttons.squareSilver);break;case v.ButtonStyles.SQUAREGOLD:C(J.image,it.buttons.squareGold)}else C(J.image,it.buttons.roundSilver);return J.label.value=O,J.label.hTextAlign="center",J.label.vTextAlign="center",J.label.fontSize=15,J.label.font=X,J.label.color=Z==v.ButtonStyles.ROUNDWHITE||Z==v.ButtonStyles.SQUAREWHITE||Z==v.ButtonStyles.WHITE?Color4.Black():Color4.White(),J.label.isPointerBlocker=!1,J.image.onClick=new OnClick((function(){J.onClick()})),Z==v.ButtonStyles.E?Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){J.image.visible&&J.onClick()})):Z==v.ButtonStyles.F&&Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,(function(v){J.image.visible&&J.onClick()})),J}return i(o,A),o.prototype.hide=function(){this.image.visible=!1},o.prototype.show=function(){this.image.visible=!0},o.prototype.grayOut=function(){this.label.color=Color4.Gray(),this.image.isPointerBlocker=!1},o.prototype.enable=function(){this.label.color=Color4.White(),this.image.isPointerBlocker=!0},o.prototype.update=function(A,E,R){this.label.value=A,this.image.positionX=E,this.image.positionY=R,!this.icon||this.style!=v.ButtonStyles.E&&this.style!=v.ButtonStyles.F||(this.icon.positionX=y(A.length))},o}(Entity),St=new Entity;function z(v,A){for(var E=0;E<v.length;E++)if(v[E].name&&v[E].name==A)return E;return 0}engine.addEntity(St);var Ct=function(){function t(){this._triggers={},t._instance=this,this._cameraTriggerWrapper=new _t(new j(new Vector3(.5,1.8,.5),new Vector3(0,.91,0))),this._componentGroup=engine.getComponentGroup(It)}return Object.defineProperty(t,"instance",{get:function(){return this.createAndAddToEngine()},enumerable:!1,configurable:!0}),t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.setCameraTriggerShape=function(v){this._cameraTriggerWrapper.setShape(v)},t.prototype.update=function(){var v=this,A=this._componentGroup.entities;for(var E in A.forEach((function(A){v.shouldWrapTriggerEntity(A)&&v.wrapTriggerEntity(A)})),this._triggers)if(this._triggers.hasOwnProperty(E)){var R=this._triggers[E];R.isDebugging()&&R.updateDebugEntity(),R.isInEngine()?null!=R.trigger&&R.trigger.enabled?(R.wasEnabled||R.isDebugging()&&R.addDebugEntity(),R.wasEnabled=!0,(R.trigger.onCameraEnter||R.trigger.onCameraExit)&&this.checkCollisionAgainstCamera(R),(R.trigger.onTriggerEnter||R.trigger.onTriggerExit)&&this.checkCollisionAgainstOtherTriggers(R)):R.wasEnabled&&(R.wasEnabled=!1,R.isDebugging()&&R.removeDebugEntity(),t.removeTriggerFromSystem(R)):(R.isDebugging()&&R.removeDebugEntity(),t.removeTriggerFromSystem(R),delete this._triggers[E])}},t.prototype.shouldWrapTriggerEntity=function(v){return null==this._triggers[v.uuid]||null==this._triggers[v.uuid]},t.prototype.wrapTriggerEntity=function(v){this._triggers[v.uuid]=new At(v)},t.removeTriggerFromSystem=function(v){for(var A,E=v.getActiveCollisions(),R=0;R<E.length;R++)!(E[R]===(null===(A=t._instance)||void 0===A?void 0:A._cameraTriggerWrapper)||null==E[R].trigger)&&E[R].trigger.onTriggerExit&&v.entity&&E[R].trigger.onTriggerExit(v.entity),E[R].disengageActiveCollision(v),v.disengageActiveCollision(E[R])},t.disengageCollision=function(v,A){v.disengageActiveCollision(A),A.disengageActiveCollision(v),v.trigger.onTriggerExit&&A.entity&&v.trigger.onTriggerExit(A.entity),A.trigger.onTriggerExit&&v.entity&&A.trigger.onTriggerExit(v.entity)},t.engageCollision=function(v,A){v.engageCollision(A),A.engageCollision(v),v.trigger.onTriggerEnter&&A.entity&&v.trigger.onTriggerEnter(A.entity),A.trigger.onTriggerEnter&&v.entity&&A.trigger.onTriggerEnter(v.entity)},t.prototype.checkCollisionAgainstCamera=function(v){var A=v.hasActiveCollision(this._cameraTriggerWrapper),E=t.areColliding(v,this._cameraTriggerWrapper);A&&!E?(v.disengageActiveCollision(this._cameraTriggerWrapper),v.trigger.onCameraExit&&v.trigger.onCameraExit()):!A&&E&&(v.engageCollision(this._cameraTriggerWrapper),v.trigger.onCameraEnter&&v.trigger.onCameraEnter())},t.prototype.checkCollisionAgainstOtherTriggers=function(v){for(var A in this._triggers)if(this._triggers.hasOwnProperty(A)&&A!=v.uuid&&this._triggers[A].trigger.enabled&&t.canTriggersCollide(v,this._triggers[A])){var E=v.hasActiveCollision(this._triggers[A]),R=t.areColliding(v,this._triggers[A]);E&&!R?t.disengageCollision(v,this._triggers[A]):!E&&R&&t.engageCollision(v,this._triggers[A])}},t.canTriggersCollide=function(v,A){return 0==v.trigger.triggeredByLayer||0!=(A.trigger.layer&v.trigger.triggeredByLayer)},t.areColliding=function(v,A){return v.getShape()instanceof j&&A.getShape()instanceof j?t.areCollidingAABB(v.getGlobalPosition(),v.getShape(),A.getGlobalPosition(),A.getShape()):v.getShape()instanceof q&&A.getShape()instanceof q?t.areCollidingSphere(v.getGlobalPosition(),v.getShape(),A.getGlobalPosition(),A.getShape()):v.getShape()instanceof j&&A.getShape()instanceof q?t.areCollidingAABBSphere(v.getGlobalPosition(),v.getShape(),A.getGlobalPosition(),A.getShape()):v.getShape()instanceof q&&A.getShape()instanceof j&&t.areCollidingAABBSphere(A.getGlobalPosition(),A.getShape(),v.getGlobalPosition(),v.getShape())},t.areCollidingAABB=function(v,A,E,R){var O=t.getBoxShapeValues(v,A),M=t.getBoxShapeValues(E,R);return O.min.x<=M.max.x&&O.max.x>=M.min.x&&O.min.y<=M.max.y&&O.max.y>=M.min.y&&O.min.z<=M.max.z&&O.max.z>=M.min.z},t.areCollidingSphere=function(v,A,E,R){return Vector3.DistanceSquared(v.add(A.position),E.add(R.position))<A.radius*A.radius+R.radius*R.radius},t.areCollidingAABBSphere=function(v,A,E,R){var O=t.getBoxShapeValues(v,A),M=E.add(R.position),V=R.radius,W=0;return M.x<O.min.x&&(W+=(O.min.x-M.x)*(O.min.x-M.x)),M.x>O.max.x&&(W+=(M.x-O.max.x)*(M.x-O.max.x)),M.y<O.min.y&&(W+=(O.min.y-M.y)*(O.min.y-M.y)),M.y>O.max.y&&(W+=(M.y-O.max.y)*(M.y-O.max.y)),M.z<O.min.z&&(W+=(O.min.z-M.z)*(O.min.z-M.z)),M.z>O.max.z&&(W+=(M.z-O.max.z)*(M.z-O.max.z)),W<V*V},t.getBoxShapeValues=function(v,A){var E=v.add(A.position);return{center:E,min:E.subtract(A.size.scale(.5)),max:E.add(A.size.scale(.5))}},t._instance=null,t}(),At=function(){function t(v){this.wasEnabled=!0,this._uuid="",this._collidingWith={},this._isDebug=!1,this._debugEntity=null,this._entity=v,v&&(this._trigger=v.getComponent(It),this._uuid=v.uuid,this._isDebug=this._trigger.debugEnabled,this._isDebug&&this.addDebugEntity())}return Object.defineProperty(t.prototype,"entity",{get:function(){return this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trigger",{get:function(){return this._trigger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),t.prototype.getGlobalPosition=function(){return this._entity?t.getEntityWorldPosition(this._entity):Vector3.Zero()},t.prototype.getShape=function(){return this._trigger.shape},t.prototype.isInEngine=function(){return null!=this._entity&&this._entity.isAddedToEngine()},t.prototype.getActiveCollisions=function(){var v=[];for(var A in this._collidingWith)this._collidingWith.hasOwnProperty(A)&&v.push(this._collidingWith[A]);return v},t.prototype.hasActiveCollision=function(v){return null!=this._collidingWith[v.uuid]&&null!=this._collidingWith[v.uuid]},t.prototype.disengageActiveCollision=function(v){delete this._collidingWith[v.uuid]},t.prototype.engageCollision=function(v){this._collidingWith[v.uuid]=v},t.prototype.isDebugging=function(){return this._isDebug},t.prototype.addDebugEntity=function(){if(t._debugMaterial||(t._debugMaterial=new Material,t._debugMaterial.alphaTest=.5),null==this._debugEntity){this._debugEntity=new Entity;var v=new Transform;if(this._debugEntity.addComponent(v),this._debugEntity.addComponent(t._debugMaterial),this.getShape()instanceof j&&((A=new BoxShape).withCollisions=!1,this._debugEntity.addComponent(A),v.scale=this.getShape().size),this.getShape()instanceof q){var A;(A=new SphereShape).withCollisions=!1,this._debugEntity.addComponent(A);var E=this.getShape().radius;v.scale=new Vector3(E,E,E)}}engine.addEntity(this._debugEntity)},t.prototype.removeDebugEntity=function(){null!=this._debugEntity&&engine.removeEntity(this._debugEntity)},t.prototype.updateDebugEntity=function(){this._debugEntity&&(this._debugEntity.getComponent(Transform).position=this.getGlobalPosition().add(this.getShape().position))},t.getEntityWorldPosition=function(v){var A=v.hasComponent(Transform)?v.getComponent(Transform).position.clone():Vector3.Zero(),E=v.getParent();if(null!=E){var R=E.hasComponent(Transform)?E.getComponent(Transform).rotation:Quaternion.Identity;return this.getEntityWorldPosition(E).add(A.rotate(R))}return A},t._debugMaterial=null,t}(),_t=function(v){function e(A){var E=v.call(this)||this;return E._shape=A,E._uuid="cameraTrigger",E}return i(e,v),e.prototype.getGlobalPosition=function(){return Camera.instance.position},e.prototype.getShape=function(){return this._shape},e.prototype.setShape=function(v){this._shape=v},e.prototype.isInEngine=function(){return!1},e.prototype.hasActiveCollision=function(v){return!1},e.prototype.disengageActiveCollision=function(v){},e.prototype.engageCollision=function(v){},e.prototype.isDebugging=function(){return!1},e}(At),It=function(){function t(v,A){this.enabled=!0,this.layer=0,this.triggeredByLayer=0,Ct.createAndAddToEngine(),this.shape=v,this.layer=A&&A.layer?A.layer:0,this.triggeredByLayer=A&&A.triggeredByLayer?A.triggeredByLayer:0,this.onTriggerEnter=A&&A.onTriggerEnter?A.onTriggerEnter:void 0,this.onTriggerExit=A&&A.onTriggerExit?A.onTriggerExit:void 0,this.onCameraEnter=A&&A.onCameraEnter?A.onCameraEnter:void 0,this.onCameraExit=A&&A.onCameraExit?A.onCameraExit:void 0,this._debugEnabled=!(!A||!A.enableDebug)&&A.enableDebug}return Object.defineProperty(t.prototype,"debugEnabled",{get:function(){return this._debugEnabled},enumerable:!1,configurable:!0}),o([Component("npcTriggerComponent")],t)}(),j=function(v,A){this.size=v,this.position=A},q=function(v,A){this.radius=v,this.position=A},Pt=function(){function e(A,E){void 0===E&&(E=v.NPCLerpType.SMOOTH_PATH),this.origin=0,this.target=1,this.fraction=0,this.totalDuration=0,this.speed=[],this.loop=!1,this.type=v.NPCLerpType.SMOOTH_PATH,this.path=A,void 0!==E&&(this.type=E),Ot.createAndAddToEngine()}return e.prototype.setIndex=function(v){this.fraction=0,this.origin=v,this.target=v+1<this.path.length?v+1:0},o([Component("npclerpData")],e)}(),Rt=engine.getComponentGroup(Pt),Ot=function(){function e(){e._instance=this}return e.prototype.update=function(A){var E,R;try{for(var O=n(Rt.entities),M=O.next();!M.done;M=O.next()){var V=M.value;if(V.state==v.NPCState.FOLLOWPATH){var W=V.getComponent(Transform),H=V.getComponent(Pt);if(void 0!==H.type&&H.type==v.NPCLerpType.RIGID_PATH)if(H.fraction<1)H.fraction+=A*H.speed[H.origin],W.position=Vector3.Lerp(H.path[H.origin],H.path[H.target],H.fraction);else{if(H.origin=H.target,H.target+=1,H.target>=H.path.length){if(!H.loop)return V.stopWalking(),H.onFinishCallback&&H.onFinishCallback(),void(H.fraction=1);H.target=0}else H.onReachedPointCallback&&H.onReachedPointCallback();H.fraction=0,W.lookAt(H.path[H.target])}else if(H.fraction+=A*H.speed[H.origin],H.fraction>=1){H.origin=H.target;var X=Math.max(1,Math.floor(H.fraction));if(H.target+=X,H.target>=H.path.length){if(!H.loop)return V.stopWalking(),H.onFinishCallback&&H.onFinishCallback(),void(H.fraction=1);H.target=0}else H.onReachedPointCallback&&H.onReachedPointCallback();H.fraction-=X,H.target<H.path.length&&W.lookAt(H.path[H.target])}H.target<H.path.length&&(W.position=Vector3.Lerp(H.path[H.origin],H.path[H.target],H.fraction))}}}catch(v){E={error:v}}finally{try{M&&!M.done&&(R=O.return)&&R.call(O)}finally{if(E)throw E.error}}},e.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new e,engine.addSystem(this._instance)),this._instance},e._instance=null,e}(),kt=100,Lt=function(){function t(v,A,E){this.NPCScript=[],this.isBubleOpen=!1,this.activeTextId=0,this.defaultSound=null,this.baseYOffset=2.5,this.baseYOffset=A||2.5,this.rootEntity=new Entity,this.rootEntity.addComponent(new Billboard(!1,!0,!1)),this.rootEntity.addComponent(new Transform),this.rootEntity.setParent(v),this.container=new Entity,this.container.addComponent(new Transform({position:new Vector3(-.1,this.baseYOffset,0)})),this.container.setParent(this.rootEntity),this.material=new BasicMaterial,this.material.texture=J,this.panel=new Entity,this.panel.addComponent(new Transform({scale:new Vector3(2,1,1)})),this.panel.setParent(this.container),this.panel.addComponent(new PlaneShape),this.panel.addComponent(this.material),this.panel.getComponent(PlaneShape).visible=!1,T(this.panel.getComponent(PlaneShape),it.bubbles.normal,1024,1024),this.text=new Entity,this.text.addComponent(new Transform({position:new Vector3(0,0,.05),rotation:Quaternion.Euler(0,180,0)})),this.text.addComponent(new TextShape("")),this.text.setParent(this.container),this.text.getComponent(TextShape).textWrapping=!0,this.text.getComponent(TextShape).font=Z,this.text.getComponent(TextShape).hTextAlign="center",this.text.getComponent(TextShape).vTextAlign="center",this.text.getComponent(TextShape).fontSize=1,this.text.getComponent(TextShape).color=Color3.Black(),this.text.getComponent(TextShape).visible=!1,this.soundEnt=new Entity,E&&(this.soundEnt.addComponent(new Transform),engine.addEntity(this.soundEnt),this.soundEnt.setParent(this.container),this.soundEnt.addComponent(new AudioSource(new AudioClip(E))),this.soundEnt.getComponent(AudioSource).volume=.5,this.defaultSound=E),Nt.createAndAddToEngine()}return t.prototype.openDialogWindow=function(v,A){this.NPCScript=v,this.activeTextId=A?"number"==typeof A?A:function(v,A){for(var E=0;E<v.length;E++)if(v[E].name&&v[E].name==A)return E;return 0}(v,A):0;var E=v[this.activeTextId]?v[this.activeTextId]:{text:""};E.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(E.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce()),this.text.getComponent(TextShape).fontSize=E.fontSize?E.fontSize:1,this.text.getComponent(Transform).position.y=E.offsetY?E.offsetY+0:0,this.text.getComponent(Transform).position.x=E.offsetX?E.offsetX:0,this.text.getComponent(TextShape).visible=!0,this.panel.getComponent(PlaneShape).visible=!0,this.text.getComponent(TextShape).value="",E.text.length<kt&&E.text.slice(0,kt),Nt._instance.newText(this,E.text,this.activeTextId,E.timeOn?E.timeOn:void 0,E.typeSpeed?E.typeSpeed:void 0),this.adjustBubble(E.text.length),this.layoutDialogWindow(this.activeTextId),this.isBubleOpen=!0},t.prototype.adjustBubble=function(v){v<8?(T(this.panel.getComponent(PlaneShape),it.bubbles.short,1024,1024),this.panel.getComponent(Transform).scale.x=.58,this.panel.getComponent(Transform).scale.y=.42,this.container.getComponent(Transform).position.x=-.1,this.container.getComponent(Transform).position.y=this.baseYOffset+-.2,this.text.getComponent(TextShape).width=.7):v<25?(T(this.panel.getComponent(PlaneShape),it.bubbles.normal,1024,1024),this.panel.getComponent(Transform).scale.x=1.43,this.panel.getComponent(Transform).scale.y=.42,this.container.getComponent(Transform).position.x=-.5,this.container.getComponent(Transform).position.y=this.baseYOffset+-.2,this.text.getComponent(TextShape).width=1.5):v<50?(T(this.panel.getComponent(PlaneShape),it.bubbles.long,1024,1024),this.panel.getComponent(Transform).scale.x=2.485,this.panel.getComponent(Transform).scale.y=.765,this.container.getComponent(Transform).position.y=this.baseYOffset+0,this.container.getComponent(Transform).position.x=-.8,this.text.getComponent(TextShape).width=2):(T(this.panel.getComponent(PlaneShape),it.bubbles.huge,1024,1024),this.panel.getComponent(Transform).scale.x=2.485,this.panel.getComponent(Transform).scale.y=1.195,this.container.getComponent(Transform).position.y=this.baseYOffset+.2,this.container.getComponent(Transform).position.x=-.8,this.text.getComponent(TextShape).width=2)},t.prototype.next=function(){var v=this.NPCScript[this.activeTextId];v||(v=this.NPCScript[this.activeTextId-1]),v.triggeredByNext&&v.triggeredByNext(),v.isEndOfDialog?this.closeDialogWindow():(this.activeTextId++,(v=this.NPCScript[this.activeTextId]).text.length<kt&&v.text.slice(0,kt),this.text.getComponent(TextShape).value="",this.adjustBubble(v.text.length),Nt._instance.newText(this,v.text,this.activeTextId,v.timeOn?v.timeOn:void 0,v.typeSpeed?v.typeSpeed:void 0),this.layoutDialogWindow(this.activeTextId))},t.prototype.layoutDialogWindow=function(v){var A=this.NPCScript[v]?this.NPCScript[v]:{text:""},E=A.offsetY?A.offsetY+0:0;A.buttons&&A.buttons.length>=3?E+=50:A.buttons&&A.buttons.length>=1&&(E+=24),this.text.getComponent(TextShape).fontSize=A.fontSize?A.fontSize:1,this.text.getComponent(TextShape).visible=!0,this.text.getComponent(Transform).position.y=E,A.audio?(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(A.audio))),this.soundEnt.getComponent(AudioSource).volume=.5,this.soundEnt.getComponent(AudioSource).playOnce()):this.defaultSound&&(this.soundEnt.addComponentOrReplace(new AudioSource(new AudioClip(this.defaultSound))),this.soundEnt.getComponent(AudioSource).playOnce())},t.prototype.closeDialogWindow=function(){this.isBubleOpen&&(this.isBubleOpen=!1,this.text.getComponent(TextShape).value="",this.text.getComponent(TextShape).visible=!1,this.panel.getComponent(PlaneShape).visible=!1)},t.prototype.closeDialogEndAll=function(){this.isBubleOpen&&(Nt._instance.Dialog==this&&(Nt._instance.done=!0,Nt._instance.Dialog=null),this.isBubleOpen=!1,this.text.getComponent(TextShape).value="",this.text.getComponent(TextShape).visible=!1,this.panel.getComponent(PlaneShape).visible=!1)},t.prototype.skipDialogs=function(){if(this.isBubleOpen)for(;this.NPCScript[this.activeTextId];){if(this.NPCScript[this.activeTextId].triggeredByNext&&this.NPCScript[this.activeTextId].triggeredByNext(),this.NPCScript[this.activeTextId].isEndOfDialog)return void this.closeDialogWindow();this.activeTextId+=1}},t}(),Nt=function(){function t(){this.timer=0,this.speed=45,this.visibleChars=0,this.fullText="",this.Text=null,this.textId=0,this.done=!0,this.showing=!1,this.timeOn=3,t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(v){if(!this.done)if(this.timer+=v,this.showing)this.timer>this.timeOn&&(this.showing=!1,this.done=!0,this.timer=0,this.window.next());else if(this.timer>=2/this.speed){var A=Math.floor(this.timer/(1/this.speed));this.timer=0,this.visibleChars+=A,this.closeTag(A),this.visibleChars>=this.fullText.length&&(this.showing=!0,this.timer=0,this.visibleChars=this.fullText.length),this.Text&&(this.Text.value=this.fullText.substr(0,this.visibleChars))}},t.prototype.newText=function(v,A,E,R,O){if(v!=this.Dialog||E!=this.textId){var M=this.Dialog;this.Dialog=v,this.Text=this.Dialog.text.getComponent(TextShape),this.textId=E,M&&v!=M&&M.skipDialogs(),this.timer=0,this.done=!1,this.showing=!1,this.fullText=A,this.visibleChars=0,this.window=v,O&&O<=0?this.rush():this.speed=O||45,this.timeOn=R||3}},t.prototype.rush=function(){this.showing=!0,this.timer=0,this.visibleChars=this.fullText.length,this.Text&&(this.Text.value=this.fullText)},t.prototype.closeTag=function(v){if(0!=this.visibleChars&&0!=v){for(var A=!1,E=!1,R=this.visibleChars-v;R<this.visibleChars;R++)A?">"==this.fullText.substr(R,1)&&(E=!0):"<"==this.fullText.substr(R,1)&&(A=!0);if(A&&!E)for(;this.visibleChars<this.fullText.length&&">"!=this.fullText.substr(this.visibleChars-1,1);)this.visibleChars+=1}},t._instance=null,t}(),zt=function(E){function o(R,O,M,V){var W=E.call(this)||this;W.introduced=!1,W.onWalkAway=null,W.inCooldown=!1,W.coolDownDuration=5,W.faceUser=!1,W.walkingAnim=null,W.walkingSpeed=2,W.bubbleHeight=2,W.addComponent(new GLTFShape(O)),W.addComponent(new Transform(R)),engine.addEntity(W),W.state=v.NPCState.STANDING,V&&V.noUI||(V&&V.portrait?W.dialog=new wt("string"==typeof V.portrait?{path:V.portrait}:V.portrait,!(!V||!V.darkUI)&&V.darkUI,V.dialogSound?V.dialogSound:void 0,V&&V.dialogCustomTheme?V.dialogCustomTheme:void 0):W.dialog=new wt(void 0,!(!V||!V.darkUI)&&V.darkUI,V&&V.dialogSound?V.dialogSound:void 0,V&&V.dialogCustomTheme?V.dialogCustomTheme:void 0)),V&&V.textBubble&&(V&&V.bubbleHeight&&(W.bubbleHeight=V.bubbleHeight),W.bubble=new Lt(W,W.bubbleHeight,V.dialogSound?V.dialogSound:void 0)),W.addComponent(new Animator),W.idleAnim=new AnimationState(V&&V.idleAnim?V.idleAnim:"Idle",{looping:!0}),W.getComponent(Animator).addClip(W.idleAnim),W.lastPlayedAnim=W.idleAnim,W.idleAnim.play(),V&&V.walkingAnim&&(W.walkingAnim=new AnimationState(V.walkingAnim,{looping:!0}),W.getComponent(Animator).addClip(W.walkingAnim)),W.onActivate=M,V&&V.onWalkAway&&(W.onWalkAway=V.onWalkAway),W.endAnimTimer=new Entity,engine.addEntity(W.endAnimTimer),W.closeDialogTimer=new Entity,engine.addEntity(W.closeDialogTimer),W.pauseWalkingTimer=new Entity,engine.addEntity(W.pauseWalkingTimer);var H=V&&V.onlyClickTrigger?ActionButton.POINTER:ActionButton.PRIMARY;W.addComponent(new OnPointerDown((function(v){W.inCooldown||W.dialog&&W.dialog.isDialogOpen||W.activate()}),{button:H,hoverText:V&&V.hoverText?V.hoverText:"Talk",showFeedback:!V||!V.onlyExternalTrigger})),V&&V.onlyExternalTrigger&&W.removeComponent(OnPointerDown);var X={};return(!V||V&&!V.continueOnWalkAway)&&(X.onCameraExit=function(){W.handleWalkAway()}),V&&(!V||V.onlyExternalTrigger||V.onlyClickTrigger||V.onlyETrigger)||(X.onCameraEnter=function(){W.inCooldown?log(W.name," in cooldown"):W.dialog&&W.dialog.isDialogOpen||V&&V.onlyExternalTrigger||V&&V.onlyClickTrigger||W.activate()}),(X.onCameraEnter||X.onCameraExit)&&W.addComponent(new It(new q(V&&V.reactDistance?V.reactDistance:6,Vector3.Zero()),X)),V&&V.faceUser&&(W.addComponent(new A(!0,V.turningSpeed?V.turningSpeed:void 0)),W.faceUser=!0),V&&V.walkingSpeed&&(W.walkingSpeed=V.walkingSpeed),V&&V.coolDownDuration&&(W.coolDownDuration=V.coolDownDuration),V&&V.path&&(W.addComponent(new Pt(V.path?V.path:[],V.pathLerpType)),W.getComponent(Pt).loop=!0,W.followPath()),W}return i(o,E),o.prototype.activate=function(){var v=this;this.faceUser&&(this.getComponent(A).active=!0),this.inCooldown=!0,this.addComponentOrReplace(new nt(this.coolDownDuration,(function(){v.inCooldown=!1}))),this.onActivate()},o.prototype.endInteraction=function(){this.faceUser&&(this.getComponent(A).active=!1),this.dialog&&this.dialog.isDialogOpen&&this.dialog.closeDialogWindow(),this.bubble&&this.bubble.isBubleOpen&&this.bubble.closeDialogWindow(),this.state=v.NPCState.STANDING},o.prototype.handleWalkAway=function(){this.state!=v.NPCState.FOLLOWPATH&&(this.endInteraction(),this.onWalkAway&&this.onWalkAway())},o.prototype.talk=function(A,E,R){var O=this;this.introduced=!0,this.state=v.NPCState.TALKING,this.closeDialogTimer.hasComponent(nt)&&this.closeDialogTimer.removeComponent(nt),this.bubble&&this.bubble.isBubleOpen&&this.bubble.closeDialogWindow(),this.dialog.openDialogWindow(A,E||0),R&&this.closeDialogTimer.addComponentOrReplace(new nt(R,(function(){O.dialog.closeDialogWindow()})))},o.prototype.talkBubble=function(v,A){this.bubble||(this.bubble=new Lt(this,this.bubbleHeight)),this.bubble.openDialogWindow(v,A||0)},o.prototype.playAnimation=function(v,A,E){var R=this;this.endAnimTimer.hasComponent(nt)&&this.endAnimTimer.removeComponent(nt);var O=this.getComponent(Animator).getClip(v);A&&(O.looping=!1,E&&this.endAnimTimer.addComponentOrReplace(new nt(E,(function(){O.stop(),R.idleAnim&&(R.idleAnim.play(),R.lastPlayedAnim=R.idleAnim)})))),O.play(!0),this.lastPlayedAnim=O},o.prototype.changeIdleAnim=function(v,A){this.idleAnim=new AnimationState(v,{looping:!0}),this.getComponent(Animator).addClip(this.idleAnim),A&&(this.idleAnim.play(),this.lastPlayedAnim=this.idleAnim)},o.prototype.followPath=function(E){if(!this.hasComponent(Pt)){if(!E)return;this.addComponent(new Pt(E.path?E.path:[],E.pathLerpType))}this.faceUser&&(this.getComponent(A).active=!1);var R=this.getComponent(Pt);if(E){if(E.path)if(E.curve){var O=Curve3.CreateCatmullRomSpline(E.path,4*E.path.length,!!E.loop).getPoints();E.loop&&O.pop(),R.path=O}else R.path=E.path;null!=E.loop&&(R.loop=E.loop),null!=E.startingPoint&&R.setIndex(E.startingPoint),E.onFinishCallback&&(R.onFinishCallback=E.onFinishCallback),E.onReachedPointCallback&&(R.onReachedPointCallback=E.onReachedPointCallback)}var M=this.getComponent(Transform),V=M.position,W=R.path[R.origin];void 0===W&&log("WARNING npc.utils lerpOriginPath is null",W,R.origin,R.target,R.path),(0==R.fraction&&W.subtract(V).lengthSquared()>.1||R.fraction>0&&V.subtract(W).normalize()==R.path[R.target].subtract(W).normalize())&&(R.path.splice(R.origin,0,V),R.fraction=0),void 0===R.path[R.target]&&log("npc.utils lerp.path[lerp.target] is null",W,R.origin,R.target,R.path),M.lookAt(R.path[R.target]);for(var H=0,X=[],Z=0;Z<R.path.length-1;Z++){var K;H+=K=Vector3.Distance(R.path[Z],R.path[Z+1]),X.push(K)}for(R.loop&&(H+=K=Vector3.Distance(R.path[R.path.length-1],R.path[0]),X.push(K)),E&&E.totalDuration?R.totalDuration=E.totalDuration:E&&E.speed?R.totalDuration=H/E.speed:R.totalDuration||(R.totalDuration=H/this.walkingSpeed),R.speed=[],Z=0;Z<X.length;Z++)R.speed.push(1/(X[Z]/H*R.totalDuration));this.walkingAnim&&(this.endAnimTimer.hasComponent(nt)&&this.endAnimTimer.removeComponent(nt),this.walkingAnim.play(),this.lastPlayedAnim=this.walkingAnim),this.state=v.NPCState.FOLLOWPATH},o.prototype.stopWalking=function(A){var E=this;this.state=v.NPCState.STANDING,this.walkingAnim&&(this.idleAnim.play(),this.lastPlayedAnim=this.idleAnim),A&&this.pauseWalkingTimer.addComponentOrReplace(new nt(A,(function(){E.dialog&&E.dialog.isDialogOpen||(E.lastPlayedAnim.stop(),E.walkingAnim&&(E.walkingAnim.play(),E.lastPlayedAnim=E.walkingAnim),E.endAnimTimer.hasComponent(nt)&&E.endAnimTimer.removeComponent(nt),E.state=v.NPCState.FOLLOWPATH)})))},o}(Entity);v.CustomDialogButton=xt,v.DialogTypeInSystem=Tt,v.DialogWindow=wt,v.NPC=zt,v.NPCDelay=nt,v.NPCLerpData=Pt,v.NPCTriggerComponent=It,v.SFFont=X,v.SFHeavyFont=Z,v.TrackUserFlag=A,v.TriggerBoxShape=j,v.TriggerSphereShape=q,v.canvas=M,v.darkTheme=$,v.lightTheme=K,Object.defineProperty(v,"__esModule",{value:!0})})),function(v,A){"object"==typeof exports&&"undefined"!=typeof module?A(exports):"function"==typeof define&&define.amd?define("@dcl/ui-scene-utils",["exports"],A):A((v="undefined"!=typeof globalThis?globalThis:v||self)["ui-utils"]={})}(this,(function(v){
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var e=function(v,A){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,A){v.__proto__=A}||function(v,A){for(var E in A)Object.prototype.hasOwnProperty.call(A,E)&&(v[E]=A[E])})(v,A)};function i(v,A){function o(){this.constructor=v}e(v,A),v.prototype=null===A?Object.create(A):(o.prototype=A.prototype,new o)}var o=function(){return(o=Object.assign||function(v){for(var A,E=1,R=arguments.length;E<R;E++)for(var O in A=arguments[E])Object.prototype.hasOwnProperty.call(A,O)&&(v[O]=A[O]);return v}).apply(this,arguments)};function n(v,A){var E={};for(var R in v)Object.prototype.hasOwnProperty.call(v,R)&&A.indexOf(R)<0&&(E[R]=v[R]);if(null!=v&&"function"==typeof Object.getOwnPropertySymbols){var O=0;for(R=Object.getOwnPropertySymbols(v);O<R.length;O++)A.indexOf(R[O])<0&&Object.prototype.propertyIsEnumerable.call(v,R[O])&&(E[R[O]]=v[R[O]])}return E}function r(v){var A="function"==typeof Symbol&&Symbol.iterator,E=A&&v[A],R=0;if(E)return E.call(v);if(v&&"number"==typeof v.length)return{next:function(){return v&&R>=v.length&&(v=void 0),{value:v&&v[R++],done:!v}}};throw new TypeError(A?"Object is not iterable.":"Symbol.iterator is not defined.")}var A=function(){function t(A,E){var O=this;R.createAndAddToEngine(),this.elapsedTime=0,this.targetTime=A,this.onTimeReachedCallback=E,this.onTargetTimeReached=function(A){O.onTimeReachedCallback(),A.removeComponent(v)}}var v;return v=t,t.prototype.setCallback=function(v){this.onTimeReachedCallback=v},v=function(v,A,E,R){var O,M=arguments.length,V=M<3?A:null===R?R=Object.getOwnPropertyDescriptor(A,E):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)V=Reflect.decorate(v,A,E,R);else for(var W=v.length-1;W>=0;W--)(O=v[W])&&(V=(M<3?O(V):M>3?O(A,E,V):O(A,E))||V);return M>3&&V&&Object.defineProperty(A,E,V),V}([Component("UItimerDelay")],t)}(),E=engine.getComponentGroup(A),R=function(){function t(){t._instance=this}return t.createAndAddToEngine=function(){return null==this._instance&&(this._instance=new t,engine.addSystem(this._instance)),this._instance},t.prototype.update=function(v){var R,O;try{for(var M=r(E.entities),V=M.next();!V.done;V=M.next()){var W=V.value,H=W.getComponent(A);H.elapsedTime+=v,H.elapsedTime>=H.targetTime&&H.onTargetTimeReached(W)}}catch(v){R={error:v}}finally{try{V&&!V.done&&(O=M.return)&&O.call(M)}finally{if(R)throw R.error}}},t._instance=null,t}(),O=new UICanvas;O.visible=!0;var M=new Font(Fonts.SanFrancisco),V=new Font(Fonts.SanFrancisco_Heavy),W=new Texture("https://decentraland.org/images/ui/light-atlas-v3.png"),H=new Texture("https://decentraland.org/images/ui/dark-atlas-v3.png"),X=new UIText(O);X.vAlign="center",X.hAlign="center",X.hTextAlign="center",X.vTextAlign="center",X.font=M,X.fontSize=60,X.color=new Color4(0,0,0,1),X.visible=!1,X.positionY=80;var Z=new UIImage(O,W);Z.hAlign="center",Z.vAlign="center",Z.width=400,Z.height=250,Z.visible=!1;var K,$,J,et,it=function(v){function e(A,E,R,V,W,H,X){var Z=v.call(this)||this;return Z.canvas=O,Z.valueAsNum=A,Z.uiText=new UIText(O),Z.fixedDigits=X||null,Z.uiText.value=Z.toFixedLengthString(A),Z.uiText.hAlign="right",Z.uiText.vAlign="bottom",Z.uiText.positionX=E||0,Z.uiText.positionY=R||0,Z.uiText.fontSize=W||25,Z.uiText.font=M,Z.uiText.vTextAlign="center",Z.uiText.hTextAlign="center",Z.uiText.color=V||Color4.White(),Z.uiText.outlineColor=Color4.Black(),Z.uiText.outlineWidth=H?0:.1,Z}return i(e,v),e.prototype.read=function(){return this.valueAsNum},e.prototype.increase=function(v){this.valueAsNum+=v||1,this.uiText.value=this.toFixedLengthString(this.valueAsNum)},e.prototype.decrease=function(v){this.valueAsNum-=v||1,this.uiText.value=this.toFixedLengthString(this.valueAsNum)},e.prototype.set=function(v){this.valueAsNum=v,this.uiText.value=this.toFixedLengthString(this.valueAsNum)},e.prototype.hide=function(){this.uiText.visible=!1},e.prototype.show=function(){this.uiText.visible=!0},e.prototype.toFixedLengthString=function(v){var A=v.toString();if(!this.fixedDigits)return A;for(var E=A.length-this.fixedDigits;E<0;)A="0".concat(A),E+=1;return E>0&&(A=v.toPrecision(this.fixedDigits)),A},e}(Entity);(K=v.PromptStyles||(v.PromptStyles={})).LIGHT="light",K.DARK="dark",K.LIGHTLARGE="lightlarge",K.DARKLARGE="darklarge",K.LIGHTSLANTED="lightslanted",K.DARKSLANTED="darkslanted",($=v.BarStyles||(v.BarStyles={})).ROUNDBLACK="roundblack",$.ROUNDWHITE="roundwhite",$.ROUNDSILVER="roundsilver",$.ROUNDGOLD="roundgold",$.SQUAREBLACK="squareblack",$.SQUAREWHITE="squarewhite",$.SQUARESILVER="squaresilver",$.SQUAREGOLD="squaregold",(J=v.ButtonStyles||(v.ButtonStyles={})).E="e",J.F="f",J.DARK="dark",J.RED="red",J.ROUNDBLACK="roundblack",J.ROUNDWHITE="roundwhite",J.ROUNDSILVER="roundsilver",J.ROUNDGOLD="roundgold",J.SQUAREBLACK="squareblack",J.SQUAREWHITE="squarewhite",J.SQUARESILVER="squaresilver",J.SQUAREGOLD="squaregold",(et=v.SwitchStyles||(v.SwitchStyles={})).ROUNDGREEN="roundgreen",et.ROUNDRED="roundred",et.SQUAREGREEN="squaregreen",et.SQUARERED="squarered";var nt={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},ot={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},rt={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:662},st={sourceWidth:174,sourceHeight:46,sourceLeft:512,sourceTop:612},at={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:458},ht={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:457},ct={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:494},lt={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:493},ut={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:531},pt={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:531},dt={sourceWidth:128,sourceHeight:32,sourceLeft:512,sourceTop:567},gt={sourceWidth:128,sourceHeight:32,sourceLeft:646,sourceTop:567},ft={sourceWidth:26,sourceHeight:26,sourceLeft:697,sourceTop:611},yt={sourceWidth:26,sourceHeight:26,sourceLeft:733,sourceTop:611},bt={sourceWidth:416,sourceHeight:352,sourceLeft:501,sourceTop:12},vt={sourceWidth:480,sourceHeight:384,sourceLeft:7,sourceTop:12},wt={sourceWidth:486,sourceHeight:326,sourceLeft:7,sourceTop:413},Tt={closeW:{sourceWidth:32,sourceHeight:32,sourceLeft:942,sourceTop:306},closeD:{sourceWidth:32,sourceHeight:32,sourceLeft:986,sourceTop:306},closeWLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:512,sourceTop:381},closeDLarge:{sourceWidth:64,sourceHeight:64,sourceLeft:583,sourceTop:381},closeWNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:252},closeDNoBack:{sourceWidth:24,sourceHeight:24,sourceLeft:946,sourceTop:214},closeWNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:214},closeDNoBackLarge:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:260},FDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:4},FWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:4},EDark:{sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:40},EWhite:{sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:40},Timer:{sourceWidth:24,sourceHeight:32.2,sourceLeft:718,sourceTop:388},TimerLarge:{sourceWidth:48,sourceHeight:68,sourceLeft:662,sourceTop:386},ClickWhite:{sourceWidth:32,sourceHeight:48,sourceLeft:799,sourceTop:389},ClickDark:{sourceWidth:32,sourceHeight:48,sourceLeft:757,sourceTop:389}},xt={sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:76},St={sourceWidth:24,sourceHeight:24,sourceLeft:987,sourceTop:104},Ct={sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:76},At={sourceWidth:24,sourceHeight:24,sourceLeft:958,sourceTop:104},_t={sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:132},It={sourceWidth:32,sourceHeight:32,sourceLeft:987,sourceTop:168},Pt={sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:132},Rt={sourceWidth:32,sourceHeight:32,sourceLeft:950,sourceTop:168},Ot={sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:454},kt={sourceWidth:64,sourceHeight:32,sourceLeft:853,sourceTop:454},Lt={sourceWidth:64,sourceHeight:32,sourceLeft:923,sourceTop:454},Nt={sourceWidth:64,sourceHeight:32,sourceLeft:783,sourceTop:501},zt={sourceWidth:64,sourceHeight:32,sourceLeft:852,sourceTop:501},Bt={sourceWidth:64,sourceHeight:32,sourceLeft:921,sourceTop:501};function S(v,A){v.sourceWidth=A.sourceWidth,v.sourceHeight=A.sourceHeight,v.sourceLeft=A.sourceLeft?A.sourceLeft:0,v.sourceTop=A.sourceTop?A.sourceTop:0}function B(v){var A=-10-4*v;return A>-65?A:-65}var Ft=function(A){function o(E,R,M,V,H,X,Z){var K=A.call(this)||this;if(K.canvas=O,K.valueAsNum=E>1?1:E,K.fullWidth=X?128*X:128,K.background=new UIImage(O,W),K.background.width=X?128*X:128,K.background.height=X?32*X:32,K.background.hAlign="right",K.background.vAlign="bottom",K.background.positionX=R||0,K.background.positionY=M||0,H)switch(H){case v.BarStyles.ROUNDBLACK:S(K.background,at);break;case v.BarStyles.ROUNDWHITE:S(K.background,ct);break;case v.BarStyles.ROUNDSILVER:S(K.background,ut);break;case v.BarStyles.ROUNDGOLD:S(K.background,dt);break;case v.BarStyles.SQUAREBLACK:S(K.background,ht);break;case v.BarStyles.SQUAREWHITE:S(K.background,lt);break;case v.BarStyles.SQUARESILVER:S(K.background,pt);break;case v.BarStyles.SQUAREGOLD:S(K.background,gt)}else S(K.background,ut);return K.background.sourceWidth=128,K.background.sourceHeight=32,K.background.visible=!0,K.bar=new UIContainerRect(K.background),K.bar.color=V||Color4.Red(),K.bar.thickness=0,K.bar.hAlign="left",K.bar.vAlign="center",K.bar.positionX=X?2.55*X:2.55,K.bar.positionY=0,K.bar.height=X?32*X-7.5*X:24.5,K.bar.width=X?K.fullWidth*K.valueAsNum-5.1*X:K.fullWidth*K.valueAsNum-5.1,Z&&K.hide(),K}return i(o,A),o.prototype.read=function(){return this.valueAsNum},o.prototype.increase=function(v){this.valueAsNum+=v||.1,this.bar.width=this.fullWidth*this.valueAsNum-6},o.prototype.decrease=function(v){this.valueAsNum-=v||.1,this.bar.width=this.fullWidth*this.valueAsNum-6},o.prototype.set=function(v){this.valueAsNum=v,this.bar.width=this.fullWidth*this.valueAsNum-6},o.prototype.hide=function(){this.background.visible=!1,this.bar.visible=!1},o.prototype.show=function(){this.background.visible=!0,this.bar.visible=!0},o}(Entity),Vt=function(v){function e(A,E,R,M,V,W){var H=v.call(this)||this;H.canvas=O;var X=new Texture(A);return H.image=new UIImage(O,X),H.image.hAlign="right",H.image.vAlign="bottom",H.image.positionX=E||0,H.image.positionY=R||0,H.image.width=M||64,H.image.height=V||64,H.image.sourceLeft=W&&W.sourceLeft?W.sourceLeft:0,H.image.sourceTop=W&&W.sourceTop?W.sourceTop:0,H.image.sourceWidth=W&&W.sourceWidth?W.sourceWidth:M||64,H.image.sourceHeight=W&&W.sourceHeight?W.sourceHeight:V||64,H}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var E=this;if(this.image.visible=!0,v){var R=new Entity;engine.addEntity(R),R.addComponentOrReplace(new A(v,(function(){E.hide()})))}},e}(Entity),Ut=function(v){function e(A,E,R,M,V,W){var H=v.call(this)||this;H.canvas=O;var X=new Texture(A);return H.image=new UIImage(O,X),H.image.hAlign="right",H.image.vAlign="bottom",H.image.positionX=E||0,H.image.positionY=R||0,H.image.width=M||32,H.image.height=V||32,H.image.sourceLeft=W&&W.sourceLeft?W.sourceLeft:0,H.image.sourceTop=W&&W.sourceTop?W.sourceTop:0,H.image.sourceWidth=W?W.sourceWidth:M||32,H.image.sourceHeight=W?W.sourceHeight:V||32,H}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var E=this;if(this.image.visible=!0,v){var R=new Entity;engine.addEntity(R),R.addComponentOrReplace(new A(v,(function(){E.hide()})))}},e}(Entity),Wt=function(v){function e(A,E,R,M,V,W){var H=v.call(this)||this;H.canvas=O;var X=new Texture(A);return H.image=new UIImage(O,X),H.image.hAlign="right",H.image.vAlign="bottom",H.image.positionX=E||0,H.image.positionY=R||0,H.image.width=M||128,H.image.height=V||128,H.image.sourceLeft=W&&W.sourceLeft?W.sourceLeft:0,H.image.sourceTop=W&&W.sourceTop?W.sourceTop:0,H.image.sourceWidth=W?W.sourceWidth:M||128,H.image.sourceHeight=W?W.sourceHeight:V||128,H}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var E=this;if(this.image.visible=!0,v){var R=new Entity;engine.addEntity(R),R.addComponentOrReplace(new A(v,(function(){E.hide()})))}},e}(Entity),Ht=function(v){function e(E,R,M,V,W,H,X,Z){var K=v.call(this)||this;K.canvas=O;var $=new Texture(E);if(K.image=new UIImage(O,$),K.image.hAlign="center",K.image.vAlign="center",K.image.positionX=V||0,K.image.positionY=W||0,K.image.width=H||512,K.image.height=X||512,K.image.sourceLeft=Z&&Z.sourceLeft?Z.sourceLeft:0,K.image.sourceTop=Z&&Z.sourceTop?Z.sourceTop:0,K.image.sourceWidth=Z?Z.sourceWidth:H||512,K.image.sourceHeight=Z?Z.sourceHeight:X||512,K.image.visible=!M,-1!=R){var J=new Entity;engine.addEntity(J),J.addComponentOrReplace(new A(R||3,(function(){K.hide()})))}return K}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(v){var E=this;if(this.image.visible=!0,v){var R=new Entity;engine.addEntity(R),R.addComponentOrReplace(new A(v,(function(){E.hide()})))}},e}(Entity),Gt=function(v){function e(A,E,R,V){var X=v.call(this)||this;X.canvas=O,X.UIOpenTime=+Date.now(),X.background=new UIImage(O,W),X.background.hAlign="center",X.background.vAlign="center",X.onAccept=E||null;var Z=V?H:W;return X.background.source=Z,X.background.width=400,X.background.height=250,X.background.positionY=0,S(X.background,bt),X.background.visible=!0,X.closeIcon=new UIImage(X.background,Z),X.closeIcon.positionX=175,X.closeIcon.positionY=100,X.closeIcon.width=32,X.closeIcon.height=32,S(X.closeIcon,V?Tt.closeW:Tt.closeD),X.closeIcon.onClick=new OnClick((function(){X.close()})),X.text=new UIText(X.background),X.text.value=A,X.text.adaptWidth=!1,X.text.textWrapping=!0,X.text.width=380,X.text.hAlign="center",X.text.vAlign="top",X.text.positionX=0,X.text.positionY=-65,X.text.fontSize=24,X.text.font=M,X.text.vTextAlign="center",X.text.hTextAlign="center",X.text.color=V?Color4.White():Color4.Black(),X.button=new UIImage(X.background,Z),X.button.positionX=0,X.button.positionY=-60,X.button.width=174,X.button.height=46,S(X.button,nt),X.icon=new UIImage(X.button,1==V?H:W),X.icon.width=26,X.icon.height=26,X.icon.hAlign="center",X.icon.vAlign="center",X.icon.isPointerBlocker=!1,S(X.icon,ft),X.icon.positionX=B(R?R.length:2),X.buttonLabel=new UIText(X.button),X.buttonLabel.value=R||"Ok",X.buttonLabel.hTextAlign="center",X.buttonLabel.vTextAlign="center",X.buttonLabel.positionX=30,X.buttonLabel.fontSize=18,X.buttonLabel.font=M,X.buttonLabel.color=Color4.White(),X.buttonLabel.isPointerBlocker=!1,X.button.onClick=new OnClick((function(){X.accept()})),X.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){X.button.visible&&+Date.now()-X.UIOpenTime>100&&X.accept()})),X}return i(e,v),e.prototype.close=function(){this.background.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1},e.prototype.accept=function(){this.onAccept&&this.onAccept(),this.hide()},e.prototype.hide=function(){this.background.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1,Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.EButtonAction)},e.prototype.show=function(){this.background.visible=!0,this.closeIcon.visible=!0,this.button.visible=!0,this.text.visible=!0,this.buttonLabel.visible=!0,Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,this.EButtonAction)},e}(Entity),Yt=function(v){function e(A,E,R,X,Z,K,$){var J=v.call(this)||this;J.canvas=O,J.UIOpenTime=+Date.now(),J.background=new UIImage(O,W),J.background.hAlign="center",J.background.vAlign="center",J.onAccept=R,J.onReject=X||null;var et=$?H:W;return J.background.source=et,J.background.width=480,J.background.height=384,S(J.background,vt),J.background.visible=!0,J.closeIcon=new UIImage(J.background,et),J.closeIcon.positionX=215,J.closeIcon.positionY=164,J.closeIcon.width=32,J.closeIcon.height=32,S(J.closeIcon,$?Tt.closeW:Tt.closeD),J.closeIcon.onClick=new OnClick((function(){J.close()})),J.title=new UIText(J.background),J.title.value=A,J.title.adaptWidth=!1,J.title.textWrapping=!0,J.title.width=380,J.title.hAlign="center",J.title.vAlign="top",J.title.positionX=0,J.title.positionY=-20,J.title.font=V,J.title.fontSize=24,J.title.vTextAlign="center",J.title.hTextAlign="center",J.title.color=$?Color4.White():Color4.Black(),J.text=new UIText(J.background),J.text.value=E,J.text.adaptWidth=!1,J.text.textWrapping=!0,J.text.width=380,J.text.hAlign="center",J.text.vAlign="top",J.text.positionX=0,J.text.positionY=-145,J.text.fontSize=24,J.text.font=M,J.text.vTextAlign="center",J.text.hTextAlign="center",J.text.color=$?Color4.White():Color4.Black(),J.buttonE=new UIImage(J.background,et),J.buttonE.positionX=-100,J.buttonE.positionY=-120,J.buttonE.width=174,J.buttonE.height=46,S(J.buttonE,nt),J.buttonEIcon=new UIImage(J.buttonE,1==$?H:W),J.buttonEIcon.width=26,J.buttonEIcon.height=26,J.buttonEIcon.hAlign="center",J.buttonEIcon.vAlign="center",J.buttonEIcon.isPointerBlocker=!1,S(J.buttonEIcon,ft),J.buttonEIcon.positionX=B(Z?Z.length:2),J.buttonELabel=new UIText(J.buttonE),J.buttonELabel.value=Z||"Ok",J.buttonELabel.hTextAlign="center",J.buttonELabel.vTextAlign="center",J.buttonELabel.positionX=30,J.buttonELabel.fontSize=18,J.buttonELabel.font=M,J.buttonELabel.color=Color4.White(),J.buttonELabel.isPointerBlocker=!1,J.buttonE.onClick=new OnClick((function(){J.accept()})),J.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){J.buttonE.visible&&+Date.now()-J.UIOpenTime>100&&J.accept()})),J.buttonF=new UIImage(J.background,et),J.buttonF.positionX=100,J.buttonF.positionY=-120,J.buttonF.width=174,J.buttonF.height=46,S(J.buttonF,ot),J.buttonFIcon=new UIImage(J.buttonF,1==$?H:W),J.buttonFIcon.width=26,J.buttonFIcon.height=26,J.buttonFIcon.hAlign="center",J.buttonFIcon.vAlign="center",J.buttonFIcon.isPointerBlocker=!1,S(J.buttonFIcon,yt),J.buttonFIcon.positionX=B(K?K.length:6),J.buttonFLabel=new UIText(J.buttonF),J.buttonFLabel.value=K||"Cancel",J.buttonFLabel.hTextAlign="center",J.buttonFLabel.vTextAlign="center",J.buttonFLabel.positionX=30,J.buttonFLabel.fontSize=18,J.buttonFLabel.font=M,J.buttonFLabel.color=Color4.White(),J.buttonFLabel.isPointerBlocker=!1,J.buttonF.onClick=new OnClick((function(){J.reject()})),J.FButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,(function(v){J.buttonF.visible&&+Date.now()-J.UIOpenTime>100&&J.reject()})),J}return i(e,v),e.prototype.close=function(){this.background.visible=!1,this.closeIcon.visible=!1,this.buttonE.visible=!1,this.buttonF.visible=!1,this.text.visible=!1,this.buttonELabel.visible=!1,this.buttonFLabel.visible=!1,this.title.visible=!1},e.prototype.accept=function(){this.onAccept&&this.onAccept(),this.hide()},e.prototype.reject=function(){this.onReject&&this.onReject(),this.hide()},e.prototype.hide=function(){this.background.visible=!1,this.closeIcon.visible=!1,this.buttonE.visible=!1,this.buttonF.visible=!1,this.text.visible=!1,this.buttonELabel.visible=!1,this.buttonFLabel.visible=!1,this.buttonEIcon.visible=!1,this.buttonFIcon.visible=!1,Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.EButtonAction),Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.SECONDARY,this.FButtonAction)},e.prototype.show=function(){this.background.visible=!0,this.closeIcon.visible=!0,this.buttonE.visible=!0,this.buttonF.visible=!0,this.text.visible=!0,this.buttonELabel.visible=!0,this.buttonFLabel.visible=!0,this.buttonEIcon.visible=!0,this.buttonFIcon.visible=!0,Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,this.EButtonAction),Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,this.FButtonAction)},e}(Entity),qt=function(v){function e(A,E,R,X,Z){var K=v.call(this)||this;K.canvas=O,K.UIOpenTime=+Date.now(),K.background=new UIImage(O,W),K.background.hAlign="center",K.background.vAlign="center",K.onAccept=E;var $=Z?H:W;K.background.source=$,K.background.width=400,K.background.height=250,S(K.background,bt),K.background.visible=!0,K.text=new UIText(K.background),K.text.value=A,K.text.adaptWidth=!1,K.text.textWrapping=!0,K.text.width=320,K.text.hAlign="center",K.text.vAlign="top",K.text.positionX=0,K.text.positionY=-20,K.text.fontSize=24,K.text.font=V,K.text.vTextAlign="center",K.text.hTextAlign="center",K.text.color=Z?Color4.White():Color4.Black(),K.closeIcon=new UIImage(K.background,$),K.closeIcon.positionX=175,K.closeIcon.positionY=100,K.closeIcon.width=32,K.closeIcon.height=32,S(K.closeIcon,Z?Tt.closeW:Tt.closeD),K.closeIcon.onClick=new OnClick((function(){K.hide()})),K.button=new UIImage(K.background,$),K.button.positionX=0,K.button.positionY=-60,K.button.width=174,K.button.height=46,S(K.button,nt),K.icon=new UIImage(K.button,1==Z?H:W),K.icon.width=26,K.icon.height=26,K.icon.hAlign="center",K.icon.vAlign="center",K.icon.isPointerBlocker=!1,S(K.icon,ft),K.icon.positionX=B(R?R.length:6),K.buttonLabel=new UIText(K.button),K.buttonLabel.value=R||"Submit",K.buttonLabel.hTextAlign="center",K.buttonLabel.vTextAlign="center",K.buttonLabel.positionX=30,K.buttonLabel.fontSize=18,K.buttonLabel.font=M,K.buttonLabel.color=Color4.White(),K.buttonLabel.isPointerBlocker=!1,K.fillInBox=new UIInputText(K.background),K.fillInBox.color=Color4.Black(),K.fillInBox.font=M,K.fillInBox.width=312,K.fillInBox.height=46,K.fillInBox.positionX=0,K.fillInBox.positionY=15,K.fillInBox.placeholder=X||"Fill in",K.fillInBox.hTextAlign="center",K.fillInBox.vTextAlign="center",K.fillInBox.fontSize=22;var J="";return K.fillInBox.onChanged=new OnChanged((function(v){J=v.value})),K.fillInBox.onTextSubmit=new OnTextSubmit((function(v){K.accept(J)})),K.button.onClick=new OnClick((function(){K.accept(J)})),K.EButtonAction=Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){K.button.visible&&+Date.now()-K.UIOpenTime>100&&K.accept(J)})),K}return i(e,v),e.prototype.close=function(){this.background.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1,this.fillInBox.visible=!1},e.prototype.accept=function(v){this.onAccept(v),this.hide()},e.prototype.hide=function(){this.background.visible=!1,this.closeIcon.visible=!1,this.button.visible=!1,this.text.visible=!1,this.buttonLabel.visible=!1,this.fillInBox.visible=!1,Input.instance.unsubscribe("BUTTON_DOWN",ActionButton.PRIMARY,this.EButtonAction)},e.prototype.show=function(){this.background.visible=!0,this.closeIcon.visible=!0,this.button.visible=!0,this.text.visible=!0,this.buttonLabel.visible=!0,this.fillInBox.visible=!0,Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,this.EButtonAction)},e}(Entity),Qt=function(A){function o(E,R,M,V){var X=A.call(this)||this;switch(X.elements=[],X.texture=W,X.darkTheme=!1,X.UIOpenTime=0,X.canvas=O,X.UIOpenTime=+Date.now(),X.background=new UIImage(O,W),X.background.hAlign="center",X.background.vAlign="center",X.closeIcon=new UIImage(X.background,X.texture),E||(E=v.PromptStyles.LIGHT),E){case v.PromptStyles.LIGHT:X.texture=W,S(X.background,bt),S(X.closeIcon,Tt.closeD),X.closeIcon.positionX=R?R/2-25:175,X.closeIcon.positionY=M?M/2-25:145;break;case v.PromptStyles.DARK:X.texture=H,X.darkTheme=!0,S(X.background,bt),S(X.closeIcon,Tt.closeW),X.closeIcon.positionX=R?R/2-25:175,X.closeIcon.positionY=M?M/2-25:145;break;case v.PromptStyles.LIGHTLARGE:X.texture=W,S(X.background,vt),S(X.closeIcon,Tt.closeD),X.closeIcon.positionX=R?R/2-25:215,X.closeIcon.positionY=M?M/2-25:165;break;case v.PromptStyles.DARKLARGE:X.texture=H,X.darkTheme=!0,S(X.background,vt),S(X.closeIcon,Tt.closeW),X.closeIcon.positionX=R?R/2-25:215,X.closeIcon.positionY=M?M/2-25:165;break;case v.PromptStyles.LIGHTSLANTED:X.texture=W,S(X.background,wt),S(X.closeIcon,Tt.closeD),X.closeIcon.positionX=R?R/2-25:215,X.closeIcon.positionY=M?M/2-25:138;break;case v.PromptStyles.DARKSLANTED:X.texture=H,X.darkTheme=!0,S(X.background,wt),S(X.closeIcon,Tt.closeW),X.closeIcon.positionX=R?R/2-25:215,X.closeIcon.positionY=M?M/2-25:138;break;default:X.texture=new Texture(E),X.closeIcon.visible=!1}return X.background.source=X.texture,X.background.width=R||X.background.sourceWidth,X.background.height=M||X.background.sourceHeight,X.background.visible=!0,X.closeIcon.width=32,X.closeIcon.height=32,X.closeIcon.source=X.texture,X.closeIcon.onClick=new OnClick((function(){X.hide()})),V&&X.hide(),X}return i(o,A),o.prototype.hide=function(){var v,A;this.background.visible=!1,this.closeIcon.visible=!1;try{for(var E=r(this.elements),R=E.next();!R.done;R=E.next())R.value.hide()}catch(A){v={error:A}}finally{try{R&&!R.done&&(A=E.return)&&A.call(E)}finally{if(v)throw v.error}}},o.prototype.show=function(){var v,A;this.background.visible=!0,this.closeIcon.visible=!0;try{for(var E=r(this.elements),R=E.next();!R.done;R=E.next())R.value.show()}catch(A){v={error:A}}finally{try{R&&!R.done&&(A=E.return)&&A.call(E)}finally{if(v)throw v.error}}},o.prototype.addText=function(v,A,E,R,O){var M=new ee(this,v,A,E,this.darkTheme,R||void 0,O||void 0);return this.elements.push(M),M},o.prototype.addButton=function(v,A,E,R,O){var M=new Zt(this,this.texture,this.UIOpenTime,v,A,E,R,O||void 0);return this.elements.push(M),M},o.prototype.addCheckbox=function(v,A,E,R,O,M,V){var W=new Kt(this,this.texture,this.darkTheme,v,A,E,R||void 0,O||void 0,M||void 0,V||void 0);return this.elements.push(W),W},o.prototype.addSwitch=function(v,A,E,R,O,M,V){var W=new $t(this,this.texture,this.darkTheme,v,A,E,R||void 0,O||void 0,M||void 0,V||void 0);return this.elements.push(W),W},o.prototype.addIcon=function(v,A,E,R,O,M){var V=new Texture(v),W=new Jt(this,V,A,E,R||void 0,O||void 0,M||void 0);return this.elements.push(W),W},o.prototype.addTextBox=function(v,A,E,R){var O=new ie(this,v,A,E||void 0,R||void 0);return this.elements.push(O),O},o}(Entity),Zt=function(A){function o(E,R,O,V,W,H,X,Z){var K=A.call(this)||this;if(K.icon=null,K.image=new UIImage(E.background,R),K.image.positionX=W,K.image.positionY=H,K.image.width=174,K.image.height=46,K.label=new UIText(K.image),Z)switch(Z){case v.ButtonStyles.E:S(K.image,nt),K.label.positionX=25,K.icon=new UIImage(K.image,R),K.icon.width=26,K.icon.height=26,K.icon.hAlign="center",K.icon.vAlign="center",K.icon.isPointerBlocker=!1,S(K.icon,ft),K.icon.positionX=B(V.length);break;case v.ButtonStyles.F:S(K.image,ot),K.label.positionX=25,K.icon=new UIImage(K.image,R),K.icon.width=26,K.icon.height=26,K.icon.hAlign="center",K.icon.vAlign="center",K.icon.isPointerBlocker=!1,S(K.icon,yt),K.icon.positionX=B(V.length);break;case v.ButtonStyles.RED:S(K.image,rt);break;case v.ButtonStyles.DARK:S(K.image,st);break;case v.ButtonStyles.ROUNDBLACK:S(K.image,at);break;case v.ButtonStyles.ROUNDWHITE:S(K.image,ct);break;case v.ButtonStyles.ROUNDSILVER:S(K.image,ut);break;case v.ButtonStyles.ROUNDGOLD:S(K.image,dt);break;case v.ButtonStyles.SQUAREBLACK:S(K.image,ht);break;case v.ButtonStyles.SQUAREWHITE:S(K.image,lt);break;case v.ButtonStyles.SQUARESILVER:S(K.image,pt);break;case v.ButtonStyles.SQUAREGOLD:S(K.image,gt);break;default:S(K.image,ut)}else S(K.image,ut);return K.label.value=V,K.label.hTextAlign="center",K.label.vTextAlign="center",K.label.fontSize=20,K.label.font=M,K.label.color=Z==v.ButtonStyles.ROUNDWHITE||Z==v.ButtonStyles.SQUAREWHITE?Color4.Black():Color4.White(),K.label.isPointerBlocker=!1,K.image.onClick=new OnClick((function(){X()})),Z==v.ButtonStyles.E?Input.instance.subscribe("BUTTON_DOWN",ActionButton.PRIMARY,!1,(function(v){K.image.visible&&+Date.now()-O>100&&X()})):Z==v.ButtonStyles.F&&Input.instance.subscribe("BUTTON_DOWN",ActionButton.SECONDARY,!1,(function(v){K.image.visible&&+Date.now()-O>100&&X()})),K}return i(o,A),o.prototype.hide=function(){this.image.visible=!1},o.prototype.show=function(){this.image.visible=!0},o.prototype.grayOut=function(){this.label.color=Color4.Gray(),this.image.isPointerBlocker=!1,this.icon&&(this.icon.visible=!1)},o.prototype.enable=function(){this.label.color=Color4.White(),this.image.isPointerBlocker=!0,this.icon&&(this.icon.visible=!0)},o}(Entity),Kt=function(v){function e(A,E,R,O,V,W,H,X,Z,K){var $=v.call(this)||this;return $.checked=!!K,$.darkTheme=R,$.large=Z||!1,$.image=new UIImage(A.background,E),$.image.positionX=V,$.image.positionY=W,$.image.width=Z?32:24,$.image.height=Z?32:24,0==$.checked?$.uncheck():$.check(),$.label=new UIText($.image),$.label.positionX=Z?40:30,$.label.color=R?Color4.White():Color4.Black(),$.label.value=O,$.label.hTextAlign="left",$.label.vTextAlign="center",$.label.fontSize=20,$.label.font=M,$.label.isPointerBlocker=!1,$.image.onClick=new OnClick((function(){0==$.checked?$.check():$.uncheck(),$.checked?H&&H():X&&X()})),$}return i(e,v),e.prototype.hide=function(){this.image.visible=!1,this.label.visible=!1},e.prototype.show=function(){this.image.visible=!0,this.label.visible=!0},e.prototype.uncheck=function(){this.checked=!1,this.darkTheme?this.large?S(this.image,_t):S(this.image,xt):this.large?S(this.image,Pt):S(this.image,Ct)},e.prototype.check=function(){this.checked=!0,this.darkTheme?this.large?S(this.image,It):S(this.image,St):this.large?S(this.image,Rt):S(this.image,At)},e}(Entity),$t=function(A){function o(E,R,O,V,W,H,X,Z,K,$){var J=A.call(this)||this;return J.checked=!!$,J.darkTheme=O,J.style=K||v.SwitchStyles.ROUNDGREEN,J.image=new UIImage(E.background,R),J.image.positionX=W,J.image.positionY=H,J.image.width=64,J.image.height=32,0==J.checked?J.check():J.uncheck(),J.label=new UIText(J.image),J.label.positionX=80,J.label.color=O?Color4.White():Color4.Black(),J.label.value=V,J.label.hTextAlign="left",J.label.vTextAlign="center",J.label.fontSize=20,J.label.font=M,J.label.isPointerBlocker=!1,J.image.onClick=new OnClick((function(){0==J.checked?J.check():J.uncheck(),J.checked?X&&X():Z&&Z()})),J}return i(o,A),o.prototype.hide=function(){this.image.visible=!1,this.label.visible=!1},o.prototype.show=function(){this.image.visible=!0,this.label.visible=!0},o.prototype.check=function(){switch(this.checked=!0,this.style){case v.SwitchStyles.ROUNDGREEN:S(this.image,Lt);break;case v.SwitchStyles.ROUNDRED:S(this.image,kt);break;case v.SwitchStyles.SQUAREGREEN:S(this.image,Bt);break;case v.SwitchStyles.SQUARERED:S(this.image,zt)}},o.prototype.uncheck=function(){this.checked=!1,this.style==v.SwitchStyles.ROUNDGREEN||this.style==v.SwitchStyles.ROUNDRED?S(this.image,Ot):S(this.image,Nt)},o}(Entity),Jt=function(v){function e(A,E,R,O,M,V,W){var H=v.call(this)||this;return H.image=new UIImage(A.background,E),H.image.positionX=R,H.image.positionY=O,H.image.width=M||128,H.image.height=V||128,H.image.sourceLeft=W&&W.sourceLeft?W.sourceLeft:0,H.image.sourceTop=W&&W.sourceTop?W.sourceTop:0,H.image.sourceWidth=W&&W.sourceWidth?W.sourceWidth:M||128,H.image.sourceHeight=W&&W.sourceHeight?W.sourceHeight:V||128,H}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(){this.image.visible=!0},e}(Entity),ee=function(v){function e(A,E,R,O,M,V,W){var H=v.call(this)||this;return H.text=new UIText(A.background),H.text.value=E,H.text.positionX=R||0,H.text.positionY=O||0,H.text.hTextAlign="center",H.text.color=V||(M?Color4.White():Color4.Black()),H.text.fontSize=W||15,H}return i(e,v),e.prototype.hide=function(){this.text.visible=!1},e.prototype.show=function(){this.text.visible=!0},e}(Entity),ie=function(v){function e(A,E,R,O,V){var W=v.call(this)||this;return W.currentText="",W.fillInBox=new UIInputText(A.background),W.fillInBox.color=Color4.Black(),W.fillInBox.font=M,W.fillInBox.width=312,W.fillInBox.height=46,W.fillInBox.positionX=E,W.fillInBox.positionY=R,W.fillInBox.placeholder=O||"Fill in",W.fillInBox.hTextAlign="center",W.fillInBox.vTextAlign="center",W.fillInBox.fontSize=22,W.fillInBox.onChanged=new OnChanged((function(v){W.fillInBox&&!W.fillInBox.visible||(W.currentText=v.value,V&&V(W.currentText))})),W.fillInBox.onTextSubmit=new OnTextSubmit((function(v){W.fillInBox&&!W.fillInBox.visible||(W.currentText=v.text,V&&V(W.currentText))})),W}return i(e,v),e.prototype.hide=function(){this.fillInBox.visible=!1},e.prototype.show=function(){this.fillInBox.visible=!0},e}(Entity),ne=function(v){function e(A,E,R,V,W,H){var X=v.call(this)||this;return X.canvas=O,X.uiText=new UIText(O),X.uiText.value=A,X.uiText.hAlign="right",X.uiText.vAlign="bottom",X.uiText.positionX=E||0,X.uiText.positionY=R||0,X.uiText.fontSize=W||25,X.uiText.font=M,X.uiText.vTextAlign="center",X.uiText.hTextAlign="center",X.uiText.color=V||Color4.White(),X.uiText.outlineColor=Color4.Black(),X.uiText.outlineWidth=H?0:.1,X}return i(e,v),e.prototype.hide=function(){this.uiText.visible=!1},e.prototype.show=function(){this.uiText.visible=!0},e.prototype.set=function(v){this.uiText.value=v,this.uiText.visible=!0},e}(Entity),oe=function(v){function e(E,R,M,V){var H=v.call(this)||this;if(H.canvas=O,H.image=new UIImage(O,W),H.image.hAlign="center",H.image.vAlign="center",H.image.positionX=R||0,H.image.positionY=M?M+80:80,H.image.width=V?48*V:48,H.image.height=V?64*V:64,S(H.image,Tt.TimerLarge),E&&0!=E){var X=new Entity;engine.addEntity(X),X.addComponentOrReplace(new A(E||3,(function(){H.hide()})))}return H}return i(e,v),e.prototype.hide=function(){this.image.visible=!1},e.prototype.show=function(){this.image.visible=!0},e}(Entity);function Q(v){return v&&"object"==typeof v&&!Array.isArray(v)}function q(v,A){var E=o({},v);return Q(v)&&Q(A)&&Object.keys(A).forEach((function(R){var O,M;Q(A[R])?R in v?E[R]=q(v[R],A[R]):E=o(o({},E),((O={})[R]=A[R],O)):E=o(o({},E),((M={})[R]=A[R],M))})),E}var se=function(){function t(v,A){this.shape=v,A&&this.setProperties(A)}return t.prototype.setProperties=function(v){var A,E;try{for(var R=r(Object.keys(v)),O=R.next();!O.done;O=R.next()){var M=O.value;this.shape[M]=v[M]}}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(A)throw A.error}}},t.prototype.getProperty=function(v){return this.shape[v]},t}(),ae=function(v){function e(A,E){var R,O,M,V=v.call(this,new UIInputText(A),o(o({},E),{placeholder:null!==(R=null==E?void 0:E.placeholder)&&void 0!==R?R:null==E?void 0:E.value,onFocus:new OnFocus((function(){var v;V.isInputFocused=!0,null===(v=null==E?void 0:E.onFocus)||void 0===v||v.call(E)})),onBlur:new OnBlur((function(){var v,A;V.isInputFocused=!1,""===V.inputValue&&void 0!==V.placeholder?(V.setInputValue(V.placeholder),null===(v=null==E?void 0:E.onBlur)||void 0===v||v.call(E,!0)):null===(A=null==E?void 0:E.onBlur)||void 0===A||A.call(E,!1)})),onChanged:new OnChanged((function(v){var A,R=v.value;if(V.shape.visible&&(V.inputValue=R,R!==V.placeholder&&(""===R&&(V.shape.placeholder=""),V.isInputFocused||""===R))){var O=null!==(A=null==E?void 0:E.waitTime)&&void 0!==A?A:e.DEFAULT_WAIT_TIME;setTimeout((function(){var v;V.inputValue===R&&(null===(v=null==E?void 0:E.onChanged)||void 0===v||v.call(E,R))}),O)}})),onTextSubmit:new OnTextSubmit((function(v){var A=v.text,R=A.substr(0,A.length-1),O=null==E?void 0:E.onTextSubmit;O?O(R):setTimeout((function(){return V.shape.placeholder=R}),0)}))}))||this;return V.inputValue="",V.isInputFocused=!1,V.placeholder=V.shape.placeholder,V.inputValue=null!==(M=null!==(O=null==E?void 0:E.value)&&void 0!==O?O:null==E?void 0:E.placeholder)&&void 0!==M?M:"",V.isInputFocused=!1,V}return i(e,v),e.prototype.getValue=function(){return this.inputValue},e.prototype.isFocused=function(){return this.isInputFocused},e.prototype.setInputValue=function(v){var A=this.isInputFocused;this.isInputFocused=!1,this.shape.placeholder="",this.inputValue=this.shape.placeholder=v,this.isInputFocused=A},e.prototype.reset=function(){this.setInputValue(this.placeholder)},e.prototype.hide=function(){this.setProperties({visible:!1})},e.prototype.show=function(){this.setProperties({visible:!0}),this.setInputValue(this.inputValue)},e.DEFAULT_WAIT_TIME=650,e}(se),he=function(v){function e(A,E){var R=v.call(this,new UIContainerRect(A),o({isPointerBlocker:!0},E))||this,O=new UIImage(R.shape,new Texture("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="));return O.width="100%",O.height="100%",O.sourceWidth=1,O.sourceHeight=1,O.isPointerBlocker=!0,R.image=O,(null==E?void 0:E.onClick)&&R.setOnClick(E.onClick),R}return i(e,v),e.prototype.performClick=function(){var v;null===(v=this.image.onClick)||void 0===v||v.callback({})},e.prototype.setOnClick=function(v){this.image.onClick=new OnClick(v)},e.prototype.clearOnClick=function(){this.image.onClick=null},e}(se),ce=function(v){function e(A,E){var R=v.call(this,new UIContainerRect(A),o({width:"100%",vAlign:"top",visible:!1},E))||this;R.config=o(o({},e.DEFAULTS),E);var O=new he(R.shape,{width:"100%",height:"100%",color:Color4.Clear()});R.clickableContainer=O;var M=new UIImage(O.shape,new Texture("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="));M.width=M.height=R.config.imageSize,M.hAlign="left",M.positionX=10,M.vAlign="center",R.image=M;var V=new UIText(O.shape);V.vAlign="top",V.hAlign="left",V.vTextAlign="top",V.fontSize=R.config.topFontSize,V.color=R.config.topTextColor,V.positionX=55,V.positionY=-10,V.isPointerBlocker=!1,R.topLeftText=V;var W=new UIText(O.shape);W.vAlign="top",W.hAlign="right",W.vTextAlign="top",W.hTextAlign="right",W.fontSize=V.fontSize,W.color=V.color,W.isPointerBlocker=!1,W.positionX=-10,W.positionY=V.positionY,R.topRightText=W;var H=new UIText(O.shape);H.vAlign="bottom",H.hAlign="left",H.vTextAlign="bottom",H.fontSize=R.config.bottomFontSize,H.color=R.config.bottomTextColor,H.positionX=V.positionX,H.positionY=10,H.isPointerBlocker=!1,R.bottomLeftText=H;var X=new UIText(O.shape);return X.vAlign="bottom",X.hAlign="right",X.vTextAlign="bottom",X.hTextAlign="right",X.fontSize=H.fontSize,X.color=H.color,X.isPointerBlocker=!1,X.positionX=W.positionX,X.positionY=H.positionY,R.bottomRightText=X,R}return i(e,v),e.prototype.setOption=function(v,A){this.image.visible=!1,this.topRightText.visible=!1,this.bottomLeftText.visible=!1,this.bottomRightText.visible=!1,v.image?(this.image.source=new Texture(v.image.src),this.image.sourceWidth=v.image.sourceWidth,this.image.sourceHeight=v.image.sourceHeight,this.image.visible=!0,this.topLeftText.positionX=this.config.imageSize+20):this.topLeftText.positionX=10,"string"==typeof v.visualText?(this.topLeftText.value=v.visualText,this.topLeftText.vAlign=this.topLeftText.vTextAlign="center",this.topLeftText.positionY=0):"text"in v.visualText?(this.topLeftText.vAlign=this.topLeftText.vTextAlign="top",this.topLeftText.positionY=-10,this.topLeftText.value=v.visualText.text,this.bottomLeftText.value=v.visualText.subText,this.bottomLeftText.visible=!0,this.bottomLeftText.positionX=this.topLeftText.positionX):"bottomLeft"in v.visualText&&(this.topLeftText.vAlign=this.topLeftText.vTextAlign="top",this.topLeftText.positionY=-10,this.topLeftText.value=v.visualText.topLeft,this.topRightText.value=v.visualText.topRight,this.bottomLeftText.value=v.visualText.bottomLeft,this.bottomRightText.value=v.visualText.bottomRight,this.topRightText.visible=!0,this.bottomLeftText.visible=!0,this.bottomRightText.visible=!0,this.bottomLeftText.positionX=this.topLeftText.positionX),A?this.clickableContainer.setOnClick(A):this.clickableContainer.clearOnClick()},e.prototype.setProperties=function(A){v.prototype.setProperties.call(this,A)},e.prototype.getProperty=function(A){return v.prototype.getProperty.call(this,A)},e.prototype.performClick=function(){this.clickableContainer.performClick()},e.DEFAULTS={topFontSize:14,bottomFontSize:14,imageSize:36,topTextColor:Color4.FromInts(14,16,60,255),bottomTextColor:Color4.FromInts(117,120,181,255)},e}(se),le=function(v){function e(A,E,R,O){var M=v.call(this,new UIContainerRect(A),o({},R))||this;M.onSuccessfulSelection=O,M.uiOptions=[],M.options={},R.visible,R.opacity,R.hAlign,R.vAlign,R.positionX,R.positionY;var V=n(R,["visible","opacity","hAlign","vAlign","positionX","positionY"]);M.config=q(e.DEFAULTS,V),M.setProperties({width:M.config.width,height:M.config.initialHeight,color:M.config.borderColor}),M.setItems(E.items,E.dropdownDefaultItemIds);var H=new UIContainerRect(M.shape);H.color=M.config.backgroundColor,H.width=M.config.width-2*M.config.borderSize,H.height=M.config.initialHeight-2*M.config.borderSize,M.insideContainer=H;var X=new ae(H,{vAlign:"top",hTextAlign:"left",vTextAlign:"center",width:"92%",fontSize:M.config.search.fontSize,placeholder:M.config.search.placeholder.defaultText,color:M.config.search.textColor,focusedBackground:Color4.Clear(),height:.95*M.config.initialHeight,onBlur:function(){return M.close()},onTextSubmit:function(){M.uiOptions[0].getProperty("visible")?M.uiOptions[0].performClick():M.close()},onChanged:function(v){if(M.hideAllOptions(),v===M.config.search.placeholder.defaultText||""===v)M.showDefaultOptions();else{var A=v.toLowerCase(),E=[];for(var R in M.options){var O=M.options[R];if(O.searchBy.toLowerCase().indexOf(A)>=0&&(E.push(O),E.length===M.config.options.maxVisibleOptions))break}E.length>0?M.showOptions(E):M.showErrorMessage("Sorry, we can't find \""+v+'"')}}});M.inputText=X;for(var Z=0;Z<M.config.options.maxVisibleOptions;Z++){var K=new ce(H,o(o({},M.config.options),{height:M.config.initialHeight,positionY:-M.config.initialHeight-M.config.initialHeight*Z,color:Z%2==0?M.config.options.oddBackgroundColor:H.color}));M.uiOptions.push(K)}var $=new UIImage(H,W);$.onClick=new OnClick((function(){return M.close()})),$.sourceTop=305,$.sourceLeft=985,$.sourceWidth=$.sourceHeight=35,$.width=$.height=18,$.hAlign="right",$.vAlign="top",$.positionX=-12,$.positionY=-12,$.visible=$.isPointerBlocker=!0;var J=new UIText(H);return J.height=20,J.visible=!1,J.width="92%",J.hTextAlign="center",J.vAlign="bottom",J.positionY=20,J.fontSize=M.config.errorMessage.fontSize,J.color=M.config.errorMessage.textColor,M.errorMessage=J,M}return i(e,v),e.prototype.open=function(){this.setProperties({visible:!0}),this.showDefaultOptions()},e.prototype.close=function(){this.setProperties({visible:!1}),this.inputText.reset()},e.prototype.setItems=function(v,A){this.options=v.reduce((function(v,A){var E;return A.searchBy=null!==(E=A.searchBy)&&void 0!==E?E:"string"==typeof A.visualText?A.visualText:"text"in A.visualText?A.visualText.text:A.visualText.topLeft,v[A.id]=A,v}),{}),A?this.setDropdownDefaults(A):this.defaultOptions=A,this.hideAllOptions()},e.prototype.setDropdownDefaults=function(v){var A,E;try{for(var R=r(v),O=R.next();!O.done;O=R.next()){var M=O.value;if(!(M in this.options))return void error("Couldn't find an option with id '"+M+"'. Will not set new defaults")}}catch(v){A={error:v}}finally{try{O&&!O.done&&(E=R.return)&&E.call(R)}finally{if(A)throw A.error}}this.defaultOptions=v},e.prototype.showDefaultOptions=function(){var v,A=this;if(this.defaultOptions)v=this.defaultOptions.map((function(v){return A.options[v]})).slice(0,this.config.options.maxVisibleOptions);else for(var E in v=[],this.options)if(v.push(this.options[E]),v.length===this.config.options.maxVisibleOptions)break;this.showOptions(v)},e.prototype.showOptions=function(v){var A=this;this.resizeHeight(this.config.initialHeight*v.length+2*this.config.borderSize),v.forEach((function(v,E){var R=A.uiOptions[E];R.setOption(v,(function(){A.onSuccessfulSelection(v),A.setProperties({visible:!1})})),R.setProperties({visible:!0})})),this.errorMessage.visible=!1},e.prototype.hideAllOptions=function(){this.uiOptions.forEach((function(v){return v.setProperties({visible:!1})}))},e.prototype.showErrorMessage=function(v){this.errorMessage.visible=!0,this.errorMessage.value=v,this.resizeHeight(60)},e.prototype.resizeHeight=function(v){this.setProperties({height:this.config.initialHeight+v}),this.insideContainer.height=this.config.initialHeight+v-2*this.config.borderSize},e.DEFAULTS={borderColor:Color4.FromInts(232,236,253,255),backgroundColor:Color4.White(),borderSize:2,width:300,initialHeight:60,search:{fontSize:16,textColor:Color4.FromInts(24,26,70,255),placeholder:{defaultText:"Click to search",textColor:Color4.FromInts(118,120,181,200)}},options:{maxVisibleOptions:5,oddBackgroundColor:Color4.FromInts(246,246,255,255),topFontSize:14,bottomFontSize:14,imageSize:36,topTextColor:Color4.FromInts(14,16,60,255),bottomTextColor:Color4.FromInts(117,120,181,255)},errorMessage:{fontSize:13,textColor:Color4.FromInts(125,127,157,255)}},e}(se),ue=function(v){function e(A,E,R,O){var M=v.call(this,new UIContainerRect(A),o({},R))||this;M.onSuccessfulSelection=O,R.visible,R.opacity,R.hAlign,R.vAlign,R.positionX,R.positionY;var V=n(R,["visible","opacity","hAlign","vAlign","positionX","positionY"]);M.config=q(le.DEFAULTS,V),M.setProperties({width:M.config.width,height:M.config.initialHeight,color:M.config.borderColor});var W=new he(M.shape,{color:M.config.backgroundColor,width:M.config.width-2*M.config.borderSize,height:M.config.initialHeight-2*M.config.borderSize,onClick:function(){return M.uiSearchPrompt.open()}}),H=new ce(W.shape,o(o({},M.config.options),{height:M.config.initialHeight,color:Color4.Clear(),width:M.config.width-2*M.config.borderSize-20,visible:!0,hAlign:"left",isPointerBlocker:!1})),X=new UIText(W.shape);if(X.value="Click to select an option",X.fontSize=M.config.search.fontSize,X.color=M.config.search.placeholder.textColor,X.vTextAlign=X.hTextAlign="center",X.positionX=-M.config.borderSize-10,X.isPointerBlocker=!1,X.opacity=X.color.a,M.initialText=X,null==E?void 0:E.initialItemId){var Z=E.items.filter((function(v){return v.id===E.initialItemId}))[0];Z&&(H.setOption(Z),M.initialText.visible=!1)}var K=new Texture("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABAAgMAAADXB5lNAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAN5AAADeQELGyzWAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlQTFRF////AAAAAAAAflGpXQAAAAJ0Uk5TAICbK04YAAAAeklEQVQ4je3PsRXEMAgE0VFCEapG9agaiiDRVXkJxlpq8IYT/AfwTbZ/ssPUEJgGZ2hYDTmgSIAiDoqsdskBRQIUcVBktXdO/jeVuBDPMBpRyEMUEhVMiUKKSOQlEokrmBKJXARsJWAqAaYEjEbAVgJmtGDewmjEt9wfISOqAUzY2sAAAAAASUVORK5CYII="),$=new UIImage(W.shape,K);return $.sourceWidth=$.sourceHeight=64,$.height=15,$.width=12,$.hAlign="right",$.vAlign="center",$.positionX=-10,$.visible=!0,$.isPointerBlocker=!1,M.uiSearchPrompt=new le(M.shape,E,o(o({},R),{visible:!1,vAlign:"top",initialHeight:M.config.initialHeight-2*M.config.borderSize}),(function(v){H.setOption(v),M.initialText.visible=!1,M.onSuccessfulSelection(v)})),M}return i(e,v),e.prototype.open=function(){this.setProperties({visible:!0})},e.prototype.close=function(){this.setProperties({visible:!1})},e.prototype.setSearchItems=function(v,A){this.uiSearchPrompt.setItems(v,A)},e.prototype.setSearchDropdownDefaults=function(v){this.uiSearchPrompt.setDropdownDefaults(v)},e}(se);v.CenterImage=Ht,v.CornerLabel=ne,v.CustomPrompt=Qt,v.CustomPromptButton=Zt,v.CustomPromptCheckBox=Kt,v.CustomPromptIcon=Jt,v.CustomPromptSwitch=$t,v.CustomPromptText=ee,v.CustomPromptTextBox=ie,v.FillInPrompt=qt,v.LargeIcon=Wt,v.LoadingIcon=oe,v.MediumIcon=Vt,v.OkPrompt=Gt,v.OptionPrompt=Yt,v.SFFont=M,v.SFHeavyFont=V,v.SmallIcon=Ut,v.UIBar=Ft,v.UICounter=it,v.UISearchPrompt=le,v.UISelectBox=ue,v.canvas=O,v.darkTheme=H,v.displayAnnouncement=function(v,E,R,O,M){X.visible=!0,X.value=v,X.color=R||Color4.Yellow(),X.fontSize=O||50,X.font=V,X.outlineColor=Color4.Black(),X.outlineWidth=M?0:.1,X.adaptWidth=!1,X.textWrapping=!0,X.width=900;var W=new Entity;engine.addEntity(W),-1!=E&&W.addComponentOrReplace(new A(E||3,(function(){X.visible=!1})))},v.hideAnnouncements=function(){X.visible=!1},v.lightTheme=W,Object.defineProperty(v,"__esModule",{value:!0})})),define("dcldash",["exports","@decentraland/RestrictedActions","@decentraland/ParcelIdentity","@decentraland/Identity","@decentraland/EnvironmentAPI"],(function(v,A,E,R,O){function __awaiter(v,A,E,R){return new(E||(E=Promise))((function(O,M){function fulfilled(v){try{step(R.next(v))}catch(v){M(v)}}function rejected(v){try{step(R.throw(v))}catch(v){M(v)}}function step(v){var A;v.done?O(v.value):(A=v.value,A instanceof E?A:new E((function(v){v(A)}))).then(fulfilled,rejected)}step((R=R.apply(v,A||[])).next())}))}const M=new Texture("https://pmacom.github.io/assets/dcldash/images/textures/boxHighlight.png"),V={1:[.6,.4,.9,.4,.9,.1,.6,.01,.6,.4,.9,.4,.9,.1,.6,.01],2:[0,.5,.5,.5,.5,0,0,0,0,.5,.5,.5,.5,0,0,0],3:[.5,1,.5,.5,0,.5,0,1,.5,1,.5,.5,0,.5,0,1],4:[0,.5,0,1,.5,1,.5,.5,0,.5,0,1,.5,1,.5,.5],5:[0,1,.5,1,.5,.5,0,.5,0,1,.5,1,.5,.5,0,.5],6:[.5,.5,0,.5,0,1,.5,1,.5,.5,0,.5,0,1,.5,1]};let W=class{constructor(v=1){this.speed=v}};W=function(v,A,E,R){var O,M=arguments.length,V=M<3?A:null===R?R=Object.getOwnPropertyDescriptor(A,E):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)V=Reflect.decorate(v,A,E,R);else for(var W=v.length-1;W>=0;W--)(O=v[W])&&(V=(M<3?O(V):M>3?O(A,E,V):O(A,E))||V);return M>3&&V&&Object.defineProperty(A,E,V),V}([Component("BoxHighlightAnimation")],W);const getTransform=(v,A,E=!1)=>{let R=.5*(E?-1:1),O="x"==A?90:0,M="y"==A?90:0,V="z"==A?90:0;return new Transform({position:new Vector3("x"==v?R:0,"y"==v?R:0,"z"==v?R:0),scale:new Vector3(1,1,1),rotation:(new Quaternion).setEuler(O,M,V)})};
/*!
     * Creates an animated cube to highlight something in DCL
     * it can be rotated to point in a predetermined direction
     * @public
     */class Dash_BoxHighlight extends Entity{constructor(v,A,E="top",R=!0,O,W){super(),this.position=v,this.scale=A,this.dir=E,this.visible=R,this.texture=O,this.onClick=W,this.timer=0,this.duration=3,this.sideTopEntity=new Entity,this.sideTopShape=new PlaneShape,this.sideBottomEntity=new Entity,this.sideBottomShape=new PlaneShape,this.sideNorthEntity=new Entity,this.sideNorthShape=new PlaneShape,this.sideSouthEntity=new Entity,this.sideSouthShape=new PlaneShape,this.sideEastEntity=new Entity,this.sideEastShape=new PlaneShape,this.sideWestEntity=new Entity,this.sideWestShape=new PlaneShape,this.stripeMaterial=new Material,this.surfaceMaterial=new Material;let H=O||M;this.stripeMaterial.roughness=1,this.stripeMaterial.emissiveColor=new Color3(0,.5,1),this.stripeMaterial.albedoTexture=H,this.stripeMaterial.alphaTexture=H,this.stripeMaterial.castShadows=!1,this.surfaceMaterial.roughness=1,this.surfaceMaterial.emissiveColor=new Color3(10,0,0),this.surfaceMaterial.albedoTexture=H,this.surfaceMaterial.alphaTexture=H,this.surfaceMaterial.castShadows=!1,this.sides=[{shape:this.sideBottomShape,entity:this.sideBottomEntity,transform:getTransform("y","x"),startUVs:V[1],dir:{top:{points:V[1]},bottom:{points:V[2],isSurface:!0},north:{points:V[3],animate:!0},south:{points:V[4],animate:!0},east:{points:V[5],animate:!0},west:{points:V[6],animate:!0}}},{shape:this.sideTopShape,entity:this.sideTopEntity,transform:getTransform("y","x",!0),startUVs:V[1],dir:{top:{points:V[2],isSurface:!0},bottom:{points:V[1]},north:{points:V[3],animate:!0},south:{points:V[4],animate:!0},east:{points:V[5],animate:!0},west:{points:V[6],animate:!0}}},{shape:this.sideWestShape,entity:this.sideWestEntity,transform:getTransform("z",""),startUVs:V[1],dir:{top:{points:V[6],animate:!0},bottom:{points:V[5],animate:!0},north:{points:V[3],animate:!0},south:{points:V[4],animate:!0},east:{points:V[2],isSurface:!0},west:{points:V[1]}}},{shape:this.sideEastShape,entity:this.sideEastEntity,transform:getTransform("z","",!0),startUVs:V[1],dir:{top:{points:V[6],animate:!0},bottom:{points:V[5],animate:!0},north:{points:V[3],animate:!0},south:{points:V[4],animate:!0},east:{points:V[1]},west:{points:V[2],isSurface:!0}}},{shape:this.sideNorthShape,entity:this.sideNorthEntity,transform:getTransform("x","y"),startUVs:V[1],dir:{top:{points:V[6],animate:!0},bottom:{points:V[5],animate:!0},north:{points:V[1]},south:{points:V[2],isSurface:!0},east:{points:V[3],animate:!0},west:{points:V[4],animate:!0}}},{shape:this.sideSouthShape,entity:this.sideSouthEntity,transform:getTransform("x","y",!0),startUVs:V[1],dir:{top:{points:V[6],animate:!0},bottom:{points:V[5],animate:!0},north:{points:V[2],isSurface:!0},south:{points:V[1]},east:{points:V[3],animate:!0},west:{points:V[4],animate:!0}}}],this.addComponent(new Transform({position:v,scale:A})),R&&this.show(),this.setSides()}setSides(){this.sides.forEach((v=>{let{shape:A,entity:E,transform:R,dir:O}=v,{points:M,isSurface:V}=v.dir[this.dir];E.addComponentOrReplace(A),E.addComponentOrReplace(R),V||E.addComponentOrReplace(this.stripeMaterial),E.addComponentOrReplace(V?this.surfaceMaterial:this.stripeMaterial),A.withCollisions=!1,V&&this.onClick&&E.addComponent(this.onClick),v.startUVs=M,A.uvs=v.startUVs,E.setParent(this)}))}setScale(v,A,E){this.getComponent(Transform).scale.set(v,A,E)}setPosition(v,A,E){this.getComponent(Transform).position.set(v,A,E)}setDirection(v){this.dir=v,this.setSides()}setTexture(v){this.stripeMaterial.albedoTexture=v,this.stripeMaterial.alphaTexture=v,this.surfaceMaterial.albedoTexture=v,this.surfaceMaterial.alphaTexture=v}setStripeColor(v){this.stripeMaterial.emissiveColor=v}setSurfaceColor(v){this.surfaceMaterial.emissiveColor=v}show(){this.addComponentOrReplace(new W),engine.addEntity(this),engine.addSystem(X)}hide(){this.removeComponent(W),engine.removeEntity(this)}updateUV(v){this.timer=this.timer>=this.duration?0:this.timer+v,this.sides.forEach((v=>{v.shape.uvs&&v.dir[this.dir].animate&&(v.shape.uvs=lerpUVs(v.startUVs,this.timer,this.duration))}))}}const lerpUVs=(v,A,E)=>{let R=Scalar.Clamp(A/E,0,1),O=[Scalar.Lerp(v[0],v[0]+.5,R),Scalar.Lerp(v[1],v[1],R),Scalar.Lerp(v[2],v[2]+.5,R),Scalar.Lerp(v[3],v[3],R),Scalar.Lerp(v[4],v[4]+.5,R),Scalar.Lerp(v[5],v[5],R),Scalar.Lerp(v[6],v[6]+.5,R),Scalar.Lerp(v[7],v[7],R)];return O.concat(O)},H=engine.getComponentGroup(W),X=new class{constructor(){this.system=this}update(v){H.entities.length||this.system.active&&engine.removeSystem(this.system),H.entities.forEach((A=>{A.updateUV(v)}))}},Dash_CheckWithinVolume=(v,A,E)=>{const{x:R,y:O,z:M}=v,{x:V,y:W,z:H}=A,{x:X,y:Z,z:K}=E,$=new Vector3(R-V/2,O-W/2,M-H/2),J=new Vector3(R+V/2,O+W/2,M+H/2);return X>$.x&&X<J.x&&Z>$.y&&Z<J.y&&K>$.z&&K<J.z},Z=new class{transparent(){return this._transparent||(this._transparent=new Material,this._transparent.albedoColor=new Color4(0,0,0,0),this._transparent.castShadows=!1),this._transparent}Red(){return this._Red||(this._Red=new Material,this._Red.albedoColor=new Color4(1,0,0,.5)),this._Red}Green(){return this._Green||(this._Green=new Material,this._Green.albedoColor=new Color4(0,1,0,.5)),this._Green}Blue(){return this._Blue||(this._Blue=new Material,this._Blue.albedoColor=new Color4(0,0,1,.5)),this._Blue}Black(){return this._Black||(this._Black=new Material,this._Black.albedoColor=new Color4(0,0,0,.5)),this._Black}},K=new class{constructor(){this.nonce=0,this.queue=new Map,this.system=this}add(v){const A={id:this.nonce++,onFrame:v};return{start:()=>{this.queue.set(A.id,A),this.enable()},stop:()=>{this.queue.delete(A.id)}}}update(v){this.queue.size||this.disable(),this.queue.forEach((A=>{const{id:E,onFrame:R}=A;R&&R(v)}))}enable(){this.system.active||engine.addSystem(this)}disable(){this.system.active&&engine.removeSystem(this)}};class Dash_TriggerZone extends Entity{constructor(){super(),this.onEnter=()=>{},this.onExit=()=>{},this.hasEntered=!1,engine.addEntity(this),this.checkCollision=K.add((()=>this.check())),this.checkCollision.start()}check(){let v=this.getParent(),A=new Vector3,E=new Vector3,R=new Quaternion;do{if(v){let O=v.getComponentOrCreate(Transform);A.addInPlace(O.position.clone()),E.addInPlace(O.scale.clone()),R.eulerAngles.addInPlace(O.eulerAngles),v=v.getParent()}}while(v&&"0"!==v.uuid);const O=this.getComponentOrCreate(Transform);this.getParent();const M=Dash_CheckWithinVolume(Vector3.Add(A,O.position),Vector3.Add(E,O.scale),new Vector3(Camera.instance.feetPosition.x,Camera.instance.feetPosition.y,Camera.instance.feetPosition.z));M&&!this.hasEntered?(this.onEnter(),this.debug&&this.debug.showHighlight(),this.hasEntered=!0):!M&&this.hasEntered&&(this.onExit(),this.debug&&this.debug.hideHighlight(),this.hasEntered=!1)}enableDebug(){this.debug=new TriggerDebug(this),this.debug.show()}enable(){var v;null===(v=this.checkCollision)||void 0===v||v.start()}disable(){var v;null===(v=this.checkCollision)||void 0===v||v.stop()}}class TriggerDebug extends Entity{constructor(v,A){super(),this.setParent(v),this.boxHighlight=new Dash_BoxHighlight(new Vector3,(new Vector3).setAll(1),"top"),this.boxHighlight.setParent(v),this.boxHighlight.show()}show(){this.shape=new BoxShape,this.shape.withCollisions=!1,this.material=Z.Red(),this.boxHighlight.setStripeColor(Color3.Red()),this.addComponentOrReplace(this.shape),this.addComponentOrReplace(this.material)}showHighlight(){this.material=Z.Green(),this.boxHighlight.setStripeColor(Color3.Green()),this.addComponentOrReplace(this.material)}hideHighlight(){this.material=Z.Red(),this.boxHighlight.setStripeColor(Color3.Red()),this.addComponentOrReplace(this.material)}}class DynamicImage{constructor(v){this.image=v,this.tweens=new Map,this.animation=K.add((v=>this.update(v)))}fadeIn(v,A,E){this.tweens.set("opacity",{timer:0,settings:{from:0,to:1,duration:v,ease:A,callback:E}}),this.animation.start()}fadeOut(v,A,E){this.tweens.set("opacity",{timer:0,settings:{from:this.image.opacity,to:0,duration:v,ease:A,callback:E}}),this.animation.start()}fadeTo(v,A,E,R){this.tweens.set("opacity",{timer:0,settings:{from:this.image.opacity,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}moveTo(v,A,E,R,O){this.tweens.set("positionX",{timer:0,settings:{from:this.image.positionX,to:v,duration:E,ease:R,callback:O}}),this.tweens.set("positionY",{timer:0,settings:{from:this.image.positionY,to:A,duration:E,ease:R,callback:O}}),this.animation.start()}moveToX(v,A,E,R){this.tweens.set("positionX",{timer:0,settings:{from:this.image.positionX,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}moveToY(v,A,E,R){this.tweens.set("positionY",{timer:0,settings:{from:this.image.positionY,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}moveRelativeTo(v,A,E,R,O){this.tweens.set("positionX",{timer:0,settings:{from:this.image.positionX,to:new UIValue(this.image.positionX).value+new UIValue(v).value,duration:E,ease:R,callback:O}}),this.tweens.set("positionY",{timer:0,settings:{from:this.image.positionY,to:new UIValue(this.image.positionY).value+new UIValue(A).value,duration:E,ease:R,callback:O}}),this.animation.start()}resizeTo(v,A,E,R,O){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:v,duration:E,ease:R,callback:O}}),this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:A,duration:E,ease:R,callback:O}}),this.animation.start()}resizeWidthTo(v,A,E,R){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}resizeHeightTo(v,A,E,R){this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}moveSourceTo(v,A,E,R,O){this.tweens.set("sourceLeft",{timer:0,settings:{from:this.image.sourceLeft,to:v,duration:E,ease:R,callback:O}}),this.tweens.set("sourceTop",{timer:0,settings:{from:this.image.sourceTop,to:A,duration:E,ease:R,callback:O}}),this.animation.start()}moveSourceLeftTo(v,A,E,R){this.tweens.set("sourceLeft",{timer:0,settings:{from:this.image.sourceLeft,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}moveSourceTopTo(v,A,E,R){this.tweens.set("sourceTop",{timer:0,settings:{from:this.image.sourceTop,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}resizeSourceTo(v,A,E,R,O){this.tweens.set("sourceWidth",{timer:0,settings:{from:this.image.sourceWidth,to:v,duration:E,ease:R,callback:O}}),this.tweens.set("sourceHeight",{timer:0,settings:{from:this.image.sourceHeight,to:A,duration:E,ease:R,callback:O}}),this.animation.start()}resizeSourceWidthTo(v,A,E,R){this.tweens.set("sourceWidth",{timer:0,settings:{from:this.image.sourceWidth,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}resizeSourceHeightTo(v,A,E,R){this.tweens.set("sourceHeight",{timer:0,settings:{from:this.image.sourceHeight,to:v,duration:A,ease:E,callback:R}}),this.animation.start()}scaleIn(v,A,E,R){this.tweens.set("width",{timer:0,settings:{from:new UIValue(this.image.width).value*new UIValue(v).value,to:this.image.width,duration:A,ease:E,callback:R}}),this.tweens.set("height",{timer:0,settings:{from:new UIValue(this.image.height).value*new UIValue(v).value,to:this.image.height,duration:A,ease:E,callback:R}}),this.tweens.set("opacity",{timer:0,settings:{from:0,to:this.image.opacity,duration:A,ease:E,callback:R}}),this.animation.start()}scaleOut(v,A,E,R){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:new UIValue(this.image.width).value*new UIValue(v).value,duration:A,ease:E,callback:R}}),this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:new UIValue(this.image.height).value*new UIValue(v).value,duration:A,ease:E,callback:R}}),this.tweens.set("opacity",{timer:0,settings:{from:this.image.opacity,to:0,duration:A,ease:E,callback:R}}),this.animation.start()}scaleTo(v,A,E,R){this.tweens.set("width",{timer:0,settings:{from:this.image.width,to:new UIValue(this.image.width).value*v,duration:A,ease:E,callback:R}}),this.tweens.set("height",{timer:0,settings:{from:this.image.height,to:new UIValue(this.image.width).value*v,duration:A,ease:E,callback:R}}),this.animation.start()}update(v){this.tweens.size?this.tweens.forEach(((A,E)=>{const{settings:R}=A,{duration:O,callback:M}=R;let V,W,H,X;switch(A.timer+=v,A.timer>=O&&(M&&M(),this.tweens.delete(E)),E){case"opacity":case"sourceLeft":case"sourceTop":case"sourceWidth":case"sourceHeight":if(V=new UIValue(R.from),W=new UIValue(R.to),A.timer>=O){this.image[E]=W.value;break}H=R.ease?R.ease(A.timer/O):A.timer/O,this.image[E]=Scalar.Lerp(V.value,W.value,H);break;case"width":case"height":case"positionX":case"positionY":if(V=new UIValue(R.from),W=new UIValue(R.to),A.timer>=O){this.image[E]=1==V.type||1==W.type?W.value:`${W.value}%`;break}H=R.ease?R.ease(A.timer/O):A.timer/O,X=Scalar.Lerp(V.value,W.value,H),this.image[E]=1==V.type||1==W.type?X:`${X}%`}})):this.animation.stop()}}const easeOutBounce=v=>{const A=7.5625,E=2.75;return v<1/E?A*v*v:v<2/E?A*(v-=1.5/E)*v+.75:v<2.5/E?A*(v-=2.25/E)*v+.9375:A*(v-=2.625/E)*v+.984375},$=new class{easeInSine(v){return 1-Math.cos(v*Math.PI/2)}easeOutSine(v){return Math.sin(v*Math.PI/2)}easeInOutSine(v){return-(Math.cos(Math.PI*v)-1)/2}easeInCubic(v){return v*v*v}easeOutCubic(v){return 1-Math.pow(1-v,3)}easeInOutCubic(v){return v<.5?4*v*v*v:1-Math.pow(-2*v+2,3)/2}easeInQuint(v){return v*v*v*v*v}easeOutQuint(v){return 1-Math.pow(1-v,5)}easeInOutQuint(v){return v<.5?16*v*v*v*v*v:1-Math.pow(-2*v+2,5)/2}easeInCirc(v){return 1-Math.sqrt(1-Math.pow(v,2))}easeOutCirc(v){return Math.sqrt(1-Math.pow(v-1,2))}easeInOutCirc(v){return v<.5?(1-Math.sqrt(1-Math.pow(2*v,2)))/2:(Math.sqrt(1-Math.pow(-2*v+2,2))+1)/2}easeInElastic(v){const A=2*Math.PI/3;return 0===v?0:1===v?1:-Math.pow(2,10*v-10)*Math.sin((10*v-10.75)*A)}easeOutElastic(v){const A=2*Math.PI/3;return 0===v?0:1===v?1:Math.pow(2,-10*v)*Math.sin((10*v-.75)*A)+1}easeInOutElastic(v){const A=2*Math.PI/4.5;return 0===v?0:1===v?1:v<.5?-Math.pow(2,20*v-10)*Math.sin((20*v-11.125)*A)/2:Math.pow(2,-20*v+10)*Math.sin((20*v-11.125)*A)/2+1}easeInQuad(v){return v*v}easeOutQuad(v){return 1-(1-v)*(1-v)}easeInOutQuad(v){return v<.5?2*v*v:1-Math.pow(-2*v+2,2)/2}easeInQuart(v){return v*v*v*v}easeOutQuart(v){return 1-Math.pow(1-v,4)}easeInOutQuart(v){return v<.5?8*v*v*v*v:1-Math.pow(-2*v+2,4)/2}easeInExpo(v){return 0===v?0:Math.pow(2,10*v-10)}easeOutExpo(v){return 1===v?1:1-Math.pow(2,-10*v)}easeInOutExpo(v){return 0===v?0:1===v?1:v<.5?Math.pow(2,20*v-10)/2:(2-Math.pow(2,-20*v+10))/2}easeInBack(v){return 2.70158*v*v*v-1.70158*v*v}easeOutBack(v){return 1+2.70158*Math.pow(v-1,3)+1.70158*Math.pow(v-1,2)}easeInOutBack(v){const A=2.5949095;return v<.5?Math.pow(2*v,2)*(7.189819*v-A)/2:(Math.pow(2*v-2,2)*((A+1)*(2*v-2)+A)+2)/2}easeInBounce(v){return(v=>1-easeOutBounce(1-v))(v)}easeOutBounce(v){return easeOutBounce(v)}easeInOutBounce(v){return(v=>v<.5?(1-easeOutBounce(1-2*v))/2:(1+easeOutBounce(2*v-1))/2)(v)}};var J;!function(v){v[v.HALIGN_LEFT=0]="HALIGN_LEFT",v[v.HALIGN_CENTER=1]="HALIGN_CENTER",v[v.HALIGN_RIGHT=2]="HALIGN_RIGHT",v[v.VALIGN_TOP=3]="VALIGN_TOP",v[v.VALIGN_CENTER=4]="VALIGN_CENTER",v[v.VALIGN_BOTTOM=5]="VALIGN_BOTTOM"}(J||(J={}));const Dash_UV_Plane_Crop_Image=(v,A,E,R,O,M,V)=>{let W=Scalar.InverseLerp(0,v,O),H=Scalar.InverseLerp(0,A,M),X=Scalar.InverseLerp(0,v,E),Z=Scalar.InverseLerp(0,A,R),K={x:W,y:1-H},$={x:W+X,y:1-H},J={x:W+X,y:1-H-Z},et={x:W,y:1-H-Z},it=V?[K.x,K.y,$.x,$.y,J.x,J.y,et.x,et.y]:[et.x,et.y,J.x,J.y,$.x,$.y,K.x,K.y];return[...it,...it]};class Dash_SimplePoster extends Entity{constructor(){super(),this.shape=new PlaneShape,this.material=new Material,this.hyperlink=null,this.addComponent(this.shape),this.addComponent(this.material),this.addComponent(new Transform),this.shape.uvs=[1,0,0,0,0,1,1,1,0,0,1,0,1,1,0,1]}setHyperlink(v){this.hyperlink=v,this.addComponentOrReplace(new OnPointerDown((v=>{this.hyperlink&&openExternalURL(this.hyperlink)})))}setImageUrl(v){this.texture=new Texture(v),this.material.albedoTexture=this.texture,this.material.emissiveColor=Color3.White(),this.material.emissiveTexture=this.texture,this.material.emissiveIntensity=1,this.addComponentOrReplace(this.material)}show(){this.alive||engine.addEntity(this)}hide(){this.alive&&engine.removeEntity(this)}}const Dash_GetSceneData=()=>__awaiter(void 0,void 0,void 0,(function*(){const v=yield E.getParcel(),A=v.land.sceneJsonData.scene.base,R=v.land.sceneJsonData.scene.parcels;return{base:A,parcels:R,maxHeight:Math.ceil(Math.log(R.length+1)*Math.LOG2E*20)}})),et=new Texture("https://pmacom.github.io/assets/dcldash/images/landBarrier/barrier-sprite.png",{hasAlpha:!1,samplingMode:0,wrap:1}),it=new Material;it.albedoTexture=et,it.emissiveColor=Color3.White(),it.emissiveTexture=et,it.emissiveIntensity=5,it.transparencyMode=2;const nt=it,ot=1024,rt=86,st={comingsoon:{sourcePositionTop:9,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},privateevent:{sourcePositionTop:104,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},accountrequired:{sourcePositionTop:198,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},nftrequired:{sourcePositionTop:293,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},temporarilylocked:{sourcePositionTop:388,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},outdated:{sourcePositionTop:482,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},undermaintenance:{sourcePositionTop:577,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},loadfully:{sourcePositionTop:671,sourcePositionLeft:0,sourceWidth:ot,sourceHeight:rt},transparent:{sourcePositionTop:924,sourcePositionLeft:0,sourceWidth:100,sourceHeight:100}};class BarrierZone extends Entity{constructor(v,E="privateevent",R,O,M,V,W,H){if(super(),this.material=v,this.message=E,this.maxHeight=R,this.exitLocation=O,this.shapes=[],this.collider=new Entity,this.colliderShape=new BoxShape,this.triggerZone=new Dash_TriggerZone,this.collider.addComponent(this.colliderShape),this.collider.addComponent(Z.transparent()),this.collider.addComponent(new Transform({scale:new Vector3(16,8,16)})),this.collider.setParent(this),this.triggerZone.addComponent(new Transform({position:new Vector3(0,7,0),scale:new Vector3(16,16,16)})),this.triggerZone.onEnter=()=>{const{x:v,y:E,z:R}=this.exitLocation;A.movePlayerTo({x:v,y:E,z:R})},this.triggerZone.setParent(this),this.addComponent(new Transform({position:new Vector3(0,0,0)})),W){const A=new BarrierPlane(new Vector3(0,1,8),0,this.message);A.addComponent(v),this.shapes.push(A.shape),A.setParent(this)}if(H){const A=new BarrierPlane(new Vector3(0,1,-8),180,this.message);A.addComponent(v),this.shapes.push(A.shape),A.setParent(this)}if(V){const A=new BarrierPlane(new Vector3(8,1,0),90,this.message);A.addComponent(v),this.shapes.push(A.shape),A.setParent(this)}if(M){const A=new BarrierPlane(new Vector3(-8,1,0),-90,this.message);A.addComponent(v),this.shapes.push(A.shape),A.setParent(this)}this.animation=K.add((v=>{this.shapes.forEach((A=>{let E=A.uvs.map(((A,E)=>E%2==0?A+.05*v:A));A.uvs=E}))})),this.animation.start(),engine.addEntity(this)}setMessage(v){this.shapes.forEach((A=>{if(st[v]){const E=st[v],{sourceHeight:R,sourceWidth:O,sourcePositionLeft:M,sourcePositionTop:V}=E;A.uvs=Dash_UV_Plane_Crop_Image(1024,1024,O,R,M,V)}}))}setExitLocation(v){this.exitLocation=v}disable(){this.triggerZone.disable()}enable(){this.triggerZone.enable()}}class BarrierPlane extends Entity{constructor(v,A=0,E){super(),this.shape=new PlaneShape,this.addComponent(this.shape),this.shape.withCollisions=!1,this.setMessage(E),this.addComponent(new Transform({position:v,scale:new Vector3(16,1,1),rotation:(new Quaternion).setEuler(0,A,0)}))}setMessage(v){if(st[v]){const A=st[v],{sourceHeight:E,sourceWidth:R,sourcePositionLeft:O,sourcePositionTop:M}=A;this.shape.uvs=Dash_UV_Plane_Crop_Image(1024,1024,R,E,O,M)}}}const at=new MessageBus,ht=new Map;class ParcelHideAvatar extends Entity{constructor(){super(),this.addComponent(new Transform),engine.addEntity(this)}}const ct=new class{constructor(){this.parcelHideAvatars=[],this.zones=new Map,this.currentZone="primaryZone",this.setupMessages(),executeTask((()=>__awaiter(this,void 0,void 0,(function*(){const{base:v,parcels:A,maxHeight:E}=yield Dash_GetSceneData(),O=yield R.getUserData();this.userId=O.userId,this.zones.set("primaryZone",new Set),this.parcelSize=new Vector3(16,E,16);const M=v.split(",");this.base=new Vector2(parseInt(M[0]),parseInt(M[1])),A.forEach(((v,A)=>{const E=v.split(","),R=new Vector2(parseInt(E[0]),parseInt(E[1])),O=new Vector2(R.x-this.base.x,R.y-this.base.y),M=new Vector3(16*O.x+8,1,16*O.y+8),V=this.parcelSize,W=new ParcelHideAvatar;W.addComponentOrReplace(new Transform({position:M,scale:V})),this.parcelHideAvatars.push(W)})),onEnterSceneObservable.add((v=>{v.userId==this.userId&&(at.emit("dash-zone-enter",{userId:this.userId,zoneName:"primaryZone"}),this.addUserToZone("primaryZone",v.userId))})),onLeaveSceneObservable.add((v=>{v.userId==this.userId&&(at.emit("dash-zone-exit",{userId:this.userId,zoneName:"primaryZone"}),this.addUserToZone("primaryZone",v.userId))})),onPlayerConnectedObservable.add((({userId:v})=>{at.emit("dash-zone-query",{userId:this.userId})})),onPlayerDisconnectedObservable.add((({userId:v})=>{this.removeUserFromAllZones(v)})),at.emit("dash-zone-query",{userId:this.userId})}))))}removeUserFromAllZones(v){this.zones.forEach(((A,E)=>{A.delete(v)}))}addUserToZone(v,A){A==this.userId?this.currentZone=v:(this.removeUserFromAllZones(A),this.zones.has(v)?this.zones.get(v).add(A):this.zones.set(v,new Set([A]))),this.updateParcelHideAvatars()}getUserIdsForZone(v){const A=[];return(this.zones.has(v)?this.zones.get(v):new Set).forEach((v=>A.push(v))),[this.userId,...A]}updateParcelHideAvatars(){const v=this.getUserIdsForZone(this.currentZone);this.parcelHideAvatars.forEach((A=>{A.addComponentOrReplace(new AvatarModifierArea({area:{box:this.parcelSize},modifiers:[AvatarModifiers.HIDE_AVATARS],excludeIds:v}))}))}setupMessages(){at.on("dash-zone-query",(({userId:v})=>{v!==this.userId&&at.emit("dash-zone-enter",{userId:this.userId,zoneName:this.currentZone})})),at.on("dash-zone-enter",(({userId:v,zoneName:A})=>{v!==this.userId&&this.addUserToZone(A,v)})),at.on("dash-zone-exit",(({userId:v,zoneName:A})=>{v!==this.userId&&this.addUserToZone("primaryZone",v)}))}};class Dash_Zone extends Entity{constructor(v,A){super(),this.zoneName=v,this.transform=A,this.triggerZone=new Dash_TriggerZone,this.inZone=!1,this.excludeIds=new Set,this.excludeIdsArray=[],ht.set(v,this),this.addComponent(A),engine.addEntity(this),executeTask((()=>__awaiter(this,void 0,void 0,(function*(){let v=yield R.getUserData();this.userId=v.userId,this.setupTriggerZone()}))))}setupTriggerZone(){this.triggerZone.enable(),this.triggerZone.addComponent(this.transform),this.triggerZone.onEnter=()=>this.onEnter(),this.triggerZone.onExit=()=>this.onExit()}onEnter(){ct.addUserToZone(this.zoneName,this.userId),at.emit("dash-zone-enter",{userId:this.userId,zoneName:this.zoneName})}onExit(){ct.addUserToZone("primaryZone",this.userId),at.emit("dash-zone-exit",{userId:this.userId,zoneName:this.zoneName})}enable(){this.triggerZone.enable()}disable(){this.triggerZone.disable()}enableDebug(){this.triggerZone.enableDebug()}}class Dash_ZoneMaker extends Entity{constructor(v){super(),this.startPosition=v,this.shape=new BoxShape,this.material=new Material,this.minPosition=new Vector3,this.maxPosition=new Vector3,this.initialFeetPosition=new Vector3,this.hasMoved=!1,this.isOn=!1,this.bh=new Dash_BoxHighlight(new Vector3,(new Vector3).setAll(1),"top"),this.bh.setParent(this),this.addComponent(this.shape),this.addComponent(new Transform({position:this.startPosition.clone(),scale:new Vector3(1,1,1)})),this.shape.withCollisions=!1,engine.addEntity(this),this.material.albedoColor=new Color4(0,1,1,.1),this.addComponent(this.material);const A=K.add((()=>{const v=Camera.instance.feetPosition;if(!this.hasMoved&&Vector3.Distance(v,this.initialFeetPosition)>.1&&(this.hasMoved=!0),this.hasMoved){const{x:A,y:E,z:R}=v,{x:O,y:M,z:V}=this.minPosition,{x:W,y:H,z:X}=this.maxPosition,Z=this.startPosition.x-A,K=this.startPosition.y-E,$=this.startPosition.z-R;Z<O&&(this.minPosition.x=Z),K<M&&(this.minPosition.y=K),$<V&&(this.minPosition.z=$),Z>W&&(this.maxPosition.x=Z),K>H&&(this.maxPosition.y=K),$>X&&(this.maxPosition.z=$);const J=Vector3.Add(this.minPosition.negate(),this.startPosition),et=Vector3.Add(this.maxPosition.negate(),this.startPosition),it=Vector3.Center(J,et);this.getComponent(Transform).position=Vector3.Add(it,new Vector3(0,.75,0)),this.getComponent(Transform).scale=new Vector3(this.maxPosition.x-this.minPosition.x,this.maxPosition.y-this.minPosition.y+1.5,this.maxPosition.z-this.minPosition.z)}}));this.addComponent(new OnPointerDown((()=>{if(this.isOn){A.stop();const v=this.getComponent(Transform).position,E=this.getComponent(Transform).scale;log(`Zone Transform: \nposition: new Vector3(${v.x}, ${v.y}, ${v.z}),\nscale: new Vector3(${E.x}, ${E.y}, ${E.z})`),this.isOn=!1}else this.hasMoved=!1,this.initialFeetPosition=Camera.instance.feetPosition.clone(),A.start(),this.isOn=!0})))}}const lt=new class{constructor(){this.nonce=0,this.queue=new Map,this.system=this}add(v){return v.id=this.nonce++,this.queue.set(v.id,v),this.enable(),v}update(v){this.queue.size||this.disable(),this.queue.forEach((A=>{const{id:E,onFrame:R,onComplete:O,duration:M,data:V}=A;A.timer||(A.timer=0),A.timer+=v;const W=A.timer/M;R&&R(W,V),A.timer>=M&&(R&&R(1,V),O&&O(),this.queue.delete(E))}))}enable(){this.system.active||engine.addSystem(this)}disable(){this.system.active&&engine.removeSystem(this)}},ut=new UICanvas,pt=new class{constructor(){this.textures=new Map}create(v){if(this.textures.has(v))return this.textures.get(v);const A=new Texture(v);return this.textures.set(v,A),A}},dt=new class{constructor(){this.clips=new Map}create(v){if(this.clips.has(v))return this.clips.get(v);const A=new VideoClip(v);return this.clips.set(v,A),A}},gt=new class{constructor(){this.videoTextures=new Map}create(v){if(this.videoTextures.has(v))return this.videoTextures.get(v);const A=dt.create(v),E=new VideoTexture(A);return this.videoTextures.set(v,E),E}},ft=new class{constructor(){this.videoMaterials=new Map}create(v){if(this.videoMaterials.has(v))return this.videoMaterials.get(v);const A=gt.create(v),E=new Material;return E.albedoTexture=A,E.emissiveColor=Color3.White(),E.emissiveTexture=A,this.videoMaterials.set(v,E),E}};class Dash_UI_AdminRadioButton{constructor(v,A,E,R,O,M,V=!1){this.texture=v,this.value=A,this.renderSettings=E,this.onButtonSettings=R,this.offButtonSettings=O,this.onChange=M,this.isActive=V,this.image=new UIImage(ut,this.texture),this.image.onClick=new OnPointerDown((()=>{this.onChange(this.value)})),this.image.positionX=E.positionX,this.image.positionY=E.positionY,this.image.width=E.width,this.image.height=E.height,this.setValues(this.isActive?R:O)}setValues(v){this.image.sourceLeft=v.positionX,this.image.sourceTop=v.positionY,this.image.sourceWidth=v.width,this.image.sourceHeight=v.height,this.image.vAlign="top",this.image.hAlign="left"}turnOn(){this.setValues(this.onButtonSettings)}turnOff(){this.setValues(this.offButtonSettings)}}class Dash_UI_AdminRadioButton_Group{constructor(v,A,E){this.update=E,this.mapping=new Map,this.value="1",Object.keys(A).forEach((E=>{const R=A[E],{on:O,off:M,renderSettings:V}=R,W=new Dash_UI_AdminRadioButton(v,E,V,O,M,(v=>{this.mapping.forEach(((A,E)=>{`${v}`==`${E}`?A.turnOn():A.turnOff()})),this.update(v)}));E==this.value&&W.turnOn(),this.mapping.set(E,W)}))}setValue(v){this.value=v,this.mapping.forEach(((A,E)=>{`${v}`==`${E}`?A.turnOn():A.turnOff()}))}hide(){this.mapping.forEach((v=>{v.image.visible=!1}))}show(){this.mapping.forEach((v=>{v.image.visible=!0}))}}class Dash_Admin_Tweaker_InfoDetails{constructor(v){this.detailValues=new Map;const A=new InfoDetailValue(v,"position.x");A.text.positionX=129,A.text.positionY=52,this.detailValues.set("position.x",A);const E=new InfoDetailValue(v,"position.y");E.text.positionX=129,E.text.positionY=32,this.detailValues.set("position.y",E);const R=new InfoDetailValue(v,"position.z");R.text.positionX=129,R.text.positionY=12,this.detailValues.set("position.z",R);const O=new InfoDetailValue(v,"scale.x");O.text.positionX=176,O.text.positionY=52,this.detailValues.set("scale.x",O);const M=new InfoDetailValue(v,"scale.y");M.text.positionX=176,M.text.positionY=32,this.detailValues.set("scale.y",M);const V=new InfoDetailValue(v,"scale.z");V.text.positionX=176,V.text.positionY=12,this.detailValues.set("scale.z",V);const W=new InfoDetailValue(v,"rotation.eulerAngles.x");W.text.positionX=223,W.text.positionY=52,this.detailValues.set("rotation.eulerAngles.x",W);const H=new InfoDetailValue(v,"rotation.eulerAngles.y");H.text.positionX=223,H.text.positionY=32,this.detailValues.set("rotation.eulerAngles.y",H);const X=new InfoDetailValue(v,"rotation.eulerAngles.z");X.text.positionX=223,X.text.positionY=12,this.detailValues.set("rotation.eulerAngles.z",X),this.nameField=new UIText(v),this.nameField.fontSize=15,this.nameField.fontSize=9,this.nameField.opacity=1,this.nameField.positionX=108,this.nameField.positionY=-22,this.nameField.hTextAlign="left",this.setInfo()}setInitialValues(v,A,E=!1){this.detailValues.has(v)&&this.detailValues.get(v).setInitialValue(A,E)}set(v,A,E=!1){this.detailValues.has(v)&&this.detailValues.get(v).setValue(A,E)}clear(){this.detailValues.forEach((v=>{v.setInitialValue(0),this.setInfo()}))}setInfo(v){if(v){const{uuid:A,name:E}=v;this.nameField.value=`UUID: ${A}\nName: ${E||"No Name"}`}else this.nameField.value="No Entity Selected"}}class InfoDetailValue{constructor(v,A){this.path=A,this.initialValue="0",this.text=new UIText(v),this.text.fontSize=10,this.text.value="",this.text.fontSize=9,this.text.opacity=.5}setInitialValue(v,A=!1){let E=formatText(v);this.text.value=E,this.initialValue=E,this.text.opacity=.5}setValue(v,A=!1){let E=formatText(v,A);E!==this.initialValue&&(this.text.opacity=1),this.text.value=E}}const formatText=(v,A=!1)=>v?parseFloat(`${v}`).toFixed(A?2:3):"0";class TweakerSelector extends Entity{constructor(){super("Dash_Tweaker_Selector"),this.shape=new BoxShape,this.shape.isPointerBlocker=!1,this.shape.withCollisions=!1,this.addComponent(this.shape),this.addComponent(new Transform),this.addComponent(Z.Green())}}const yt=.68,bt={5:{renderSettings:{positionX:0,positionY:43*yt,vAlign:"top",hAlign:"left",width:80*yt,height:30.6},off:{positionX:80,positionY:43,width:80,height:45},on:{positionX:0,positionY:43,width:80,height:45}},1:{renderSettings:{positionX:0,positionY:59.84,vAlign:"top",hAlign:"left",width:80*yt,height:40*yt},off:{positionX:80,positionY:88,width:80,height:40},on:{positionX:0,positionY:88,width:80,height:40}},.1:{renderSettings:{positionX:0,positionY:87.04,vAlign:"top",hAlign:"left",width:80*yt,height:41*yt},off:{positionX:80,positionY:128,width:80,height:41},on:{positionX:0,positionY:128,width:80,height:41}},.01:{renderSettings:{positionX:0,positionY:114.92,width:80*yt,height:41*yt},off:{positionX:80,positionY:169,width:80,height:41},on:{positionX:0,positionY:169,width:80,height:41}},.001:{renderSettings:{positionX:0,positionY:142.8,width:80*yt,height:33.32},off:{positionX:80,positionY:210,width:80,height:49},on:{positionX:0,positionY:210,width:80,height:49}}},vt={90:{renderSettings:{positionX:0,positionY:43*yt,vAlign:"top",hAlign:"left",width:80*yt,height:30.6},off:{positionX:80,positionY:302,width:80,height:43},on:{positionX:0,positionY:302,width:80,height:43}},45:{renderSettings:{positionX:0,positionY:59.84,vAlign:"top",hAlign:"left",width:80*yt,height:40*yt},off:{positionX:80,positionY:345,width:80,height:40},on:{positionX:0,positionY:345,width:80,height:40}},5:{renderSettings:{positionX:0,positionY:87.04,vAlign:"top",hAlign:"left",width:80*yt,height:41*yt},off:{positionX:80,positionY:385,width:80,height:41},on:{positionX:0,positionY:385,width:80,height:41}},1:{renderSettings:{positionX:0,positionY:114.92,width:80*yt,height:41*yt},off:{positionX:80,positionY:426,width:80,height:40},on:{positionX:0,positionY:426,width:80,height:40}},.1:{renderSettings:{positionX:0,positionY:142.8,width:80*yt,height:33.32},off:{positionX:80,positionY:466,width:80,height:49},on:{positionX:0,positionY:466,width:80,height:49}}},wt={position:{renderSettings:{positionX:141.44,positionY:0,width:114*yt,height:34},on:{positionX:288,positionY:0,width:114,height:50},off:{positionX:288,positionY:260,width:114,height:50}},rotation:{renderSettings:{positionX:218.96,positionY:0,width:76.84,height:34},on:{positionX:402,positionY:260,width:113,height:50},off:{positionX:402,positionY:0,width:113,height:50}}},Tt={labelUnit:{renderSettings:{positionX:0,positionY:0,width:80*yt,height:43*yt},cropSettings:{positionX:80,positionY:0,width:80,height:43}},labelScale:{renderSettings:{positionX:80*yt,positionY:0,width:85,height:43*yt},cropSettings:{positionX:160,positionY:0,width:125,height:43}},directionTL:{renderSettings:{positionX:141.44,positionY:-34,width:81*yt,height:43.52},cropSettings:{positionX:288,positionY:50,width:81,height:64}},directionTR:{renderSettings:{positionX:357*yt,positionY:-34,width:78*yt,height:43.52},cropSettings:{positionX:437,positionY:50,width:78,height:64}},directionBL:{renderSettings:{positionX:141.44,positionY:183*yt*-1,width:81*yt,height:77*yt},cropSettings:{positionX:288,positionY:183,width:81,height:77}},directionBR:{renderSettings:{positionX:357*yt,positionY:183*yt*-1,width:78*yt,height:77*yt},cropSettings:{positionX:437,positionY:183,width:78,height:77}},infoPaneTest:{renderSettings:{positionX:295.8,positionY:-0,width:165.24,height:207*yt},cropSettings:{positionX:515,positionY:0,width:243,height:207}}},xt={selectOn:{renderSettings:{positionX:490*yt,positionY:207*yt*-1,width:63.92,height:55*yt},cropSettings:{positionX:608,positionY:438,width:94,height:55},data:{action:"setSelectOff"}},selectOff:{renderSettings:{positionX:490*yt,positionY:207*yt*-1,width:63.92,height:55*yt},cropSettings:{positionX:514,positionY:438,width:94,height:55},data:{action:"setSelectOn"}},deselect:{renderSettings:{positionX:490*yt,positionY:207*yt*-1,width:63.92,height:55*yt},cropSettings:{positionX:570,positionY:207,width:94,height:55},data:{action:"deselect"}}},St={scaleXMinus:{renderSettings:{positionX:80*yt,positionY:43*yt*-1,width:43.52,height:36.04},cropSettings:{positionX:160,positionY:43,width:64,height:53},data:{direction:"x",negative:!0}},scaleXPlus:{renderSettings:{positionX:97.92,positionY:43*yt*-1,width:61*yt,height:36.04},cropSettings:{positionX:224,positionY:43,width:61,height:53},data:{direction:"x",positive:!0}},scaleYMinus:{renderSettings:{positionX:80*yt,positionY:-65.28,width:43.52,height:35.36},cropSettings:{positionX:160,positionY:96,width:64,height:52},data:{direction:"y",positive:!1}},scaleYPlus:{renderSettings:{positionX:97.92,positionY:-65.28,width:61*yt,height:35.36},cropSettings:{positionX:224,positionY:96,width:61,height:52},data:{direction:"y",positive:!0}},scaleZMinus:{renderSettings:{positionX:80*yt,positionY:-100.64,width:43.52,height:36.04},cropSettings:{positionX:160,positionY:148,width:64,height:53},data:{direction:"z",positive:!1}},scaleZPlus:{renderSettings:{positionX:97.92,positionY:-100.64,width:61*yt,height:36.04},cropSettings:{positionX:224,positionY:148,width:61,height:53},data:{direction:"z",positive:!0}},scaleAllMinus:{renderSettings:{positionX:80*yt,positionY:-136.68,width:43.52,height:58*yt},cropSettings:{positionX:160,positionY:201,width:64,height:58},data:{direction:"all",positive:!1}},scaleAllPlus:{renderSettings:{positionX:97.92,positionY:-136.68,width:61*yt,height:58*yt},cropSettings:{positionX:224,positionY:201,width:61,height:58},data:{direction:"all",positive:!0}}},Ct={north:{renderSettings:{positionX:196.52,positionY:-34,width:46.24,height:43.52},cropSettings:{positionX:369,positionY:50,width:68,height:64},data:{direction:"x",positive:!0}},south:{renderSettings:{positionX:196.52,positionY:183*yt*-1,width:46.24,height:77*yt},cropSettings:{positionX:369,positionY:183,width:68,height:77},data:{direction:"x",positive:!1}},east:{renderSettings:{positionX:357*yt,positionY:114*yt*-1,width:78*yt,height:46.92},cropSettings:{positionX:437,positionY:114,width:78,height:69},data:{direction:"z",positive:!0}},west:{renderSettings:{positionX:141.44,positionY:114*yt*-1,width:81*yt,height:46.92},cropSettings:{positionX:288,positionY:114,width:81,height:69},data:{direction:"z",positive:!1}},up:{renderSettings:{positionX:196.52,positionY:114*yt*-1,width:46.24,height:23.12},cropSettings:{positionX:369,positionY:114,width:68,height:34},data:{direction:"y",positive:!0}},down:{renderSettings:{positionX:196.52,positionY:-100.64,width:46.24,height:23.8},cropSettings:{positionX:369,positionY:148,width:68,height:35},data:{direction:"y",positive:!1}}},At={revert:{renderSettings:{positionX:295.8,positionY:207*yt*-1,width:55*yt,height:55*yt},cropSettings:{positionX:515,positionY:207,width:55,height:55},data:{action:"revert"}},log:{renderSettings:{positionX:397.12,positionY:207*yt*-1,width:63.92,height:56*yt},cropSettings:{positionX:664,positionY:207,width:94,height:56},data:{action:"log"}}};var _t;!function(v){v[v.POSITION=0]="POSITION",v[v.ROTATION=1]="ROTATION"}(_t||(_t={}));class Dash_UI_ImageRadioButton{constructor(v,A,E,R,O,M=!1){this.parent=v,this.texture=A,this.value=E,this.settings=R,this.onChange=O,this.isActive=M,this.image=new UIImage(this.parent,this.texture),this.image.onClick=new OnPointerDown((()=>{this.onChange(this.value)}));const{on:V,off:W}=this.settings;this.setValues(this.isActive?V:W)}setValues(v){const{width:A,height:E,vAlign:R,hAlign:O,positionX:M,positionY:V}=this.settings.renderSettings;this.image.width=A,this.image.height=E,this.image.sourceLeft=v.positionX,this.image.sourceTop=v.positionY,this.image.sourceWidth=v.width,this.image.sourceHeight=v.height,this.image.positionX=M,this.image.positionY=-1*V,this.image.vAlign=R||"top",this.image.hAlign=O||"left"}turnOn(){this.setValues(this.settings.on)}turnOff(){this.setValues(this.settings.off)}}class Dash_UI_ImageRadioButton_Group{constructor(v,A,E,R){this.update=R,this.mapping=new Map,this.value="1",Object.keys(E).forEach((R=>{const O=E[R],M=new Dash_UI_ImageRadioButton(v,A,R,O,(v=>{this.mapping.forEach(((A,E)=>{`${v}`==`${E}`?A.turnOn():A.turnOff()})),this.update(v)}));R==this.value&&M.turnOn(),this.mapping.set(R,M)}))}setValue(v){this.value=v,this.mapping.forEach(((A,E)=>{`${v}`==`${E}`?A.turnOn():A.turnOff()}))}hide(){this.mapping.forEach((v=>{v.image.visible=!1}))}show(){this.mapping.forEach((v=>{v.image.visible=!0}))}}const Dash_UI_Generate_StaticImages=(v,A,E)=>{const R=[];return Object.keys(E).forEach((O=>{const M=E[O],V=Dash_UI_StaticImage(v,A,M);R.push(V)})),R},Dash_UI_Generate_StaticButtons=(v,A,E,R)=>{const O=[];return Object.keys(E).forEach((M=>{const V=E[M],W=Dash_UI_Generate_StaticButton(v,A,V,R);O.push(W)})),O},Dash_UI_Generate_StaticButton=(v,A,E,R)=>{const O=Dash_UI_StaticImage(v,A,E);return O.onClick=new OnPointerDown((()=>R(E.data))),O},Dash_UI_StaticImage=(v,A,E)=>{let R=new UIImage(v,A);const{renderSettings:O,cropSettings:M}=E,{vAlign:V,hAlign:W}=O;return R.width=O.width,R.height=O.height,R.sourceLeft=M.positionX,R.sourceTop=M.positionY,R.sourceWidth=M.width,R.sourceHeight=M.height,R.positionX=O.positionX,R.positionY=O.positionY,R.vAlign=V||"top",R.hAlign=W||"left",R},It=pt.create("https://pmacom.github.io/assets/dcldash/images/ui/dash_admin.png");let Pt=PhysicsCast.instance;class Dash_Tweaker_Instance{constructor(v){this.target=v,this.container=new UIContainerRect(ut),this.mode=_t.POSITION,this.unitValue=1,this.isAnimating=!1,this.initialPosition=new Vector3,this.initialScale=new Vector3,this.initialRotation=new Quaternion,this.inSelectMode=!1,this.selectionEntity=new TweakerSelector,this.container=new UIContainerRect(ut),this.container.visible=!1,this.container.vAlign="top",this.container.hAlign="left",this.container.width=500,this.container.height=177,this.container.positionX=202,this.container.positionY=20,this.positionUnitButtons=new Dash_UI_ImageRadioButton_Group(this.container,It,bt,(v=>this.setUnit(parseFloat(v)))),this.rotationUnitButtons=new Dash_UI_ImageRadioButton_Group(this.container,It,vt,(v=>this.setUnit(parseFloat(v)))),this.rotationUnitButtons.hide(),this.modeToggleButtons=new Dash_UI_ImageRadioButton_Group(this.container,It,wt,(v=>{switch(v){case"position":this.setPositionMode(),this.positionUnitButtons.setValue(1),this.setUnit(1);break;case"rotation":this.setRotationMode(),this.rotationUnitButtons.setValue(45),this.setUnit(45)}})),this.modeToggleButtons.setValue("position"),this.staticImages=Dash_UI_Generate_StaticImages(this.container,It,Tt),this.scaleButtons=Dash_UI_Generate_StaticButtons(this.container,It,St,(v=>{this.mode!=_t.POSITION&&(this.setPositionMode(),this.modeToggleButtons.setValue("position"),this.setUnit(1)),this.isAnimating||this.scale(v)})),this.infoDetailButtons=Dash_UI_Generate_StaticButtons(this.container,It,At,(v=>{const{action:A}=v;switch(A){case"log":this.printLog();break;case"revert":this.revert()}})),this.selectButtons=Dash_UI_Generate_StaticButtons(this.container,It,xt,(v=>{const{action:A}=v;switch(A){case"setSelectOn":this.inSelectMode=!0,this.selectionMode.start(),this.setSelectButtonState("setSelectOn");break;case"setSelectOff":this.selectModeStop(),this.setSelectButtonState("setSelectOff");break;case"deselect":this.inSelectMode=!1,this.selectionMode.stop(),this.setTarget(null)}})),this.directionButtons=Dash_UI_Generate_StaticButtons(this.container,It,Ct,(v=>{switch(this.mode){case _t.POSITION:this.isAnimating||this.move(v);break;case _t.ROTATION:this.isAnimating||this.rotate(v)}})),this.selectionMode=K.add((()=>{this.target?this.selectModeStop():Pt.hitFirst(Pt.getRayFromCamera(200),(v=>{const{didHit:A,entity:E}=v;if(A&&this.inSelectMode){const{entityId:v,meshName:A}=E,R=engine.entities[v];if("Dash_Tweaker_Selector"!==R.name){const v=R.getComponentOrCreate(Transform).scale.clone();this.selectionEntity.getComponent(Transform).scale=v.add((new Vector3).setAll(.1)),this.selectionTarget=R,this.selectionEntity.setParent(R)}}}))})),this.selectionEntity.addComponent(new OnPointerDown((()=>{this.setTarget(this.selectionTarget),this.selectModeStop()}),{hoverText:"Select Entity",distance:200})),this.infoDetails=new Dash_Admin_Tweaker_InfoDetails(this.container),this.setSelectButtonState("setSelectOff")}setTarget(v){if(v){const{position:A,scale:E,rotation:R}=v.getComponent(Transform);this.infoDetails.setInitialValues("position.x",A.x),this.infoDetails.setInitialValues("position.y",A.y),this.infoDetails.setInitialValues("position.z",A.z),this.infoDetails.setInitialValues("scale.x",E.x),this.infoDetails.setInitialValues("scale.y",E.y),this.infoDetails.setInitialValues("scale.z",E.z),this.infoDetails.setInitialValues("rotation.eulerAngles.x",R.eulerAngles.x,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.y",R.eulerAngles.y,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.z",R.eulerAngles.z,!0),this.infoDetails.setInfo(v),this.initialRotation=R.clone(),this.initialScale=E.clone(),this.initialPosition=A.clone(),this.setSelectButtonState("deselect")}else this.setSelectButtonState("setSelectOff"),this.infoDetails.clear();this.target=v}setSelectButtonState(v){this.selectButtons.forEach((v=>{v.opacity=0,v.isPointerBlocker=!1}));const A=this.selectButtons[0],E=this.selectButtons[1],R=this.selectButtons[2];switch(v){case"setSelectOn":A.opacity=1,A.isPointerBlocker=!0;break;case"setSelectOff":E.opacity=1,E.isPointerBlocker=!0,this.selectModeStop();break;case"deselect":R.opacity=1,R.isPointerBlocker=!0,this.selectModeStop()}}selectModeStop(){this.inSelectMode=!1,this.selectionEntity.setParent(null),this.selectionEntity.alive&&engine.removeEntity(this.selectionEntity),this.selectionMode.stop()}printLog(){if(this.target){const v=this.target.getComponentOrCreate(Transform),{position:A,scale:E,rotation:R}=v,O=[this.formatOutput(A.x),this.formatOutput(A.y),this.formatOutput(A.z)],M=[this.formatOutput(E.x),this.formatOutput(E.y),this.formatOutput(E.z)],V=[this.formatOutput(R.eulerAngles.x),this.formatOutput(R.eulerAngles.y),this.formatOutput(R.eulerAngles.z)];log(`\n\n            Tweaker Output:\n            name: ${this.target.name?this.target.name:"No name"}\n            uuid: ${this.target.uuid}\n\n            Transform({\n               position: new Vector3(${O.join(", ")}),\n               scale: new Vector3(${M.join(", ")}),\n               rotation: new Quaternion().setEuler(${V.join(", ")}),\n            })\n`)}}revert(){if(this.target){const v=this.initialPosition.clone(),A=this.initialScale.clone(),E=this.initialRotation.clone();this.infoDetails.setInitialValues("position.x",v.x),this.infoDetails.setInitialValues("position.y",v.y),this.infoDetails.setInitialValues("position.z",v.z),this.infoDetails.setInitialValues("scale.x",A.x),this.infoDetails.setInitialValues("scale.y",A.y),this.infoDetails.setInitialValues("scale.z",A.z),this.infoDetails.setInitialValues("rotation.eulerAngles.x",E.eulerAngles.x,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.y",E.eulerAngles.y,!0),this.infoDetails.setInitialValues("rotation.eulerAngles.z",E.eulerAngles.z,!0),this.target.addComponentOrReplace(new Transform({position:v,scale:A,rotation:E}))}}formatOutput(v){return parseFloat(`${v}`).toFixed(3)}setPositionMode(){this.mode=_t.POSITION,this.positionUnitButtons.show(),this.rotationUnitButtons.hide()}setRotationMode(){this.mode=_t.ROTATION,this.positionUnitButtons.hide(),this.rotationUnitButtons.show()}move(v){if(this.target){const{direction:A,positive:E}=v,R=this.target.getComponent(Transform);if("all"!==A){const v=R.position[A],O=v+(E?this.unitValue:-1*this.unitValue);this.infoDetails.set(`position.${A}`,O),this.isAnimating=!0,lt.add({duration:.2,onFrame:E=>{R.position[A]=Scalar.Lerp(v,O,$.easeOutQuart(E))},onComplete:()=>{R.position[A]=O,this.isAnimating=!1}})}}}scale(v){if(this.target){const{direction:A,positive:E}=v,R=this.target.getComponent(Transform);if("all"!=A){const v=R.scale[A],O=v+(E?this.unitValue:-1*this.unitValue);this.infoDetails.set(`scale.${A}`,O),this.isAnimating=!0,lt.add({duration:.2,onFrame:E=>{R.scale[A]=Scalar.Lerp(v,O,$.easeOutQuart(E))},onComplete:()=>{R.scale[A]=O,this.isAnimating=!1}})}else{const{x:v,y:A,z:O}=R.scale;let M=v+(E?this.unitValue:-1*this.unitValue),V=A+(E?this.unitValue:-1*this.unitValue),W=O+(E?this.unitValue:-1*this.unitValue);this.infoDetails.set("scale.x",M),this.infoDetails.set("scale.y",V),this.infoDetails.set("scale.z",W),this.isAnimating=!0,lt.add({duration:.2,onFrame:E=>{R.scale.set(Scalar.Lerp(v,M,$.easeOutQuart(E)),Scalar.Lerp(A,V,$.easeOutQuart(E)),Scalar.Lerp(O,W,$.easeOutQuart(E)))},onComplete:()=>{R.scale.x=M,R.scale.y=V,R.scale.z=W,this.isAnimating=!1}})}}}rotate(v){if(this.target){const{direction:A,positive:E}=v,R=this.target.getComponent(Transform);if("all"!==A){R.rotation.clone();const v=R.rotation.eulerAngles[A],{x:O,y:M,z:V}=R.rotation.eulerAngles;let W=v+(E?this.unitValue:-1*this.unitValue);switch(A){case"x":this.isAnimating=!0,this.infoDetails.set("rotation.eulerAngles.x",W,!0),this.infoDetails.set("rotation.eulerAngles.y",M,!0),this.infoDetails.set("rotation.eulerAngles.z",V,!0),lt.add({duration:.2,onFrame:A=>{R.rotation.setEuler(Scalar.Lerp(v,W,$.easeOutQuart(A)),M,V)},onComplete:()=>{this.isAnimating=!1,R.rotation.setEuler(W,M,V)}});break;case"y":this.isAnimating=!0,this.infoDetails.set("rotation.eulerAngles.x",O,!0),this.infoDetails.set("rotation.eulerAngles.y",W,!0),this.infoDetails.set("rotation.eulerAngles.z",V,!0),lt.add({duration:.2,onFrame:A=>{R.rotation.setEuler(O,Scalar.Lerp(v,W,$.easeOutQuart(A)),V)},onComplete:()=>{this.isAnimating=!1,R.rotation.setEuler(O,W,V)}});break;case"z":this.isAnimating=!0,this.infoDetails.set("rotation.eulerAngles.x",O,!0),this.infoDetails.set("rotation.eulerAngles.y",M,!0),this.infoDetails.set("rotation.eulerAngles.z",W,!0),lt.add({duration:.2,onFrame:A=>{R.rotation.setEuler(O,M,Scalar.Lerp(v,W,$.easeOutQuart(A)))},onComplete:()=>{this.isAnimating=!1,R.rotation.setEuler(O,M,W)}})}}}}getTarget(){return this.target}setUnit(v){this.unitValue=v}hide(){this.container.visible=!1}show(){this.container.visible=!0}}const Rt={tweaker:{renderSettings:{positionX:163,positionY:25,width:34,height:34},on:{positionX:515,positionY:262,width:34,height:34},off:{positionX:549,positionY:262,width:34,height:34}}};var Ot;!function(v){v[v.NONE=0]="NONE",v[v.TWEAKER=1]="TWEAKER",v[v.ZONE=2]="ZONE"}(Ot||(Ot={}));const kt=pt.create("https://pmacom.github.io/assets/dcldash/images/ui/dash_admin.png");let Lt;class Dash_AdminMenu{constructor(){this.mode=Ot.NONE,this.tweaker=new Dash_Tweaker_Instance,executeTask((()=>__awaiter(this,void 0,void 0,(function*(){(yield O.isPreviewMode())&&(this.modeSelect=new Dash_UI_AdminRadioButton_Group(kt,Rt,(v=>{switch(v){case"tweaker":this.mode=this.mode!==Ot.TWEAKER?Ot.TWEAKER:Ot.NONE;break;case"zone":this.mode=this.mode!==Ot.ZONE?Ot.ZONE:Ot.NONE}this.updateVisible()})))}))))}updateVisible(){var v;switch(this.hideAll(),this.mode){case Ot.TWEAKER:this.tweaker&&this.tweaker.show();break;case Ot.ZONE:break;default:null===(v=this.modeSelect)||void 0===v||v.setValue("")}}hideAll(){this.tweaker&&this.tweaker.hide()}}const Dash_Wait=(v,A)=>lt.add({duration:A,onComplete:()=>v()}),getPositionData=()=>{let{feetPosition:v,position:A,rotation:E}=Camera.instance;return JSON.stringify({feetPosition:v,position:A,rotation:E})};v.Dash_AdminMenu=Dash_AdminMenu,v.Dash_AnimationQueue=lt,v.Dash_BoxHighlight=Dash_BoxHighlight,v.Dash_Cache_Texture=pt,v.Dash_Cache_VideoClip=dt,v.Dash_Cache_VideoMaterial=ft,v.Dash_Cache_VideoTexture=gt,v.Dash_CheckWithinVolume=Dash_CheckWithinVolume,v.Dash_Countdown=class{constructor(){this.remaining=0,this.seconds=0,this.onCompleteMap=new Set,this.onUpdateMap=new Set,this.onSecondMap=new Set,this.timer=K.add((v=>this.onFrame(v)))}setTimer(v){this.remaining=this.seconds=v}onUpdate(v){this.onUpdateMap.add(v)}onSecond(v){this.onSecondMap.add(v)}onComplete(v){this.onCompleteMap.add(v)}start(){this.timer.start()}stop(){this.timer.stop()}onFrame(v){if(this.remaining>0){this.remaining-=v;let A=Math.floor(this.remaining);A!=this.seconds&&(this.seconds=A,this.onSecondMap.forEach((v=>v(A))))}this.seconds<=0&&(this.onCompleteMap.forEach((v=>v())),this.timer.stop()),this.onUpdateMap.forEach((A=>A(v)))}},v.Dash_Ease=$,v.Dash_GetSceneData=Dash_GetSceneData,v.Dash_GlobalCanvas=ut,v.Dash_LandBarrier=class{constructor(v){this.exitLocation=v,this.barrierZones=[],this.parcelStrings=new Set,this.message="privateevent",executeTask((()=>__awaiter(this,void 0,void 0,(function*(){const{base:v,parcels:A,maxHeight:E}=yield Dash_GetSceneData(),R=v.split(",");this.base=new Vector2(parseInt(R[0]),parseInt(R[1])),A.forEach((v=>this.parcelStrings.add(v))),A.forEach(((v,A)=>{const R=v.split(","),O=new Vector2(parseInt(R[0]),parseInt(R[1])),M=new Vector2(O.x-this.base.x,O.y-this.base.y),V=new Vector3(16*M.x+8,1,16*M.y+8),W=!this.parcelStrings.has(`${O.x-1},${O.y}`),H=!this.parcelStrings.has(`${O.x+1},${O.y}`),X=!this.parcelStrings.has(`${O.x},${O.y+1}`),Z=!this.parcelStrings.has(`${O.x},${O.y-1}`),K=new BarrierZone(nt,this.getMessage(),E,this.exitLocation,W,H,X,Z);K.addComponentOrReplace(new Transform({position:V})),this.barrierZones.push(K)}))}))))}getMessage(){return this.message}setMessage(v){this.message=v,this.barrierZones.forEach((A=>{A.setMessage(v)}))}disable(){this.barrierZones.forEach((v=>{v.disable(),v.alive&&engine.removeEntity(v)}))}enable(){this.barrierZones.forEach((v=>{v.enable(),v.alive||engine.addEntity(v)}))}},v.Dash_Material=Z,v.Dash_OnFirstMove=v=>{Dash_Wait((()=>{const A=getPositionData(),E=K.add((()=>{const R=getPositionData();A!=R&&(v(),E.stop())}));E.start()}),1)},v.Dash_OnUpdateFrame=K,v.Dash_SimplePoster=Dash_SimplePoster,v.Dash_TriggerZone=Dash_TriggerZone,v.Dash_Tweaker=v=>{var A,E;Lt?null===(E=Lt.tweaker)||void 0===E||E.setTarget(v):(Lt=new Dash_AdminMenu,null===(A=Lt.tweaker)||void 0===A||A.setTarget(v))},v.Dash_UI_Crop_Image=(v,A,E,R,O,M,V)=>{let W=Scalar.InverseLerp(0,v,O),H=Scalar.InverseLerp(0,A,M),X=Scalar.InverseLerp(0,v,E),Z=Scalar.InverseLerp(0,A,R),K={x:W,y:1-H},$={x:W+X,y:1-H},J={x:W+X,y:1-H-Z},et={x:W,y:1-H-Z},it=V?[J.x,J.y,et.x,et.y,K.x,K.y,$.x,$.y]:[$.x,$.y,K.x,K.y,et.x,et.y,J.x,J.y];return[...it,...it]},v.Dash_UI_Generate_StaticButton=Dash_UI_Generate_StaticButton,v.Dash_UI_Generate_StaticButtons=Dash_UI_Generate_StaticButtons,v.Dash_UI_Generate_StaticImages=Dash_UI_Generate_StaticImages,v.Dash_UI_StaticImage=Dash_UI_StaticImage,v.Dash_UV_Crop_Video=(v,A,E,R,O,M)=>{const V=[Scalar.InverseLerp(0,v,O+E),Scalar.InverseLerp(0,A,M+R),Scalar.InverseLerp(0,v,O),Scalar.InverseLerp(0,A,M+R),Scalar.InverseLerp(0,v,O),Scalar.InverseLerp(0,A,M),Scalar.InverseLerp(0,v,O+E),Scalar.InverseLerp(0,A,M)];return[...V,...V]},v.Dash_UV_Curved_Image=(v,A)=>{let E=v/100*2,R=E*A,O=E*A+E,M=[R,0,O,0,O,1,R,1];return[...M,...M]},v.Dash_UV_Curved_Video=(v,A)=>{let E=v/100*2,R=E*A,O=E*A+E,M=[R,1,O,1,O,0,R,0];return[...M,...M]},v.Dash_UV_Image=()=>[1,0,0,0,0,1,1,1,0,0,1,0,1,1,0,1],v.Dash_UV_Plane_Crop_Image=Dash_UV_Plane_Crop_Image,v.Dash_UV_Video=()=>[0,1,1,1,1,0,0,0,1,1,0,1,0,0,1,0],v.Dash_Wait=Dash_Wait,v.Dash_Zone=Dash_Zone,v.Dash_ZoneMaker=Dash_ZoneMaker,v.DynamicImage=DynamicImage,v.DynamicImageBar=class{constructor(v,A,E=0,R=J.HALIGN_CENTER){this.backgroundImage=v,this.orientation=R,this.ease=$.easeOutQuint,this.fillImage=new DynamicImage(A),this.backgroundImage.opacity=.5,this.width=new UIValue(A.width).value,this.height=new UIValue(A.height).value,this.sourceWidth=new UIValue(A.sourceWidth).value,this.sourceHeight=new UIValue(A.sourceHeight).value,this.sourceLeft=new UIValue(A.sourceLeft).value,this.sourceTop=new UIValue(A.sourceTop).value,this.value=E,this.setValue(this.value,0)}setEase(v){this.ease=v}setValue(v,A=1){const E=this.width*(v/100),R=this.height*(v/100),O=this.sourceWidth*(v/100),M=this.sourceHeight*(v/100);switch(this.orientation){case J.HALIGN_CENTER:switch(this.fillImage.image.hAlign){case"left":this.fillImage.moveToX(this.width/2-this.width/2*Scalar.InverseLerp(0,this.sourceWidth,O),A,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-O)/2,A,this.ease);break;case"center":this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-O)/2,A,this.ease);break;case"right":this.fillImage.moveToX(this.width/2*-1+this.width/2*Scalar.InverseLerp(0,this.sourceWidth,O),A,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-O)/2,A,this.ease)}this.fillImage.resizeWidthTo(E,A,this.ease),this.fillImage.resizeSourceWidthTo(O,A,this.ease);break;case J.HALIGN_LEFT:switch(this.fillImage.image.hAlign){case"left":break;case"center":this.fillImage.moveToX(this.width/2+this.width/2*Scalar.InverseLerp(0,this.sourceWidth,O)-this.width,A,this.ease);break;case"right":this.fillImage.moveToX(this.width*Scalar.InverseLerp(0,this.sourceWidth,O)-this.width,A,this.ease)}this.fillImage.resizeWidthTo(E,A,this.ease),this.fillImage.resizeSourceWidthTo(O,A,this.ease);break;case J.HALIGN_RIGHT:switch(this.fillImage.image.hAlign){case"left":this.fillImage.moveToX(this.width+this.width*Scalar.InverseLerp(this.sourceWidth,0,O)-this.width,A,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-O),A,this.ease);break;case"center":this.fillImage.moveToX(this.width+this.width/2*Scalar.InverseLerp(this.sourceWidth,0,O)-this.width,A,this.ease),this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-O),A,this.ease);break;case"right":this.fillImage.moveSourceLeftTo(this.sourceLeft+(this.sourceWidth-O),A,this.ease),this.fillImage.moveToX(0,A,this.ease)}this.fillImage.resizeWidthTo(E,A,this.ease),this.fillImage.resizeSourceWidthTo(O,A,this.ease);break;case J.VALIGN_CENTER:switch(this.fillImage.image.vAlign){case"top":this.fillImage.moveToY(this.height/2*Scalar.InverseLerp(0,this.sourceHeight,M)-this.height/2,A,this.ease),this.fillImage.moveSourceTopTo(this.sourceTop+(this.sourceHeight-M)/2,A,this.ease);break;case"center":this.fillImage.moveSourceTopTo(this.sourceTop+(this.sourceHeight-M)/2,A,this.ease);break;case"bottom":this.fillImage.moveToY(this.height/2*Scalar.InverseLerp(this.sourceHeight,0,M),A,this.ease),this.fillImage.moveSourceTopTo(this.sourceTop+(this.sourceHeight-M)/2,A,this.ease)}this.fillImage.resizeHeightTo(R,A,this.ease),this.fillImage.resizeSourceHeightTo(M,A,this.ease);break;case J.VALIGN_TOP:switch(this.fillImage.image.vAlign){case"top":break;case"center":this.fillImage.moveToY(this.height/2-this.height/2*Scalar.InverseLerp(0,this.sourceHeight,M),A,this.ease);break;case"bottom":this.fillImage.moveToY(this.height-this.height*Scalar.InverseLerp(0,this.sourceHeight,M),A,this.ease),this.fillImage.moveSourceTopTo(0,A,this.ease)}this.fillImage.resizeHeightTo(R,A,this.ease),this.fillImage.resizeSourceHeightTo(M,A,this.ease);break;case J.VALIGN_BOTTOM:switch(this.fillImage.image.vAlign){case"top":this.fillImage.moveToY(this.height*Scalar.InverseLerp(this.sourceHeight,0,M)*-1,A,this.ease),this.fillImage.moveSourceTopTo(this.sourceHeight-M,A,this.ease);break;case"center":this.fillImage.moveToY(this.height/2*Scalar.InverseLerp(this.sourceHeight,0,M)*-1,A,this.ease),this.fillImage.moveSourceTopTo(this.sourceHeight-M,A,this.ease);break;case"bottom":this.fillImage.moveToY(Scalar.InverseLerp(0,this.sourceHeight,M),A,this.ease),this.fillImage.moveSourceTopTo(this.sourceHeight-M,A,this.ease)}this.fillImage.resizeHeightTo(R,A,this.ease),this.fillImage.resizeSourceHeightTo(M,A,this.ease)}}},Object.defineProperty(v,"__esModule",{value:!0})}));var __extends=this&&this.__extends||function(){var extendStatics=function(v,A){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,A){v.__proto__=A}||function(v,A){for(var E in A)Object.prototype.hasOwnProperty.call(A,E)&&(v[E]=A[E])},extendStatics(v,A)};return function(v,A){if("function"!=typeof A&&null!==A)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function __(){this.constructor=v}extendStatics(v,A),v.prototype=null===A?Object.create(A):(__.prototype=A.prototype,new __)}}(),__awaiter=this&&this.__awaiter||function(v,A,E,R){return new(E||(E=Promise))((function(O,M){function fulfilled(v){try{step(R.next(v))}catch(v){M(v)}}function rejected(v){try{step(R.throw(v))}catch(v){M(v)}}function step(v){var A;v.done?O(v.value):(A=v.value,A instanceof E?A:new E((function(v){v(A)}))).then(fulfilled,rejected)}step((R=R.apply(v,A||[])).next())}))},__generator=this&&this.__generator||function(v,A){var E,R,O,M,V={label:0,sent:function(){if(1&O[0])throw O[1];return O[1]},trys:[],ops:[]};return M={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(M[Symbol.iterator]=function(){return this}),M;function verb(W){return function(H){return function(W){if(E)throw new TypeError("Generator is already executing.");for(;M&&(M=0,W[0]&&(V=0)),V;)try{if(E=1,R&&(O=2&W[0]?R.return:W[0]?R.throw||((O=R.return)&&O.call(R),0):R.next)&&!(O=O.call(R,W[1])).done)return O;switch(R=0,O&&(W=[2&W[0],O.value]),W[0]){case 0:case 1:O=W;break;case 4:return V.label++,{value:W[1],done:!1};case 5:V.label++,R=W[1],W=[0];continue;case 7:W=V.ops.pop(),V.trys.pop();continue;default:if(!((O=(O=V.trys).length>0&&O[O.length-1])||6!==W[0]&&2!==W[0])){V=0;continue}if(3===W[0]&&(!O||W[1]>O[0]&&W[1]<O[3])){V.label=W[1];break}if(6===W[0]&&V.label<O[1]){V.label=O[1],O=W;break}if(O&&V.label<O[2]){V.label=O[2],V.ops.push(W);break}O[2]&&V.ops.pop(),V.trys.pop();continue}W=A.call(v,V)}catch(v){W=[6,v],R=0}finally{E=O=0}if(5&W[0])throw W[1];return{value:W[0]?W[1]:void 0,done:!0}}([W,H])}}};define("instances/transitor.instance",["require","exports"],(function(v,A){Object.defineProperty(A,"__esModule",{value:!0}),A.TransitorInstance=void 0;var E=function(v){function TransitorInstance(A){var E=v.call(this)||this;return E.mainGeo=new Entity,E.button=new Entity,E.click=new Entity,E.backButton=new Entity,E.clickBack=new Entity,E.aquarium=new Entity,E.music=new Entity,E.clip=new AudioClip("sounds/Tunnel Music.mp3"),E.source=new AudioSource(E.clip),E.modArea=new Entity,E.instanceController=A,E.mainGeo.addComponent(new GLTFShape("models/ubs_inbetweenspace_geo.gltf")),E.button.addComponent(new GLTFShape("models/ubs_inbetweenspace_button_collider.gltf")),E.backButton.addComponent(new GLTFShape("models/ubs_inbetweenspace_back_button.gltf")),E.clickBack.addComponent(new BoxShape),E.click.addComponent(new BoxShape),E.aquarium.addComponent(new GLTFShape("models/ubs_inbetweenspace_aquarium.gltf")),E.music.addComponent(E.source),E.music.addComponent(new Transform({position:new Vector3(6.78,61.1,57.79)})),E.source.loop=!0,E.source.volume=1,E.source.playing=!0,E.mainGeo.setParent(E),E.button.setParent(E),E.click.setParent(E),E.backButton.setParent(E),E.clickBack.setParent(E),E.music.setParent(E),E.aquarium.setParent(E),E.method(),E.setModArea(),E}return __extends(TransitorInstance,v),TransitorInstance.prototype.method=function(){var v=this,A=new Material;A.albedoColor=Color4.FromInts(0,0,0,0),this.click.addComponent(A),this.click.getComponent(BoxShape).withCollisions=!1,this.click.addComponent(new Transform({position:new Vector3(32.99,9.51,55.6),scale:new Vector3(1.4,1.4,1.4),rotation:(new Quaternion).setEuler(0,270,0)})),this.click.addComponentOrReplace(new OnPointerDown((function(){openExternalURL("https://play.decentraland.org/?realm=worlds.dcl.guru%2Fworld%2FinternalTest.dcl.eth")}))),this.clickBack.addComponent(A),this.clickBack.getComponent(BoxShape).withCollisions=!1,this.clickBack.addComponent(new Transform({position:new Vector3(36.17,9.32,10.44),scale:new Vector3(1.4,1.4,1.4),rotation:(new Quaternion).setEuler(0,270,0)})),this.clickBack.addComponentOrReplace(new OnPointerDown((function(){v.instanceController.loadExterior()}),{hoverText:"Go back to Campus"}))},TransitorInstance.prototype.setModArea=function(){this.modArea.addComponent(new CameraModeArea({area:{box:new Vector3(16,1,14)},cameraMode:CameraMode.FirstPerson})),this.modArea.addComponent(new Transform({position:new Vector3(6.45,61,2.59)})),this.modArea.setParent(this)},TransitorInstance}(Entity);A.TransitorInstance=E})),define("utils/exitplane",["require","exports"],(function(v,A){Object.defineProperty(A,"__esModule",{value:!0}),A.ExitPlane=void 0;var E=function(v){function ExitPlane(){var A=v.call(this)||this;return A.shape=new BoxShape,A.onClick=function(){},A.distance=5,A.message="Interact",A.material=new Material,A.addComponent(new Transform),A.addComponent(A.shape),A.updateOnPointerDown(),A.shape.withCollisions=!1,A.material.albedoColor=Color4.FromInts(0,0,0,0),A.addComponentOrReplace(A.material),A}return __extends(ExitPlane,v),ExitPlane.prototype.updateOnPointerDown=function(){var v=this;this.addComponentOrReplace(new OnPointerDown((function(){v.onClick()}),{hoverText:this.message,distance:this.distance}))},ExitPlane.prototype.setMessage=function(v){this.message=v,this.updateOnPointerDown()},ExitPlane.prototype.setDistance=function(v){this.distance=v,this.updateOnPointerDown()},ExitPlane}(Entity);A.ExitPlane=E})),define("utils/ontriggerzone",["require","exports","@dcl/ecs-scene-utils"],(function(v,A,E){Object.defineProperty(A,"__esModule",{value:!0}),A.TriggerZone=void 0;var R=function(v){function TriggerZone(){var A=v.call(this)||this;return A.shape=new BoxShape,A.onClick=function(){},A.onCameraEnter=function(){},A.onCameraExit=function(){},A.triggerBox=new E.TriggerBoxShape,A.addComponent(new Transform),A.addComponent(A.shape),A.shape.visible=!1,A.shape.withCollisions=!1,A.updateOnTrigger(),A}return __extends(TriggerZone,v),TriggerZone.prototype.updateOnTrigger=function(){var v=this;this.addComponentOrReplace(new E.TriggerComponent(this.triggerBox,{onCameraEnter:function(){v.onCameraEnter()},onCameraExit:function(){v.onCameraExit()}}))},TriggerZone}(Entity);A.TriggerZone=R})),define("classes/ui.button.class",["require","exports"],(function(v,A){Object.defineProperty(A,"__esModule",{value:!0}),A.Button=void 0;var E=function(v){function Button(A,E,R,O,M,V,W,H,X,Z,K,$){void 0===$&&($=!1);var J=v.call(this,A,new Texture(E))||this;return J.width=R,J.height=O,J.sourceHeight=M,J.sourceWidth=V,J.positionX=W,J.positionY=H,J.hAlign=X,J.vAlign=Z,J.onClick=new OnPointerDown(K),J.isPointerBlocker=!0,J.visible=$,J}return __extends(Button,v),Button}(UIImage);A.Button=E})),define("classes/screen",["require","exports","classes/ui.button.class"],(function(v,A,E){Object.defineProperty(A,"__esModule",{value:!0}),A.Banner=A.VideoScreen=void 0;var R=function(v){function VideoScreen(A,E){var R=v.call(this)||this;return R.myVideoClip=new VideoClip(A),R.myVideoTexture=new VideoTexture(R.myVideoClip),R.myMaterial=new Material,R.myMaterial.albedoTexture=R.myVideoTexture,R.addComponent(new PlaneShape),R.addComponent(new Transform),R.addComponent(R.myMaterial),R.addComponent(new OnPointerDown((function(){R.myVideoTexture.playing=!R.myVideoTexture.playing}),{distance:10,hoverText:"Click to Play/Pause"})),R}return __extends(VideoScreen,v),VideoScreen}(Entity);A.VideoScreen=R;var O=function(v){function Banner(A,R,O,M,V,W,H,X){void 0===W&&(W=!1);var Z=v.call(this)||this;Z.myMaterial=new Material,Z.canvas=new UICanvas;var K=R.x,$=R.y,J=R.z,et=O.Rx,it=O.Ry,nt=O.Rz;Z.p1=new Texture(A),Z.myMaterial.albedoTexture=Z.p1,Z.addComponent(new PlaneShape),Z.detail=new UIImage(Z.canvas,new Texture(A)),Z.exitButton=new E.Button(Z.canvas,"images/exit_button.png","8%","8%",93,208,"0%","-30%","bottom","center",(function(){}),!1);var ot=new Vector3(M*V,M,3);return W&&(ot=new Vector3(M,M*V,3)),Z.addComponent(new Transform({position:new Vector3(K,$-M/2,J),scale:ot,rotation:(new Quaternion).setEuler(et,it,nt)})),Z.addComponent(Z.myMaterial),Z.myMaterial.roughness=1,Z.myMaterial.specularIntensity=2,Z.myMaterial.metallic=0,Z.detail.visible=!1,Z.addComponent(new OnPointerDown((function(){Z.exitButton.visible=!0,Z.detail.visible=!0;var v=600/(X/H);if(Z.detail.sourceHeight=H,Z.detail.sourceWidth=X,Z.detail.height=v.toString()+"px",Z.detail.width=600..toString()+"px",W){var A=320/(X/H);Z.detail.sourceHeight=H,Z.detail.sourceWidth=X,Z.detail.height=A.toString()+"px",Z.detail.width=320..toString()+"px",Z.exitButton.positionX="1%",Z.exitButton.positionY="-52%"}Z.detail.positionX="0px",Z.detail.positionY="0px",Z.detail.visible=!0,Z.exitButton.onClick=new OnPointerDown((function(){Z.exitButton.visible=!1,Z.detail.visible=!1}))}))),Z}return __extends(Banner,v),Banner}(Entity);A.Banner=O})),define("classes/db.handler",["require","exports","classes/screen"],(function(v,A,E){Object.defineProperty(A,"__esModule",{value:!0}),A.Database_handler=void 0;var R=function(){function Database_handler(v){this.url="https://api.dclworlds.com",this.private_key=v}return Database_handler.prototype.getallusers=function(v){return void 0===v&&(v=this.private_key),__awaiter(this,void 0,void 0,(function(){var A,E,R;return __generator(this,(function(O){switch(O.label){case 0:return O.trys.push([0,3,,4]),A=this.url+"/all-users?dbName=".concat(v),[4,fetch(A)];case 1:return E=O.sent(),log("making a call to",A),[4,E.json()];case 2:return O.sent(),[2];case 3:return R=O.sent(),log("error fetching scores from server ",R),[3,4];case 4:return[2]}}))}))},Database_handler.prototype.getScreen=function(v,A,R,O,M){return void 0===O&&(O=!1),void 0===M&&(M=!1),__awaiter(this,void 0,void 0,(function(){var V,W,H,X,Z,K,$;return __generator(this,(function(J){switch(J.label){case 0:return V=this.url+"/api/media/scene/".concat(this.private_key,"/").concat(v),[4,fetch(V)];case 1:return[4,J.sent().json()];case 2:if(W=J.sent(),H=W.height,X=W.width,null!==W.url.match("storage.googleapis.com/aopf-1/")&&(W.url=W.url.replace("storage.googleapis.com/aopf-1/","cdn.dclworlds.com/")),"image"===W.uploadType)return O&&(W.scale=O),K=Number(W.scale)||1,$=W.width/W.height,M&&($=W.height/W.width),[2,{dclObject:new E.Banner(W.url,A,R,K,$,M,H,X),position:A,scale:K,ratio:$}];if("video"===W.uploadType)return Z=W.position,K=W.scale,$=1,[2,{dclObject:new E.VideoScreen(W.url,Z),position:Z,scale:K,ratio:$}];throw new Error("format not supported yet")}}))}))},Database_handler}();A.Database_handler=R})),define("classes/disclaimer.class",["require","exports","classes/ui.button.class"],(function(v,A,E){Object.defineProperty(A,"__esModule",{value:!0}),A.Disclaimer=void 0;var R=function(){function Disclaimer(v){log("Disclaimer class"),this.canvas=v,this.disclaimer=new UIImage(this.canvas,new Texture("images/ubs_disclaimer_ui.png")),this.disclaimer.sourceHeight=720,this.disclaimer.sourceWidth=1024,this.disclaimer.height="80%",this.disclaimer.width="55%",this.disclaimer.visible=!0,this.disclaimer.hAlign="center",this.disclaimer.vAlign="center",this.disclaimer.positionX=-45,this.disclaimer.positionY=25,this.disclaimer.visible=!0,this.setButtons()}return Disclaimer.prototype.setButtons=function(){var v=this;this.buttons={continue:new E.Button(this.canvas,"images/ubs_disclaimer_continue_button.png","15%","20%",154,266,"15%","-26.5%","center","center",(function(){v.buttons.continue.visible=!1,v.disclaimer.visible=!1}),!0)}},Disclaimer}();A.Disclaimer=R})),define("data/ui.data",["require","exports"],(function(v,A){Object.defineProperty(A,"__esModule",{value:!0}),A.__4b=A.__4a=A.__3c=A.__3b=A.__3a=A.__2b=A.__2a=A.__1d=A.__1c=A.__1b=A.__1a=void 0,A.__1a={id:"camp_a",uiSrc:new Texture("images/npcs/1/a.png")},A.__1b={id:"camp_a",uiSrc:new Texture("images/npcs/1/b.png")},A.__1c={id:"camp_a",uiSrc:new Texture("images/npcs/1/c.png")},A.__1d={id:"camp_a",uiSrc:new Texture("images/npcs/1/d.png")},A.__2a={id:"camp_a",uiSrc:new Texture("images/npcs/2/a.png")},A.__2b={id:"camp_a",uiSrc:new Texture("images/npcs/2/b.png")},A.__3a={id:"camp_a",uiSrc:new Texture("images/npcs/3/a.png")},A.__3b={id:"camp_a",uiSrc:new Texture("images/npcs/3/b.png")},A.__3c={id:"camp_a",uiSrc:new Texture("images/npcs/3/c.png")},A.__4a={id:"camp_a",uiSrc:new Texture("images/npcs/4/a.png")},A.__4b={id:"camp_a",uiSrc:new Texture("images/npcs/4/b.png")}})),define("classes/ui.class",["require","exports","classes/disclaimer.class","classes/ui.button.class","data/ui.data"],(function(v,A,E,R,O){Object.defineProperty(A,"__esModule",{value:!0}),A.UI=void 0;var M=function(){function UI(){var v=this;this.script=1,this.canvas=new UICanvas,this.disclaimer=new E.Disclaimer(this.canvas),this.uiPlaceholder=new UIImage(this.canvas,new Texture("")),this.uiPlaceholder.sourceHeight=236,this.uiPlaceholder.sourceWidth=621,this.uiPlaceholder.height="30%",this.uiPlaceholder.width="40%",this.uiPlaceholder.hAlign="center",this.uiPlaceholder.vAlign="center",this.uiPlaceholder.positionX=-45,this.uiPlaceholder.positionY=-255,this.uiPlaceholder.visible=!1,this.buttons={__1Next:new R.Button(this.canvas,"images/npcs/next.png","1%","3%",24,14,"14%","-52%","center","right",(function(){v.script++,v.update("__1")})),__2Next:new R.Button(this.canvas,"images/npcs/next.png","1%","3%",24,14,"14%","-52%","center","right",(function(){v.script++,v.update("__2")})),__3Next:new R.Button(this.canvas,"images/npcs/next.png","1%","3%",24,14,"14%","-52%","center","right",(function(){v.script++,v.update("__3")})),__4Next:new R.Button(this.canvas,"images/npcs/next.png","1%","3%",24,14,"14%","-52%","center","right",(function(){v.script++,v.update("__4")}))}}return UI.prototype.showUI=function(v){switch(this.uiPlaceholder.visible=!0,v){case"__1":this.buttons.__1Next.visible=!0;break;case"__2":this.buttons.__2Next.visible=!0;break;case"__3":this.buttons.__3Next.visible=!0;break;case"__4":this.buttons.__4Next.visible=!0}},UI.prototype.update=function(v){switch(v){case"__1":1===this.script?this.uiPlaceholder.source=O.__1a.uiSrc:2===this.script?this.uiPlaceholder.source=O.__1b.uiSrc:3===this.script?this.uiPlaceholder.source=O.__1c.uiSrc:4===this.script?this.uiPlaceholder.source=O.__1d.uiSrc:(this.uiPlaceholder.visible=!1,this.buttons.__1Next.visible=!1,this.script=1);break;case"__2":1===this.script?this.uiPlaceholder.source=O.__2a.uiSrc:2===this.script?this.uiPlaceholder.source=O.__2b.uiSrc:(this.uiPlaceholder.visible=!1,this.buttons.__2Next.visible=!1,this.script=1);break;case"__3":1===this.script?this.uiPlaceholder.source=O.__3a.uiSrc:2===this.script?this.uiPlaceholder.source=O.__3b.uiSrc:3===this.script?this.uiPlaceholder.source=O.__3c.uiSrc:(this.uiPlaceholder.visible=!1,this.buttons.__3Next.visible=!1,this.script=1);break;case"__4":1===this.script?this.uiPlaceholder.source=O.__4a.uiSrc:2===this.script?this.uiPlaceholder.source=O.__4b.uiSrc:(this.uiPlaceholder.visible=!1,this.buttons.__4Next.visible=!1,this.script=1)}},UI}();A.UI=M})),define("classes/npc.class",["require","exports"],(function(v,A){Object.defineProperty(A,"__esModule",{value:!0}),A.NPC=void 0;var E=function(v){function NPC(A,E,R,O,M){var V=v.call(this)||this;return V.ui=A,V.id=M,V.addComponent(new GLTFShape(E)),V.addComponent(new Animator),V.addComponent(new Billboard(!1,!0,!1)),V.getComponent(Animator).addClip(new AnimationState("idle")),V.getComponent(Animator).getClip("idle").play(!0),V.getComponent(Animator).getClip("idle").looping=!0,V.addComponent(new Transform({position:R,rotation:O,scale:new Vector3(1,1,1)})),V.addComponentOrReplace(new OnPointerDown((function(){V.onClick()}))),V}return __extends(NPC,v),NPC.prototype.onClick=function(){this.ui.update(this.id),this.ui.showUI(this.id),this.getComponent(Animator).addClip(new AnimationState("talking")),this.getComponent(Animator).getClip("talking").play(!0),this.getComponent(Animator).getClip("talking").looping=!0},NPC}(Entity);A.NPC=E})),define("classes/external.links.class",["require","exports"],(function(v,A){Object.defineProperty(A,"__esModule",{value:!0}),A.LinkButton=void 0;var E=function(v){function LinkButton(A){var E=v.call(this)||this;return E.shape=new BoxShape,E.material=new Material,E.click=new Entity,E.link=A,E.addComponent(new GLTFShape("models/button.glb")),E.addComponent(new Transform),E.click.addComponent(E.shape),E.shape.withCollisions=!1,E.material.albedoColor=Color4.FromInts(0,0,0,0),E.click.addComponentOrReplace(E.material),E.click.setParent(E),E.addComponentOrReplace(new OnPointerDown((function(){openExternalURL(E.link)}))),E}return __extends(LinkButton,v),LinkButton}(Entity);A.LinkButton=E})),define("instances/exterior.instance",["require","exports","@decentraland/RestrictedActions","utils/exitplane","utils/ontriggerzone","classes/db.handler","classes/npc.class","classes/ui.class","classes/external.links.class"],(function(v,A,E,R,O,M,V,W,H){Object.defineProperty(A,"__esModule",{value:!0}),A.ExteriorInstance=void 0;var X=function(v){function ExteriorInstance(A){var E=v.call(this)||this;return E.mainGeo=new Entity,E.branding=new Entity,E.bushes=new Entity,E.detailing=new Entity,E.waterfall=new Entity,E.collider=new Entity,E.interiorGeo=new Entity,E.whirlpool=new Entity,E.buttonGorundFloor=new Entity,E.buttonGalleryFloor=new Entity,E.buttonMeetingFloor=new Entity,E.buttonRooftopFloor=new Entity,E.click=new H.LinkButton("https://www.ubs.com/global/en/our-firm/our-culture.html"),E.click1=new H.LinkButton("https://www.ubs.com/microsites/young/en/2022/digital-assets-explained.html"),E.click2=new H.LinkButton("https://www.ubs.com/microsites/young/en/2022/artificial-intelligence.html"),E.click3=new H.LinkButton("https://www.ubs.com/global/en/sustainability-impact/globalvisionaries/gv/2022/imagine-worldwide.html?caasID=CAAS-ActivityStream"),E.click4=new H.LinkButton("https://www.ubs.com/global/en/sustainability-impact/globalvisionaries/gv/2022/earth-security.html"),E.click5=new H.LinkButton(" https://www.ubs.com/global/en/our-firm/art/art-collection/online-exhibition.html"),E.click6=new H.LinkButton(" https://www.ubs.com/microsites/nobel-perspectives/en/latest-economic-questions/technology-and-economy/articles/ai-fourth-industrial-revolution.html?caasID=CAAS-ActivityStream"),E.click7=new H.LinkButton("https://www.ubs.com/global/en/our-firm/our-history/virtual-museum.html"),E.click8=new H.LinkButton("https://www.ubs.com/global/en/ubs-society/philanthropy/optimus-foundation.html"),E.click9=new H.LinkButton("https://www.ubs.com/microsites/nobel-perspectives/en/home.html"),E.mintingStation=new Entity,E.teleport1=new O.TriggerZone,E.teleport2=new O.TriggerZone,E.teleport3=new O.TriggerZone,E.teleport4=new O.TriggerZone,E.tunnelTeleport=new O.TriggerZone,E.music=new Entity,E.artGalleryClip=new AudioClip("sounds/Art Gallery.mp3"),E.lobbyClip=new AudioClip("sounds/UBS Lobby Jazz Instrumental 1.mp3"),E.artMusicSource=new AudioSource(E.artGalleryClip),E.lobbyMusicSource=new AudioSource(E.lobbyClip),E.sign=new Entity,E.text=new TextShape("Step to go to Rooftop"),E.ui=new W.UI,E.database_handler=new M.Database_handler("3a6fe5c4-baac-4d9b-91c6-d8c2ad6130ea"),E.instanceController=A,E.mainGeo.addComponent(new GLTFShape("models/ubs_ext_main_geo.gltf")),E.branding.addComponent(new GLTFShape("models/ubs_ext_branding.gltf")),E.bushes.addComponent(new GLTFShape("models/ubs_ext_bushes.gltf")),E.detailing.addComponent(new GLTFShape("models/ubs_ext_detailing.gltf")),E.waterfall.addComponent(new GLTFShape("models/ubs_ext_waterfall_2.gltf")),E.collider.addComponent(new GLTFShape("models/ubs_ext_collider.gltf")),E.interiorGeo.addComponent(new GLTFShape("models/ubs_int_main_geo.gltf")),E.whirlpool.addComponent(new GLTFShape("models/ubs_ext_whirlpool.gltf")),E.buttonGorundFloor.addComponent(new GLTFShape("models/ubs_elevator_button_ground_floor.gltf")),E.buttonGalleryFloor.addComponent(new GLTFShape("models/ubs_elevator_button_gallery_floor.gltf")),E.buttonMeetingFloor.addComponent(new GLTFShape("models/ubs_elevator_button_meeting_floor.gltf")),E.buttonRooftopFloor.addComponent(new GLTFShape("models/ubs_elevator_button_rooftop_floor.gltf")),E.mintingStation.addComponent(new GLTFShape("models/ubs_int_minting_station.gltf")),E.__1=new V.NPC(E.ui,"models/ubs_npc_isabella5.gltf",new Vector3(54.2,1.19,19.5),(new Quaternion).setEuler(0,45,0),"__1"),E.__2=new V.NPC(E.ui,"models/ubs_npc_peter3.gltf",new Vector3(41.34,11.7,8.09),(new Quaternion).setEuler(0,45,0),"__2"),E.__3=new V.NPC(E.ui,"models/ubs_npc_cameron3.gltf",new Vector3(48.2,33.23,19.19),(new Quaternion).setEuler(0,229,0),"__3"),E.__4=new V.NPC(E.ui,"models/ubs_npc_rina3.gltf",new Vector3(47.32,.18,55.85),(new Quaternion).setEuler(0,45,0),"__4"),E.mainGeo.setParent(E),E.branding.setParent(E),E.bushes.setParent(E),E.detailing.setParent(E),E.waterfall.setParent(E),E.collider.setParent(E),E.interiorGeo.setParent(E),E.whirlpool.setParent(E),E.buttonGalleryFloor.setParent(E),E.buttonGorundFloor.setParent(E),E.buttonMeetingFloor.setParent(E),E.buttonRooftopFloor.setParent(E),E.music.setParent(E),E.__1.setParent(E),E.__2.setParent(E),E.__3.setParent(E),E.__4.setParent(E),E.music.addComponent(E.lobbyMusicSource),E.music.addComponent(new Transform({position:new Vector3(34.75,1.99,15.49)})),E.lobbyMusicSource.loop=!0,E.lobbyMusicSource.volume=.2,E.lobbyMusicSource.playing=!0,E.click.setParent(E),E.click1.setParent(E),E.click2.setParent(E),E.click3.setParent(E),E.click4.setParent(E),E.click5.setParent(E),E.click6.setParent(E),E.click7.setParent(E),E.click8.setParent(E),E.click9.setParent(E),E.click.addComponentOrReplace(new Transform({position:new Vector3(44.01,1.12,5.9)})),E.click1.addComponentOrReplace(new Transform({position:new Vector3(38.72,1.12,5.94)})),E.click2.addComponentOrReplace(new Transform({position:new Vector3(34.2,1.12,5.93)})),E.click3.addComponentOrReplace(new Transform({position:new Vector3(39.54,1.12,22.98),rotation:(new Quaternion).setEuler(0,180,0)})),E.click4.addComponentOrReplace(new Transform({position:new Vector3(30.33,1.12,22.98),rotation:(new Quaternion).setEuler(0,180,0)})),E.click5.addComponentOrReplace(new Transform({position:new Vector3(45.02,11.5,5.96),rotation:(new Quaternion).setEuler(0,360,0)})),E.click6.addComponentOrReplace(new Transform({position:new Vector3(37.93,22.2,5.94),rotation:(new Quaternion).setEuler(0,360,0)})),E.click7.addComponentOrReplace(new Transform({position:new Vector3(40.58,.05,23.95)})),E.click8.addComponentOrReplace(new Transform({position:new Vector3(5.41,18,29.15),rotation:(new Quaternion).setEuler(0,90,0)})),E.click9.addComponentOrReplace(new Transform({position:new Vector3(43.22,22.2,5.94),rotation:(new Quaternion).setEuler(0,360,0)})),E.mintingStation.setParent(E),E.setTeleport(),E.teleportsGroundFloor(),E.teleportsGalleryFloor(),E.teleportsMeetingFloor(),E.teleportsRooftopFloor(),E.setTunnel(),E.setGallery(),E.setInfoSpace(),E.setRooftopScreens(),E.setMeetingRoomScreens(),E.setExtraScreens(),E}return __extends(ExteriorInstance,v),ExteriorInstance.prototype.setTunnel=function(){var v=this;this.tunnelTeleport.setParent(this),this.tunnelTeleport.addComponentOrReplace(new Transform({position:new Vector3(43.61,1.88,47.51),scale:new Vector3(12,1,12),rotation:(new Quaternion).setEuler(0,0,0)})),this.tunnelTeleport.onCameraEnter=function(){v.instanceController.loadTransitor(),(0,E.movePlayerTo)(new Vector3(32.9,9.3,9.82),new Vector3(33.84,9.3,17.44))}},ExteriorInstance.prototype.setTeleport=function(){this.teleport1.addComponentOrReplace(new Transform({position:new Vector3(45.76,1.1,62.56)})),this.teleport1.onCameraEnter=function(){(0,E.movePlayerTo)(new Vector3(44.18,1.99,14.35),new Vector3(47.14,1.99,14.72))},this.teleport1.setParent(this),this.teleport2.addComponentOrReplace(new Transform({position:new Vector3(39.47,1.1,62.38)})),this.teleport2.onCameraEnter=function(){(0,E.movePlayerTo)(new Vector3(44.25,12.39,14.51),new Vector3(46.44,12.39,14.17))},this.teleport2.setParent(this),this.teleport3.addComponentOrReplace(new Transform({position:new Vector3(33.47,1.1,62.96)})),this.teleport3.onCameraEnter=function(){(0,E.movePlayerTo)(new Vector3(44.49,22.85,14.73),new Vector3(46.41,22.85,14.7))},this.teleport3.setParent(this),this.teleport4.addComponentOrReplace(new Transform({position:new Vector3(27.53,1.1,62.79)})),this.teleport4.setParent(this),this.teleport4.onCameraEnter=function(){(0,E.movePlayerTo)(new Vector3(48.91,34.18,14.46),new Vector3(52.42,34.05,15.15))}},ExteriorInstance.prototype.setSign=function(){this.sign.addComponent(this.text),this.sign.addComponent(new Transform({position:new Vector3(27.45,1.4,63.2),scale:new Vector3(.14,.14,.14)})),this.sign.setParent(this)},ExteriorInstance.prototype.teleportsGroundFloor=function(){var v=this,A=new R.ExitPlane;A.addComponentOrReplace(new Transform({position:new Vector3(42.15,2.09,13.66),scale:new Vector3(1.6,1.1,.1)})),A.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.25,12.39,14.51),new Vector3(46.44,12.39,14.17)),v.music.addComponentOrReplace(v.artMusicSource),v.artMusicSource.loop=!0,v.artMusicSource.volume=.2,v.artMusicSource.playing=!0}),{hoverText:"Art Gallery"})),A.setParent(this);var O=new R.ExitPlane;O.addComponentOrReplace(new Transform({position:new Vector3(41.95,3.27,15.76),scale:new Vector3(1.6,1.1,.1)})),O.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.49,22.85,14.73),new Vector3(46.41,22.85,14.7))}),{hoverText:"Meeting Space"})),O.setParent(this);var M=new R.ExitPlane;M.addComponentOrReplace(new Transform({position:new Vector3(41.95,2.05,15.76),scale:new Vector3(1.6,1.1,.1)})),M.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(48.91,34.18,14.46),new Vector3(52.42,34.05,15.15))}),{hoverText:"Rooftop"})),M.setParent(this)},ExteriorInstance.prototype.teleportsGalleryFloor=function(){var v=this,A=new R.ExitPlane;A.addComponentOrReplace(new Transform({position:new Vector3(42.15,13.69,13.66),scale:new Vector3(1.6,1.1,.1)})),A.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.18,1.99,14.35),new Vector3(47.14,1.99,14.72)),v.music.addComponentOrReplace(v.lobbyMusicSource),v.lobbyMusicSource.loop=!0,v.lobbyMusicSource.volume=.2,v.lobbyMusicSource.playing=!0}),{hoverText:"Ground Floor"})),A.setParent(this);var O=new R.ExitPlane;O.addComponentOrReplace(new Transform({position:new Vector3(41.95,13.77,15.76),scale:new Vector3(1.6,1.1,.1)})),O.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.49,22.85,14.73),new Vector3(46.41,22.85,14.7)),v.music.addComponentOrReplace(v.lobbyMusicSource),v.lobbyMusicSource.loop=!0,v.lobbyMusicSource.volume=.2,v.lobbyMusicSource.playing=!0}),{hoverText:"Meeting Space"})),O.setParent(this);var M=new R.ExitPlane;M.addComponentOrReplace(new Transform({position:new Vector3(41.95,12.55,15.76),scale:new Vector3(1.6,1.1,.1)})),M.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(48.91,34.18,14.46),new Vector3(52.42,34.05,15.15)),v.music.addComponentOrReplace(v.lobbyMusicSource),v.lobbyMusicSource.loop=!0,v.lobbyMusicSource.volume=.2,v.lobbyMusicSource.playing=!0}),{hoverText:"Rooftop"})),M.setParent(this)},ExteriorInstance.prototype.teleportsMeetingFloor=function(){var v=this,A=new R.ExitPlane;A.addComponentOrReplace(new Transform({position:new Vector3(42.15,24.19,13.66),scale:new Vector3(1.6,1.1,.1)})),A.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.18,1.99,14.35),new Vector3(47.14,1.99,14.72))}),{hoverText:"Ground Floor"})),A.setParent(this);var O=new R.ExitPlane;O.addComponentOrReplace(new Transform({position:new Vector3(42.15,22.95,13.66),scale:new Vector3(1.6,1.1,.1)})),O.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.25,12.39,14.51),new Vector3(46.44,12.39,14.17)),v.music.addComponentOrReplace(v.artMusicSource),v.artMusicSource.loop=!0,v.artMusicSource.volume=.2,v.artMusicSource.playing=!0}),{hoverText:"Art Gallery"})),O.setParent(this);var M=new R.ExitPlane;M.addComponentOrReplace(new Transform({position:new Vector3(41.95,23.05,15.76),scale:new Vector3(1.6,1.1,.1)})),M.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(48.91,34.18,14.46),new Vector3(52.42,34.05,15.15))}),{hoverText:"Rooftop"})),M.setParent(this)},ExteriorInstance.prototype.teleportsRooftopFloor=function(){var v=this,A=new R.ExitPlane;A.addComponentOrReplace(new Transform({position:new Vector3(48.15,35.23,13.52),scale:new Vector3(1.6,.7,.1)})),A.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.18,1.99,14.35),new Vector3(47.14,1.99,14.72))}),{hoverText:"Ground Floor"})),A.setParent(this);var O=new R.ExitPlane;O.addComponentOrReplace(new Transform({position:new Vector3(48.15,34.43,13.52),scale:new Vector3(1.6,.6,.1)})),O.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.25,12.39,14.51),new Vector3(46.44,12.39,14.17)),v.music.addComponentOrReplace(v.artMusicSource),v.artMusicSource.loop=!0,v.artMusicSource.volume=.2,v.artMusicSource.playing=!0}),{hoverText:"Art Gallery"})),O.setParent(this);var M=new R.ExitPlane;M.addComponentOrReplace(new Transform({position:new Vector3(48.15,35.13,15.82),scale:new Vector3(1.6,.8,.1)})),M.addComponentOrReplace(new OnPointerDown((function(){(0,E.movePlayerTo)(new Vector3(44.49,22.85,14.73),new Vector3(46.41,22.85,14.7))}),{hoverText:"Meeting Space"})),M.setParent(this)},ExteriorInstance.prototype.setGalleryItem=function(v,A,E,R){return __awaiter(this,void 0,void 0,(function(){var O,M,V,W,H,X,Z,K,$,J,et;return __generator(this,(function(it){switch(it.label){case 0:return(O=new Entity).addComponent(new Transform({position:new Vector3(v.x,v.y,v.z),rotation:(new Quaternion).setEuler(A.Rx,A.Ry,A.Rz)})),M={x:0,y:0,z:0},V={Rx:0,Ry:0,Rz:0},[4,this.database_handler.getScreen(E,M,V)];case 1:return W=it.sent(),H=W.dclObject,X=W.position,Z={x:0,y:X.y,z:0},[4,this.database_handler.getScreen(R,Z,V)];case 2:return K=it.sent(),$=K.dclObject,J=K.scale,et=K.ratio,$.addComponentOrReplace(new Transform({position:new Vector3(0,X.y+J,0),scale:new Vector3(J*et,J,3)})),H.setParent(O),$.setParent(O),O.setParent(this),engine.addEntity(O),[2]}}))}))},ExteriorInstance.prototype.setGallery=function(){var v=this,A=13,E=[{position:{x:56.63,y:A,z:15.66},rotation:{Rx:0,Ry:45,Rz:180},artBoardName:"Art%20Board%201",artBoardDescriptionName:"Art%20Board%201%20Description"},{position:{x:50.03,y:A,z:9.89},rotation:{Rx:0,Ry:90,Rz:180},artBoardName:"Art%20Board%202",artBoardDescriptionName:"Art%20Board%202%20Description"},{position:{x:36.4,y:A,z:19.3},rotation:{Rx:360,Ry:90,Rz:180},artBoardName:"Art%20Board%203",artBoardDescriptionName:"Art%20Board%203%20Description"},{position:{x:38.4,y:A,z:20.3},rotation:{Rx:360,Ry:0,Rz:180},artBoardName:"Art%20Board%206",artBoardDescriptionName:"Art%20Board%206%20Description"},{position:{x:20.8,y:A,z:18.62},rotation:{Rx:360,Ry:270,Rz:180},artBoardName:"Art%20Board%204",artBoardDescriptionName:"Art%20Board%204%20Description"},{position:{x:29.43,y:A,z:9.61},rotation:{Rx:360,Ry:180,Rz:180},artBoardName:"Art%20Board%205",artBoardDescriptionName:"Art%20Board%205%20Description"},{position:{x:29.43,y:A,z:9.33},rotation:{Rx:360,Ry:0,Rz:180},artBoardName:"Art%20Board%207",artBoardDescriptionName:"Art%20Board%207%20Description"}].map((function(A){var E=A.position,R=A.rotation,O=A.artBoardName,M=A.artBoardDescriptionName;return v.setGalleryItem(E,R,O,M)}));Promise.all(E).then((function(){}))},ExteriorInstance.prototype.setInfoSpace=function(){var v=this,A=2.4,E=[{position:{x:28.63,y:5,z:23.28},rotation:{Rx:360,Ry:360,Rz:180},infoSpaceName:"9",scaleOverride:A,flipGrowthAxis:!0},{position:{x:28.18,y:6.4,z:14.77},rotation:{Rx:0,Ry:0,Rz:180},infoSpaceName:"6",scaleOverride:4.24,flipGrowthAxis:!1},{position:{x:28.18,y:6.4,z:15.01},rotation:{Rx:360,Ry:180,Rz:180},infoSpaceName:"6",scaleOverride:4.24,flipGrowthAxis:!1},{position:{x:46.24,y:5,z:5.69},rotation:{Rx:360,Ry:180,Rz:180},infoSpaceName:"3",scaleOverride:A,flipGrowthAxis:!0},{position:{x:41.14,y:5,z:5.69},rotation:{Rx:360,Ry:180,Rz:180},infoSpaceName:"4",scaleOverride:A,flipGrowthAxis:!0},{position:{x:37.83,y:5,z:23.28},rotation:{Rx:360,Ry:360,Rz:180},infoSpaceName:"7",scaleOverride:A,flipGrowthAxis:!0},{position:{x:36,y:5,z:5.71},rotation:{Rx:360,Ry:180,Rz:180},infoSpaceName:"5",scaleOverride:A,flipGrowthAxis:!0}].map((function(A){return __awaiter(v,void 0,void 0,(function(){var v,E,R,O,M;return __generator(this,(function(V){switch(V.label){case 0:return v=A.position,E=A.rotation,R=A.infoSpaceName,O=A.scaleOverride,M=A.flipGrowthAxis,[4,this.database_handler.getScreen(R,v,E,O,M)];case 1:return V.sent().dclObject.setParent(this),[2]}}))}))}));Promise.all(E).then((function(){}))},ExteriorInstance.prototype.setRooftopScreens=function(){return __awaiter(this,void 0,void 0,(function(){var v,A,E,R,O,M,V,W;return __generator(this,(function(H){switch(H.label){case 0:return v={x:56.21,y:37.45,z:14.65},A={Rx:360,Ry:268,Rz:359.4},[4,this.database_handler.getScreen("18",v,A,!1,!1)];case 1:return E=H.sent(),(R=E.dclObject).addComponentOrReplace(new Transform({position:new Vector3(56.21,37.45,14.65),scale:new Vector3(9.42,5.85,3),rotation:(new Quaternion).setEuler(360,268,359.4)})),R.setParent(this),[4,this.database_handler.getScreen("17",v,A,!1,!1)];case 2:return O=H.sent(),(M=O.dclObject).addComponentOrReplace(new Transform({position:new Vector3(5.12,21.45,23.75),scale:new Vector3(8.42,4.85,3),rotation:(new Quaternion).setEuler(183,90.9,359.4)})),M.setParent(this),[4,this.database_handler.getScreen("16",v,A,!1,!1)];case 3:return V=H.sent(),(W=V.dclObject).addComponentOrReplace(new Transform({position:new Vector3(32.94,24.94,14.3),scale:new Vector3(7.92,4.01,3),rotation:(new Quaternion).setEuler(360,90,360)})),W.setParent(this),[2]}}))}))},ExteriorInstance.prototype.setMeetingRoomScreens=function(){return __awaiter(this,void 0,void 0,(function(){var v,A,E,R,O,M,V,W;return __generator(this,(function(H){switch(H.label){case 0:return v={x:56.21,y:37.45,z:14.65},A={Rx:360,Ry:268,Rz:359.4},[4,this.database_handler.getScreen("13",v,A,!1,!0)];case 1:return E=H.sent(),(R=E.dclObject).addComponentOrReplace(new Transform({position:new Vector3(45.08,24.7,5.71),scale:new Vector3(2.4,4.4,1),rotation:(new Quaternion).setEuler(180,0,0)})),R.setParent(this),[4,this.database_handler.getScreen("14",v,A,!1,!1)];case 2:return O=H.sent(),(M=O.dclObject).addComponentOrReplace(new Transform({position:new Vector3(39.98,24.7,5.71),scale:new Vector3(2.4,4.4,1),rotation:(new Quaternion).setEuler(0,0,0)})),M.setParent(this),[4,this.database_handler.getScreen("15",v,A,!1,!1)];case 3:return V=H.sent(),(W=V.dclObject).addComponentOrReplace(new Transform({position:new Vector3(34.87,24.7,5.71),scale:new Vector3(2.4,4.4,1),rotation:(new Quaternion).setEuler(0,0,0)})),W.setParent(this),[2]}}))}))},ExteriorInstance.prototype.setExtraScreens=function(){return __awaiter(this,void 0,void 0,(function(){var v,A,E,R,O,M,V,W,H,X,Z,K,$,J;return __generator(this,(function(et){switch(et.label){case 0:return v={x:56.21,y:37.45,z:14.65},A={Rx:360,Ry:268,Rz:359.4},[4,this.database_handler.getScreen("1",v,A,!1,!1)];case 1:return E=et.sent(),(R=E.dclObject).addComponentOrReplace(new Transform({position:new Vector3(77.86,4.44,14.53),scale:new Vector3(8.4,5.25,5),rotation:(new Quaternion).setEuler(180,270,0)})),R.setParent(this),[4,this.database_handler.getScreen("11",v,A,!1,!1)];case 2:return O=et.sent(),(M=O.dclObject).addComponentOrReplace(new Transform({position:new Vector3(11.14,5.7,30.4),scale:new Vector3(12.06,6.25,2),rotation:(new Quaternion).setEuler(0,88,.6)})),M.setParent(this),[4,this.database_handler.getScreen("2",v,A,!1,!1)];case 3:return V=et.sent(),(W=V.dclObject).addComponentOrReplace(new Transform({position:new Vector3(67.3,5.41,9.08),scale:new Vector3(5.17,6.45,2),rotation:(new Quaternion).setEuler(360,180,180.6)})),W.setParent(this),[4,this.database_handler.getScreen("12",v,A,!1,!0)];case 4:return H=et.sent(),(X=H.dclObject).addComponentOrReplace(new Transform({position:new Vector3(43.12,14.1,5.68),scale:new Vector3(2.39,4.35,2),rotation:(new Quaternion).setEuler(360,180,179.6)})),X.setParent(this),[4,this.database_handler.getScreen("8",v,A,!1,!1)];case 5:return Z=et.sent(),(K=Z.dclObject).addComponentOrReplace(new Transform({position:new Vector3(33.23,3.8,23.28),scale:new Vector3(2.47,4.45,2),rotation:(new Quaternion).setEuler(360,180,.6)})),K.setParent(this),[4,this.database_handler.getScreen("10",v,A,!1,!1)];case 6:return $=et.sent(),(J=$.dclObject).addComponentOrReplace(new Transform({position:new Vector3(24.03,3.8,23.28),scale:new Vector3(2.47,4.45,2),rotation:(new Quaternion).setEuler(360,180,.6)})),J.setParent(this),[2]}}))}))},ExteriorInstance}(Entity);A.ExteriorInstance=X})),define("classes/instance.controller",["require","exports","@dcl/ecs-scene-utils","instances/transitor.instance","instances/exterior.instance"],(function(v,A,E,R,O){Object.defineProperty(A,"__esModule",{value:!0}),A.InstanceController=void 0;var M=function(){function InstanceController(){this.exterior=new O.ExteriorInstance(this),this.transitor=new R.TransitorInstance(this),this.transitorPreload(),engine.addEntity(this.exterior)}return InstanceController.prototype.transitorPreload=function(){var v=this;engine.addEntity(this.transitor),this.transitor.addComponent(new Transform({scale:new Vector3(1e-4,1e-4,1e-4)})),(0,E.setTimeout)(1e3,(function(){engine.removeEntity(v.transitor),v.transitor.removeComponent(Transform),v.transitor.addComponent(new Transform({position:new Vector3(0,0,0),scale:new Vector3(1,1,1)}))}))},InstanceController.prototype.loadTransitor=function(){this.exterior.isAddedToEngine()&&(engine.removeEntity(this.exterior),engine.addEntity(this.transitor))},InstanceController.prototype.loadExterior=function(){this.transitor.isAddedToEngine()&&(engine.removeEntity(this.transitor),engine.addEntity(this.exterior))},InstanceController}();A.InstanceController=M})),define("classes/game.Controller",["require","exports","classes/instance.controller"],(function(v,A,E){Object.defineProperty(A,"__esModule",{value:!0}),A.GameController=void 0;A.GameController=function(){this.instanceController=new E.InstanceController}})),define("game",["require","exports","classes/game.Controller"],(function(v,A,E){Object.defineProperty(A,"__esModule",{value:!0}),new E.GameController}));